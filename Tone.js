!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Tone=e():t.Tone=e()}("undefined"!=typeof self?self:this,(function(){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=32)}([function(t,e,n){!function(t,e,n,i,r,s,o,a,u,c,l,h,f,p,d){"use strict";function m(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var _=m(n),g=m(i),v=m(r),y=m(s),b=m(o),x=m(a),w=m(u),O=m(c),k=m(l),S=m(h),T=m(f),A=m(p),D=m(d),C=new WeakSet,R=new WeakMap,E=new WeakMap,j=new WeakMap,M=new WeakMap,P=new WeakMap,q=new WeakMap,I=new WeakMap,F=new WeakMap,V=new WeakMap,N={construct:function(){return N}},L=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,z=function(t,e){for(var n=[],i=t.replace(/^[\s]+/,""),r=i.match(L);null!==r;){var s=r[1].slice(1,-1),o=r[0].replace(/([\s]+)?;?$/,"").replace(s,new URL(s,e).toString());n.push(o),r=(i=i.slice(r[0].length).replace(/^[\s]+/,"")).match(L)}return[n.join(";"),i]},B=function(t){if(void 0!==t&&!Array.isArray(t))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},W=function(t){if(!function(t){try{new new Proxy(t,N)}catch(t){return!1}return!0}(t))throw new TypeError("The given value for processorCtor should be a constructor.");if(null===t.prototype||"object"!==v.default(t.prototype))throw new TypeError("The given value for processorCtor should have a prototype.")},G=function(t,e){var n=t.get(e);if(void 0===n)throw new Error("A value with the given key could not be found.");return n},U=function(t,e){var n=Array.from(t).filter(e);if(n.length>1)throw Error("More than one element was found.");if(0===n.length)throw Error("No element was found.");var i=_.default(n,1)[0];return t.delete(i),i},Y=function(t,e,n,i){var r=G(t,e),s=U(r,(function(t){return t[0]===n&&t[1]===i}));return 0===r.size&&t.delete(e),s},Z=function(t){return G(q,t)},X=function(t){if(C.has(t))throw new Error("The AudioNode is already stored.");C.add(t),Z(t).forEach((function(t){return t(!0)}))},Q=function(t){return"port"in t},H=function(t){if(!C.has(t))throw new Error("The AudioNode is not stored.");C.delete(t),Z(t).forEach((function(t){return t(!1)}))},$=function(t,e){!Q(t)&&e.every((function(t){return 0===t.size}))&&H(t)};function J(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function K(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?J(Object(n),!0).forEach((function(e){y.default(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):J(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function tt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=O.default(t);if(e){var r=O.default(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return w.default(this,n)}}var et={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},nt=function(t,e){return t.context===e},it=function(t){try{t.copyToChannel(new Float32Array(1),0,-1)}catch(t){return!1}return!0},rt=function(){return new DOMException("","IndexSizeError")},st=function(t){var e;t.getChannelData=(e=t.getChannelData,function(n){try{return e.call(t,n)}catch(t){if(12===t.code)throw rt();throw t}})};function ot(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function at(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ot(Object(n),!0).forEach((function(e){y.default(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ot(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var ut={numberOfChannels:1},ct=-34028234663852886e22,lt=-ct,ht=function(t){return C.has(t)};function ft(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function pt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ft(Object(n),!0).forEach((function(e){y.default(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ft(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function dt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=O.default(t);if(e){var r=O.default(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return w.default(this,n)}}var mt={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},_t=function(t){return G(R,t)},gt=function(t){return G(j,t)};function vt(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return yt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?yt(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,a=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return o=t.done,t},e:function(t){a=!0,s=t},f:function(){try{o||null==n.return||n.return()}finally{if(a)throw s}}}}function yt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var bt=function(t){!function t(e,n){_t(e).activeInputs.forEach((function(i){return i.forEach((function(i){var r=_.default(i,1)[0];n.includes(e)||t(r,[].concat(A.default(n),[e]))}))}));var i,r=vt(function(t){return"playbackRate"in t}(e)?[e.playbackRate]:Q(e)?Array.from(e.parameters.values()):function(t){return"frequency"in t&&"gain"in t}(e)?[e.Q,e.detune,e.frequency,e.gain]:function(t){return"offset"in t}(e)?[e.offset]:function(t){return!("frequency"in t)&&"gain"in t}(e)?[e.gain]:function(t){return"detune"in t&&"frequency"in t}(e)?[e.detune,e.frequency]:function(t){return"pan"in t}(e)?[e.pan]:[]);try{for(r.s();!(i=r.n()).done;){var s=i.value,o=gt(s);void 0!==o&&o.activeInputs.forEach((function(e){var i=_.default(e,1)[0];return t(i,n)}))}}catch(t){r.e(t)}finally{r.f()}ht(e)&&H(e)}(t.destination,[])},xt=function(t){return void 0===t||"number"==typeof t||"string"==typeof t&&("balanced"===t||"interactive"===t||"playback"===t)};function wt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=O.default(t);if(e){var r=O.default(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return w.default(this,n)}}function Ot(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=O.default(t);if(e){var r=O.default(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return w.default(this,n)}}var kt=function(t){return"context"in t},St=function(t){return kt(t[0])};function Tt(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return At(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?At(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,a=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return o=t.done,t},e:function(t){a=!0,s=t},f:function(){try{o||null==n.return||n.return()}finally{if(a)throw s}}}}function At(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var Dt=function(t,e,n,i){var r,s=Tt(t);try{for(s.s();!(r=s.n()).done;)if(n(r.value)){if(i)return!1;throw Error("The set contains at least one similar element.")}}catch(t){s.e(t)}finally{s.f()}return t.add(e),!0},Ct=function(t,e,n,i){var r=_.default(n,2),s=r[0],o=r[1];Dt(t,[e,s,o],(function(t){return t[0]===e&&t[1]===s}),i)},Rt=function(t,e,n){var i=_.default(e,3),r=i[0],s=i[1],o=i[2],a=t.get(r);void 0===a?t.set(r,new Set([[s,o]])):Dt(a,[s,o],(function(t){return t[0]===s}),n)},Et=function(t){return"inputs"in t},jt=function(t,e,n,i){if(Et(e)){var r=e.inputs[i];return t.connect(r,n,0),[r,n,0]}return t.connect(e,n,i),[e,n,i]};function Mt(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Pt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Pt(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,a=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return o=t.done,t},e:function(t){a=!0,s=t},f:function(){try{o||null==n.return||n.return()}finally{if(a)throw s}}}}function Pt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var qt=function(t,e,n){var i,r=Mt(t);try{for(r.s();!(i=r.n()).done;){var s=i.value;if(s[0]===e&&s[1]===n)return t.delete(s),s}}catch(t){r.e(t)}finally{r.f()}return null},It=function(t,e){if(!Z(t).delete(e))throw new Error("Missing the expected event listener.")},Ft=function(t,e,n){var i=G(t,e),r=U(i,(function(t){return t[0]===n}));return 0===i.size&&t.delete(e),r},Vt=function(t,e,n,i){Et(e)?t.disconnect(e.inputs[i],n,0):t.disconnect(e,n,i)},Nt=function(t){return G(E,t)},Lt=function(t){return G(M,t)},zt=function(t){return I.has(t)},Bt=function(t){return!C.has(t)},Wt=function(t){return new Promise((function(e){var n=t.createScriptProcessor(256,1,1),i=t.createGain(),r=t.createBuffer(1,2,44100),s=r.getChannelData(0);s[0]=1,s[1]=1;var o=t.createBufferSource();o.buffer=r,o.loop=!0,o.connect(n).connect(t.destination),o.connect(i),o.disconnect(i),n.onaudioprocess=function(i){var r=i.inputBuffer.getChannelData(0);Array.prototype.some.call(r,(function(t){return 1===t}))?e(!0):e(!1),o.stop(),n.onaudioprocess=null,o.disconnect(n),n.disconnect(t.destination)},o.start()}))};function Gt(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Ut(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ut(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,a=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return o=t.done,t},e:function(t){a=!0,s=t},f:function(){try{o||null==n.return||n.return()}finally{if(a)throw s}}}}function Ut(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var Yt=function(t,e){var n,i=new Map,r=Gt(t);try{for(r.s();!(n=r.n()).done;){var s,o=Gt(n.value);try{for(o.s();!(s=o.n()).done;){var a=s.value,u=i.get(a);i.set(a,void 0===u?1:u+1)}}catch(t){o.e(t)}finally{o.f()}}}catch(t){r.e(t)}finally{r.f()}i.forEach((function(t,n){return e(n,t)}))},Zt=function(t){return"context"in t};function Xt(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Qt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Qt(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,a=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return o=t.done,t},e:function(t){a=!0,s=t},f:function(){try{o||null==n.return||n.return()}finally{if(a)throw s}}}}function Qt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var Ht=function(t){var e,n,i=new Map;t.connect=(e=t.connect.bind(t),function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=Zt(t)?e(t,n,r):e(t,n),o=i.get(t);return void 0===o?i.set(t,[{input:r,output:n}]):o.every((function(t){return t.input!==r||t.output!==n}))&&o.push({input:r,output:n}),s}),t.disconnect=(n=t.disconnect,function(e,r,s){if(n.apply(t),void 0===e)i.clear();else if("number"==typeof e){var o,a=Xt(i);try{for(a.s();!(o=a.n()).done;){var u=_.default(o.value,2),c=u[0],l=u[1].filter((function(t){return t.output!==e}));0===l.length?i.delete(c):i.set(c,l)}}catch(t){a.e(t)}finally{a.f()}}else if(i.has(e))if(void 0===r)i.delete(e);else{var h=i.get(e);if(void 0!==h){var f=h.filter((function(t){return t.output!==r&&(t.input!==s||void 0===s)}));0===f.length?i.delete(e):i.set(e,f)}}var p,d=Xt(i);try{var m=function(){var e=_.default(p.value,2),n=e[0];e[1].forEach((function(e){Zt(n)?t.connect(n,e.output,e.input):t.connect(n,e.output)}))};for(d.s();!(p=d.n()).done;)m()}catch(t){d.e(t)}finally{d.f()}})};function $t(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=O.default(t);if(e){var r=O.default(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return w.default(this,n)}}function Jt(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Kt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Kt(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,a=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return o=t.done,t},e:function(t){a=!0,s=t},f:function(){try{o||null==n.return||n.return()}finally{if(a)throw s}}}}function Kt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var te=function(t,e,n,i){var r=gt(e),s=r.activeInputs,o=r.passiveInputs,a=_t(t).outputs,u=Z(t),c=function(r){var a=Nt(t),u=Lt(e);if(r){var c=Ft(o,t,n);Ct(s,t,c,!1),i||zt(t)||a.connect(u,n)}else{var l=function(t,e,n){return U(t,(function(t){return t[0]===e&&t[1]===n}))}(s,t,n);Rt(o,l,!1),i||zt(t)||a.disconnect(u,n)}};return!!Dt(a,[e,n],(function(t){return t[0]===e&&t[1]===n}),!0)&&(u.add(c),ht(t)?Ct(s,t,[n,c],!0):Rt(o,[t,n,c],!0),!0)},ee=function(t,e,n,i,r){var s=function(t,e,n,i){var r=_t(e),s=r.activeInputs,o=r.passiveInputs,a=qt(s[i],t,n);return null===a?[Y(o,t,n,i)[2],!1]:[a[2],!0]}(t,n,i,r),o=_.default(s,2),a=o[0],u=o[1];if(null!==a&&(It(t,a),!u||e||zt(t)||Vt(Nt(t),Nt(n),i,r)),ht(n)){var c=_t(n).activeInputs;$(n,c)}},ne=function(t,e,n,i){var r=function(t,e,n){var i=gt(e),r=i.activeInputs,s=i.passiveInputs,o=qt(r,t,n);return null===o?[Ft(s,t,n)[1],!1]:[o[2],!0]}(t,n,i),s=_.default(r,2),o=s[0],a=s[1];null!==o&&(It(t,o),!a||e||zt(t)||Nt(t).disconnect(Lt(n),i))};function ie(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return re(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?re(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,a=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return o=t.done,t},e:function(t){a=!0,s=t},f:function(){try{o||null==n.return||n.return()}finally{if(a)throw s}}}}function re(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var se=function(){function t(e){g.default(this,t),this._map=new Map(e)}return b.default(t,[{key:"entries",value:function(){return this._map.entries()}},{key:"forEach",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this._map.forEach((function(i,r){return t.call(n,i,r,e)}))}},{key:"get",value:function(t){return this._map.get(t)}},{key:"has",value:function(t){return this._map.has(t)}},{key:"keys",value:function(){return this._map.keys()}},{key:"values",value:function(){return this._map.values()}},{key:"size",get:function(){return this._map.size}}]),t}();function oe(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function ae(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?oe(Object(n),!0).forEach((function(e){y.default(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):oe(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function ue(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=O.default(t);if(e){var r=O.default(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return w.default(this,n)}}var ce={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}};function le(t,e,n,i,r){if("function"==typeof t.copyFromChannel)0===e[n].byteLength&&(e[n]=new Float32Array(128)),t.copyFromChannel(e[n],i,r);else{var s=t.getChannelData(i);if(0===e[n].byteLength)e[n]=s.slice(r,r+128);else{var o=new Float32Array(s.buffer,r*Float32Array.BYTES_PER_ELEMENT,128);e[n].set(o)}}}var he=function(t,e,n,i,r){"function"==typeof t.copyToChannel?0!==e[n].byteLength&&t.copyToChannel(e[n],i,r):0!==e[n].byteLength&&t.getChannelData(i).set(e[n],r)},fe=function(t,e){for(var n=[],i=0;i<t;i+=1){for(var r=[],s="number"==typeof e?e:e[i],o=0;o<s;o+=1)r.push(new Float32Array(128));n.push(r)}return n},pe=function(t,e){var n=G(V,t),i=Nt(e);return G(n,i)};function de(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return me(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?me(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,a=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return o=t.done,t},e:function(t){a=!0,s=t},f:function(){try{o||null==n.return||n.return()}finally{if(a)throw s}}}}function me(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function _e(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function ge(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?_e(Object(n),!0).forEach((function(e){y.default(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_e(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var ve=function(){var t=S.default(k.default.mark((function t(e,n,i,r,s,o,a){var u,c,l,h,f,p,d,m,_,g,v;return k.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(u=null===n?128*Math.ceil(e.context.length/128):n.length,c=r.channelCount*r.numberOfInputs,l=s.reduce((function(t,e){return t+e}),0),h=0===l?null:i.createBuffer(l,u,i.sampleRate),void 0!==o){t.next=6;break}throw new Error("Missing the processor constructor.");case 6:return f=_t(e),t.next=9,pe(i,e);case 9:p=t.sent,d=fe(r.numberOfInputs,r.channelCount),m=fe(r.numberOfOutputs,s),_=Array.from(e.parameters.keys()).reduce((function(t,e){return ge(ge({},t),{},y.default({},e,new Float32Array(128)))}),{}),g=function(t){if(r.numberOfInputs>0&&null!==n)for(var u=0;u<r.numberOfInputs;u+=1)for(var l=0;l<r.channelCount;l+=1)le(n,d[u],l,l,t);void 0!==o.parameterDescriptors&&null!==n&&o.parameterDescriptors.forEach((function(e,i){var r=e.name;le(n,_,r,c+i,t)}));for(var g=0;g<r.numberOfInputs;g+=1)for(var v=0;v<s[g];v+=1)0===m[g][v].byteLength&&(m[g][v]=new Float32Array(128));try{var y=d.map((function(t,e){return 0===f.activeInputs[e].size?[]:t})),b=a(t/i.sampleRate,i.sampleRate,(function(){return p.process(y,m,_)}));if(null!==h)for(var x=0,w=0;x<r.numberOfOutputs;x+=1){for(var O=0;O<s[x];O+=1)he(h,m[x],O,w+O,t);w+=s[x]}if(!b)return"break"}catch(t){return e.dispatchEvent(new ErrorEvent("processorerror",{colno:t.colno,filename:t.filename,lineno:t.lineno,message:t.message})),"break"}},v=0;case 15:if(!(v<u)){t.next=22;break}if("break"!==g(v)){t.next=19;break}return t.abrupt("break",22);case 19:v+=128,t.next=15;break;case 22:return t.abrupt("return",h);case 23:case"end":return t.stop()}}),t)})));return function(e,n,i,r,s,o,a){return t.apply(this,arguments)}}();function ye(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function be(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ye(Object(n),!0).forEach((function(e){y.default(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ye(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function xe(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=O.default(t);if(e){var r=O.default(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return w.default(this,n)}}function we(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function Oe(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?we(Object(n),!0).forEach((function(e){y.default(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):we(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function ke(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=O.default(t);if(e){var r=O.default(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return w.default(this,n)}}var Se={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"};function Te(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function Ae(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Te(Object(n),!0).forEach((function(e){y.default(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Te(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function De(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=O.default(t);if(e){var r=O.default(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return w.default(this,n)}}var Ce={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6};function Re(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function Ee(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Re(Object(n),!0).forEach((function(e){y.default(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Re(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function je(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=O.default(t);if(e){var r=O.default(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return w.default(this,n)}}var Me={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6};function Pe(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function qe(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Pe(Object(n),!0).forEach((function(e){y.default(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Pe(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Ie(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=O.default(t);if(e){var r=O.default(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return w.default(this,n)}}var Fe={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1};function Ve(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function Ne(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ve(Object(n),!0).forEach((function(e){y.default(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ve(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Le(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=O.default(t);if(e){var r=O.default(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return w.default(this,n)}}var ze={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1};function Be(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return We(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?We(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,a=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return o=t.done,t},e:function(t){a=!0,s=t},f:function(){try{o||null==n.return||n.return()}finally{if(a)throw s}}}}function We(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function Ge(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function Ue(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ge(Object(n),!0).forEach((function(e){y.default(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ge(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Ye(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=O.default(t);if(e){var r=O.default(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return w.default(this,n)}}var Ze={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},Xe=function(t,e,n){var i=e[n];if(void 0===i)throw t();return i};function Qe(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function He(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Qe(Object(n),!0).forEach((function(e){y.default(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Qe(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function $e(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=O.default(t);if(e){var r=O.default(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return w.default(this,n)}}var Je={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24};function Ke(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function tn(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ke(Object(n),!0).forEach((function(e){y.default(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ke(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function en(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=O.default(t);if(e){var r=O.default(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return w.default(this,n)}}var nn={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},rn=function(){return new DOMException("","InvalidStateError")},sn=function(){return new DOMException("","InvalidAccessError")};function on(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function an(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?on(Object(n),!0).forEach((function(e){y.default(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):on(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function un(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=O.default(t);if(e){var r=O.default(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return w.default(this,n)}}var cn={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},ln=function(t,e,n,i,r,s,o,a,u,c,l){for(var h=c.length,f=a,p=0;p<h;p+=1){for(var d=n[0]*c[p],m=1;m<r;m+=1){var _=f-m&u-1;d+=n[m]*s[_],d-=t[m]*o[_]}for(var g=r;g<i;g+=1)d+=n[g]*s[f-g&u-1];for(var v=r;v<e;v+=1)d-=t[v]*o[f-v&u-1];s[f]=c[p],o[f]=d,f=f+1&u-1,l[p]=d}return f},hn=function(t,e,n,i){var r=n instanceof Float64Array?n:new Float64Array(n),s=i instanceof Float64Array?i:new Float64Array(i),o=r.length,a=s.length,u=Math.min(o,a);if(1!==r[0]){for(var c=0;c<o;c+=1)s[c]/=r[0];for(var l=1;l<a;l+=1)r[l]/=r[0]}for(var h=new Float32Array(32),f=new Float32Array(32),p=e.createBuffer(t.numberOfChannels,t.length,t.sampleRate),d=t.numberOfChannels,m=0;m<d;m+=1){var _=t.getChannelData(m),g=p.getChannelData(m);h.fill(0),f.fill(0),ln(r,o,s,a,u,h,f,0,32,_,g)}return p};function fn(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return pn(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?pn(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,a=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return o=t.done,t},e:function(t){a=!0,s=t},f:function(){try{o||null==n.return||n.return()}finally{if(a)throw s}}}}function pn(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var dn=function(){var t=S.default(k.default.mark((function t(e,n,i,r,s,o,a,u,c,l,h,f,p,d,m,_){var g;return k.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e(n,n)&&e(i,i)&&e(s,s)&&e(o,o)&&e(u,u)&&e(c,c)&&e(l,l)&&e(h,h)&&e(f,f)&&e(p,p)&&e(d,d))){t.next=5;break}return t.next=3,Promise.all([e(r,r),e(a,a),e(m,m),e(_,_)]);case 3:return g=t.sent,t.abrupt("return",g.every((function(t){return t})));case 5:return t.abrupt("return",!1);case 6:case"end":return t.stop()}}),t)})));return function(e,n,i,r,s,o,a,u,c,l,h,f,p,d,m,_){return t.apply(this,arguments)}}();function mn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=O.default(t);if(e){var r=O.default(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return w.default(this,n)}}function _n(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function gn(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?_n(Object(n),!0).forEach((function(e){y.default(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_n(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function vn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=O.default(t);if(e){var r=O.default(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return w.default(this,n)}}var yn={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"};function bn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=O.default(t);if(e){var r=O.default(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return w.default(this,n)}}function xn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=O.default(t);if(e){var r=O.default(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return w.default(this,n)}}function wn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=O.default(t);if(e){var r=O.default(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return w.default(this,n)}}function On(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=O.default(t);if(e){var r=O.default(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return w.default(this,n)}}var kn=function(t){var e=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{var n=t.decodeAudioData(e.buffer,(function(){}));return void 0!==n&&(n.catch((function(){})),!0)}catch(t){}return!1};function Sn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function Tn(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Sn(Object(n),!0).forEach((function(e){y.default(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Sn(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function An(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=O.default(t);if(e){var r=O.default(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return w.default(this,n)}}var Dn={numberOfChannels:1};function Cn(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Rn(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Rn(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,a=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return o=t.done,t},e:function(t){a=!0,s=t},f:function(){try{o||null==n.return||n.return()}finally{if(a)throw s}}}}function Rn(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var En=function(t,e,n){var i=e[n];void 0!==i&&i!==t[n]&&(t[n]=i)},jn=function(t,e){En(t,e,"channelCount"),En(t,e,"channelCountMode"),En(t,e,"channelInterpretation")},Mn=function(t){return"function"==typeof t.getFloatTimeDomainData},Pn=function(t,e,n){var i=e[n];void 0!==i&&i!==t[n].value&&(t[n].value=i)},qn=function(t){var e;t.start=(e=t.start,function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0;if("number"==typeof r&&r<0||i<0||n<0)throw new RangeError("The parameters can't be negative.");e.call(t,n,i,r)})},In=function(t){var e;t.stop=(e=t.stop,function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(n<0)throw new RangeError("The parameter can't be negative.");e.call(t,n)})};function Fn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function Vn(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Fn(Object(n),!0).forEach((function(e){y.default(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Fn(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Nn=function(t,e){return null===t?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(t*e)))))},Ln=function(t){return new Promise((function(e,n){var i=new MessageChannel,r=i.port1,s=i.port2;r.onmessage=function(t){var n=t.data;r.close(),s.close(),e(n)},r.onmessageerror=function(t){var e=t.data;r.close(),s.close(),n(e)},s.postMessage(t)}))},zn=function(){var t=S.default(k.default.mark((function t(e,n){var i;return k.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Ln(n);case 2:return i=t.sent,t.abrupt("return",new e(i));case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}();function Bn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function Wn(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Bn(Object(n),!0).forEach((function(e){y.default(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Bn(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Gn(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Un(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Un(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,a=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return o=t.done,t},e:function(t){a=!0,s=t},f:function(){try{o||null==n.return||n.return()}finally{if(a)throw s}}}}function Un(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var Yn=function(t,e){var n=t.createBiquadFilter();return jn(n,e),Pn(n,e,"Q"),Pn(n,e,"detune"),Pn(n,e,"frequency"),Pn(n,e,"gain"),En(n,e,"type"),n},Zn=function(t,e){var n,i,r=t.createChannelSplitter(e.numberOfOutputs);return jn(r,e),i=(n=r).numberOfOutputs,Object.defineProperty(n,"channelCount",{get:function(){return i},set:function(t){if(t!==i)throw rn()}}),Object.defineProperty(n,"channelCountMode",{get:function(){return"explicit"},set:function(t){if("explicit"!==t)throw rn()}}),Object.defineProperty(n,"channelInterpretation",{get:function(){return"discrete"},set:function(t){if("discrete"!==t)throw rn()}}),r},Xn=function(t,e){return t.connect=e.connect.bind(e),t.disconnect=e.disconnect.bind(e),t};function Qn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function Hn(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Qn(Object(n),!0).forEach((function(e){y.default(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Qn(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var $n=function(t,e){var n=t.createDelay(e.maxDelayTime);return jn(n,e),Pn(n,e,"delayTime"),n},Jn=function(t,e){var n=t.createGain();return jn(n,e),Pn(n,e,"gain"),n};function Kn(t,e){var n=e[0]*e[0]+e[1]*e[1];return[(t[0]*e[0]+t[1]*e[1])/n,(t[1]*e[0]-t[0]*e[1])/n]}function ti(t,e){for(var n,i,r=[0,0],s=t.length-1;s>=0;s-=1)i=e,(r=[(n=r)[0]*i[0]-n[1]*i[1],n[0]*i[1]+n[1]*i[0]])[0]+=t[s];return r}function ei(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function ni(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ei(Object(n),!0).forEach((function(e){y.default(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ei(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var ii=function(t,e,n,i){return t.createScriptProcessor(e,n,i)};function ri(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function si(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ri(Object(n),!0).forEach((function(e){y.default(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ri(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function oi(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function ai(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?oi(Object(n),!0).forEach((function(e){y.default(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):oi(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var ui=function(){return new DOMException("","NotSupportedError")};function ci(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function li(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ci(Object(n),!0).forEach((function(e){y.default(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ci(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function hi(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=O.default(t);if(e){var r=O.default(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return w.default(this,n)}}var fi={numberOfChannels:1};function pi(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function di(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?pi(Object(n),!0).forEach((function(e){y.default(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):pi(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function mi(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=O.default(t);if(e){var r=O.default(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return w.default(this,n)}}var _i={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"};function gi(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function vi(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?gi(Object(n),!0).forEach((function(e){y.default(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):gi(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function yi(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=O.default(t);if(e){var r=O.default(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return w.default(this,n)}}var bi={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1};function xi(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function wi(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?xi(Object(n),!0).forEach((function(e){y.default(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):xi(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Oi(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function ki(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Oi(Object(n),!0).forEach((function(e){y.default(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Oi(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Si={disableNormalization:!1};function Ti(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function Ai(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ti(Object(n),!0).forEach((function(e){y.default(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ti(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Di(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=O.default(t);if(e){var r=O.default(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return w.default(this,n)}}var Ci={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},Ri=function(){return new DOMException("","UnknownError")};function Ei(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function ji(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ei(Object(n),!0).forEach((function(e){y.default(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ei(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Mi(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=O.default(t);if(e){var r=O.default(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return w.default(this,n)}}var Pi={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},qi=function(t){if(null===t)return!1;var e=t.length;return e%2!=0?0!==t[Math.floor(e/2)]:t[e/2-1]+t[e/2]!==0},Ii=function(t,e,n,i){for(var r=Object.getPrototypeOf(t);!r.hasOwnProperty(e);)r=Object.getPrototypeOf(r);var s=Object.getOwnPropertyDescriptor(r,e),o=s.get,a=s.set;Object.defineProperty(t,e,{get:n(o),set:i(a)})};function Fi(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function Vi(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Fi(Object(n),!0).forEach((function(e){y.default(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Fi(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Ni(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function Li(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ni(Object(n),!0).forEach((function(e){y.default(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ni(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function zi(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function Bi(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?zi(Object(n),!0).forEach((function(e){y.default(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):zi(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Wi,Gi,Ui,Yi,Zi,Xi,Qi=function(t){var e=t.createOscillator();try{e.start(-1)}catch(t){return t instanceof RangeError}return!1},Hi=function(t){var e=t.createBuffer(1,1,44100),n=t.createBufferSource();n.buffer=e,n.start(),n.stop();try{return n.stop(),!0}catch(t){return!1}},$i=function(t){var e=t.createOscillator();try{e.stop(-1)}catch(t){return t instanceof RangeError}return!1},Ji=function(){try{new DOMException}catch(t){return!1}return!0},Ki=function(){return new Promise((function(t){var e=new ArrayBuffer(0),n=new MessageChannel,i=n.port1,r=n.port2;i.onmessage=function(e){var n=e.data;return t(null!==n)},r.postMessage(e,[e])}))},tr=function(t,e){var n=e.createGain();t.connect(n);var i,r,s,o=(i=t.disconnect,function(){i.call(t,n),t.removeEventListener("ended",o)});t.addEventListener("ended",o),Xn(t,n),t.stop=(r=t.stop,s=!1,function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(s)try{r.call(t,e)}catch(t){n.gain.setValueAtTime(0,e)}else r.call(t,e),s=!0})},er=function(t,e){return function(n){var i={value:t};return Object.defineProperties(n,{currentTarget:i,target:i}),"function"==typeof e?e.call(t,n):e.handleEvent.call(t,n)}},nr=function(t){return function(e,n,i,r){var s=_.default(i,3),o=s[0],a=s[1],u=s[2];t(e[a],[n,o,u],(function(t){return t[0]===n&&t[1]===o}),r)}}(Dt),ir=function(t){return function(e,n,i,r){var s=_.default(i,3),o=s[0],a=s[1],u=s[2],c=e.get(o);void 0===c?e.set(o,new Set([[a,n,u]])):t(c,[a,n,u],(function(t){return t[0]===a&&t[1]===n}),r)}}(Dt),rr=function(t){return function(e,n,i,r){return t(e[r],(function(t){return t[0]===n&&t[1]===i}))}}(U),sr=new WeakMap,or=function(t){return function(e){var n;return null!==(n=t.get(e))&&void 0!==n?n:0}}(sr),ar=(Zi=new Map,Xi=new WeakMap,function(t,e){var n=Xi.get(t);if(void 0!==n)return n;var i=Zi.get(t);if(void 0!==i)return i;try{var r=e();return r instanceof Promise?(Zi.set(t,r),r.catch((function(){return!1})).then((function(e){return Zi.delete(t),Xi.set(t,e),e}))):(Xi.set(t,r),r)}catch(e){return Xi.set(t,!1),!1}}),ur="undefined"==typeof window?null:window,cr=function(t,e){return function(n,i){var r=n.createAnalyser();if(jn(r,i),!(i.maxDecibels>i.minDecibels))throw e();return En(r,i,"fftSize"),En(r,i,"maxDecibels"),En(r,i,"minDecibels"),En(r,i,"smoothingTimeConstant"),t(Mn,(function(){return Mn(r)}))||function(t){t.getFloatTimeDomainData=function(e){var n=new Uint8Array(e.length);t.getByteTimeDomainData(n);for(var i=Math.max(n.length,t.fftSize),r=0;r<i;r+=1)e[r]=.0078125*(n[r]-128);return e}}(r),r}}(ar,rt),lr=function(t){return function(e){var n=t(e);if(null===n.renderer)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return n.renderer}}(_t),hr=function(t,e,n){return function(){var i=S.default(k.default.mark((function i(r,s,o,a){var u,c;return k.default.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return u=t(r),c=[].concat(A.default(a),[r]),i.next=4,Promise.all(u.activeInputs.map((function(t,i){return Array.from(t).filter((function(t){var e=_.default(t,1)[0];return!c.includes(e)})).map(function(){var t=S.default(k.default.mark((function t(a){var u,l,h,f,p,d;return k.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return u=_.default(a,2),l=u[0],h=u[1],f=e(l),t.next=4,f.render(l,s,c);case 4:p=t.sent,d=r.context.destination,n(l)||r===d&&n(r)||p.connect(o,h,i);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())})).reduce((function(t,e){return[].concat(A.default(t),A.default(e))}),[]));case 4:case"end":return i.stop()}}),i)})));return function(t,e,n,r){return i.apply(this,arguments)}}()}(_t,lr,zt),fr=function(t,e,n){return function(){var i=new WeakMap,r=function(){var r=S.default(k.default.mark((function r(s,o,a){var u,c;return k.default.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return u=e(s),nt(u,o)||(c={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,fftSize:u.fftSize,maxDecibels:u.maxDecibels,minDecibels:u.minDecibels,smoothingTimeConstant:u.smoothingTimeConstant},u=t(o,c)),i.set(o,u),r.next=6,n(s,o,u,a);case 6:return r.abrupt("return",u);case 7:case"end":return r.stop()}}),r)})));return function(t,e,n){return r.apply(this,arguments)}}();return{render:function(t,e,n){var s=i.get(e);return void 0!==s?Promise.resolve(s):r(t,e,n)}}}}(cr,Nt,hr),pr=(Yi=P,function(t){var e=Yi.get(t);if(void 0===e)throw rn();return e}),dr=function(t){return null===t?null:t.hasOwnProperty("OfflineAudioContext")?t.OfflineAudioContext:t.hasOwnProperty("webkitOfflineAudioContext")?t.webkitOfflineAudioContext:null}(ur),mr=function(t){return function(e){return null!==t&&e instanceof t}}(dr),_r=new WeakMap,gr=function(t){return function(){function e(t){g.default(this,e),this._nativeEventTarget=t,this._listeners=new WeakMap}return b.default(e,[{key:"addEventListener",value:function(e,n,i){if(null!==n){var r=this._listeners.get(n);void 0===r&&(r=t(this,n),"function"==typeof n&&this._listeners.set(n,r)),this._nativeEventTarget.addEventListener(e,r,i)}}},{key:"dispatchEvent",value:function(t){return this._nativeEventTarget.dispatchEvent(t)}},{key:"removeEventListener",value:function(t,e,n){var i=null===e?void 0:this._listeners.get(e);this._nativeEventTarget.removeEventListener(t,void 0===i?null:i,n)}}]),e}()}(er),vr=function(t){return null===t?null:t.hasOwnProperty("AudioContext")?t.AudioContext:t.hasOwnProperty("webkitAudioContext")?t.webkitAudioContext:null}(ur),yr=function(t){return function(e){return null!==t&&e instanceof t}}(vr),br=function(t){return function(e){return null!==t&&"function"==typeof t.AudioNode&&e instanceof t.AudioNode}}(ur),xr=function(t){return function(e){return null!==t&&"function"==typeof t.AudioParam&&e instanceof t.AudioParam}}(ur),wr=function(t,e,n,i,r,s,o,a,u,c,l,h,f,p,d){return function(c){x.default(_,c);var m=$t(_);function _(e,i,r,s){var o;g.default(this,_),(o=m.call(this,r))._context=e,o._nativeAudioNode=r;var a=l(e);return h(a)&&!0!==n(Wt,(function(){return Wt(a)}))&&Ht(r),E.set(T.default(o),r),q.set(T.default(o),new Set),"closed"!==e.state&&i&&X(T.default(o)),t(T.default(o),s,r),o}return b.default(_,[{key:"connect",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(n<0||n>=this._nativeAudioNode.numberOfOutputs)throw r();var c=l(this._context),h=d(c);if(f(t)||p(t))throw s();if(kt(t)){var m=Nt(t);try{var _,g=jt(this._nativeAudioNode,m,n,a),v=Bt(this);(h||v)&&(_=this._nativeAudioNode).disconnect.apply(_,A.default(g)),"closed"!==this.context.state&&!v&&Bt(t)&&X(t)}catch(t){if(12===t.code)throw s();throw t}var y=e(this,t,n,a,h);if(y){var b=u([this],t);Yt(b,i(h))}return t}var x=Lt(t);if("playbackRate"===x.name)throw o();try{this._nativeAudioNode.connect(x,n),(h||Bt(this))&&this._nativeAudioNode.disconnect(x,n)}catch(t){if(12===t.code)throw s();throw t}var w=te(this,t,n,h);if(w){var O=u([this],t);Yt(O,i(h))}}},{key:"disconnect",value:function(t,e,n){var i,o=l(this._context),c=d(o);if(void 0===t)i=function(t,e){var n,i=_t(t),r=[],s=Jt(i.outputs);try{for(s.s();!(n=s.n()).done;){var o=n.value;St(o)?ee.apply(void 0,[t,e].concat(A.default(o))):ne.apply(void 0,[t,e].concat(A.default(o))),r.push(o[0])}}catch(t){s.e(t)}finally{s.f()}return i.outputs.clear(),r}(this,c);else if("number"==typeof t){if(t<0||t>=this.numberOfOutputs)throw r();i=function(t,e,n){var i,r=_t(t),s=[],o=Jt(r.outputs);try{for(o.s();!(i=o.n()).done;){var a=i.value;a[1]===n&&(St(a)?ee.apply(void 0,[t,e].concat(A.default(a))):ne.apply(void 0,[t,e].concat(A.default(a))),s.push(a[0]),r.outputs.delete(a))}}catch(t){o.e(t)}finally{o.f()}return s}(this,c,t)}else{if(void 0!==e&&(e<0||e>=this.numberOfOutputs))throw r();if(kt(t)&&void 0!==n&&(n<0||n>=t.numberOfInputs))throw r();if(0===(i=function(t,e,n,i,r){var s=_t(t);return Array.from(s.outputs).filter((function(t){return!(t[0]!==n||void 0!==i&&t[1]!==i||void 0!==r&&t[2]!==r)})).map((function(n){return St(n)?ee.apply(void 0,[t,e].concat(A.default(n))):ne.apply(void 0,[t,e].concat(A.default(n))),s.outputs.delete(n),n[0]}))}(this,c,t,e,n)).length)throw s()}var h,f=Jt(i);try{for(f.s();!(h=f.n()).done;){var p=h.value,m=u([this],p);Yt(m,a)}}catch(t){f.e(t)}finally{f.f()}}},{key:"channelCount",get:function(){return this._nativeAudioNode.channelCount},set:function(t){this._nativeAudioNode.channelCount=t}},{key:"channelCountMode",get:function(){return this._nativeAudioNode.channelCountMode},set:function(t){this._nativeAudioNode.channelCountMode=t}},{key:"channelInterpretation",get:function(){return this._nativeAudioNode.channelInterpretation},set:function(t){this._nativeAudioNode.channelInterpretation=t}},{key:"context",get:function(){return this._context}},{key:"numberOfInputs",get:function(){return this._nativeAudioNode.numberOfInputs}},{key:"numberOfOutputs",get:function(){return this._nativeAudioNode.numberOfOutputs}}]),_}(c)}((Ui=R,function(t,e,n){for(var i=[],r=0;r<n.numberOfInputs;r+=1)i.push(new Set);Ui.set(t,{activeInputs:i,outputs:new Set,passiveInputs:new WeakMap,renderer:e})}),function(t,e,n,i,r,s,o,a,u,c,l,h,f){return function(p,d,m,_,g){var v=s(d),y=v.activeInputs,b=v.passiveInputs,x=s(p).outputs,w=a(p),O=function(s){var a=u(d),c=u(p);if(s){var v=Y(b,p,m,_);t(y,p,v,!1),g||h(p)||n(c,a,m,_),f(d)&&X(d)}else{var x=i(y,p,m,_);e(b,_,x,!1),g||h(p)||r(c,a,m,_);var w=o(d);0===w?l(d)&&$(d,y):setTimeout((function(){l(d)&&$(d,y)}),1e3*w)}};return!!c(x,[d,m,_],(function(t){return t[0]===d&&t[1]===m&&t[2]===_}),!0)&&(w.add(O),l(p)?t(y,p,[m,_,O],!0):e(b,_,[p,m,O],!0),!0)}}(nr,ir,jt,rr,Vt,_t,or,Z,Nt,Dt,ht,zt,Bt),ar,function(t,e,n,i,r,s){return function(o){return function(a,u){var c=t.get(a);if(void 0===c){if(!o&&s(a)){var l,h=i(a),f=fn(n(a).outputs);try{for(f.s();!(l=f.n()).done;){var p=l.value;if(St(p)){var d=i(p[0]);e(h,d,p[1],p[2])}else{var m=r(p[0]);h.disconnect(m,p[1])}}}catch(t){f.e(t)}finally{f.f()}}t.set(a,u)}else t.set(a,c+u)}}}(I,Vt,_t,Nt,Lt,ht),rt,sn,ui,function(t,e,n,i,r,s,o,a){return function(u,c){var l=e.get(u);if(void 0===l)throw new Error("Missing the expected cycle count.");var h=s(u.context),f=a(h);if(l===c){if(e.delete(u),!f&&o(u)){var p,d=i(u),m=Be(n(u).outputs);try{for(m.s();!(p=m.n()).done;){var _=p.value;if(St(_)){var g=i(_[0]);t(d,g,_[1],_[2])}else{var v=r(_[0]);d.connect(v,_[1])}}}catch(t){m.e(t)}finally{m.f()}}}else e.set(u,l-c)}}(jt,I,_t,Nt,Lt,pr,ht,mr),function(t,e,n){return function i(r,s){var o=kt(s)?s:n(t,s);if(function(t){return"delayTime"in t}(o))return[];if(r[0]===o)return[r];if(r.includes(o))return[];var a=e(o).outputs;return Array.from(a).map((function(t){return i([].concat(A.default(r),[o]),t[0])})).reduce((function(t,e){return t.concat(e)}),[])}}(_r,_t,G),gr,pr,yr,br,xr,mr),Or=function(t,e,n,i,r,s){return function(t){x.default(a,t);var o=tt(a);function a(t,n){var u;g.default(this,a);var c=r(t),l=K(K({},et),n),h=i(c,l),f=s(c)?e():null;return(u=o.call(this,t,!1,h,f))._nativeAnalyserNode=h,u}return b.default(a,[{key:"getByteFrequencyData",value:function(t){this._nativeAnalyserNode.getByteFrequencyData(t)}},{key:"getByteTimeDomainData",value:function(t){this._nativeAnalyserNode.getByteTimeDomainData(t)}},{key:"getFloatFrequencyData",value:function(t){this._nativeAnalyserNode.getFloatFrequencyData(t)}},{key:"getFloatTimeDomainData",value:function(t){this._nativeAnalyserNode.getFloatTimeDomainData(t)}},{key:"fftSize",get:function(){return this._nativeAnalyserNode.fftSize},set:function(t){this._nativeAnalyserNode.fftSize=t}},{key:"frequencyBinCount",get:function(){return this._nativeAnalyserNode.frequencyBinCount}},{key:"maxDecibels",get:function(){return this._nativeAnalyserNode.maxDecibels},set:function(t){var e=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=t,!(t>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=e,n()}},{key:"minDecibels",get:function(){return this._nativeAnalyserNode.minDecibels},set:function(t){var e=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=t,!(this._nativeAnalyserNode.maxDecibels>t))throw this._nativeAnalyserNode.minDecibels=e,n()}},{key:"smoothingTimeConstant",get:function(){return this._nativeAnalyserNode.smoothingTimeConstant},set:function(t){this._nativeAnalyserNode.smoothingTimeConstant=t}}]),a}(t)}(wr,fr,rt,cr,pr,mr),kr=new WeakSet,Sr=function(t){return null===t?null:t.hasOwnProperty("AudioBuffer")?t.AudioBuffer:null}(ur),Tr=(Gi=new Uint32Array(1),function(t){return Gi[0]=t,Gi[0]}),Ar=function(t,e){return function(n){n.copyFromChannel=function(i,r){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=t(s),a=t(r);if(a>=n.numberOfChannels)throw e();for(var u=n.length,c=n.getChannelData(a),l=i.length,h=o<0?-o:0;h+o<u&&h<l;h+=1)i[h]=c[h+o]},n.copyToChannel=function(i,r){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=t(s),a=t(r);if(a>=n.numberOfChannels)throw e();for(var u=n.length,c=n.getChannelData(a),l=i.length,h=o<0?-o:0;h+o<u&&h<l;h+=1)c[h+o]=i[h]}}}(Tr,rt),Dr=function(t){return function(e){e.copyFromChannel=function(n){return function(i,r){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=t(s),a=t(r);if(o<e.length)return n.call(e,i,a,o)}}(e.copyFromChannel),e.copyToChannel=function(n){return function(i,r){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=t(s),a=t(r);if(o<e.length)return n.call(e,i,a,o)}}(e.copyToChannel)}}(Tr),Cr=function(t,e,n,i,r,s,o,a){var u=null;return function(){function c(l){if(g.default(this,c),null===r)throw new Error("Missing the native OfflineAudioContext constructor.");var h=at(at({},ut),l),f=h.length,p=h.numberOfChannels,d=h.sampleRate;null===u&&(u=new r(1,1,44100));var m=null!==i&&e(s,s)?new i({length:f,numberOfChannels:p,sampleRate:d}):u.createBuffer(p,f,d);if(0===m.numberOfChannels)throw n();return"function"!=typeof m.copyFromChannel?(o(m),st(m)):e(it,(function(){return it(m)}))||a(m),t.add(m),m}return b.default(c,null,[{key:Symbol.hasInstance,value:function(e){return null!==e&&"object"===v.default(e)&&Object.getPrototypeOf(e)===c.prototype||t.has(e)}}]),c}()}(kr,ar,ui,Sr,dr,function(t){return function(){if(null===t)return!1;try{new t({length:1,sampleRate:44100})}catch(t){return!1}return!0}}(Sr),Ar,Dr),Rr=function(t){return function(e,n){var i=t(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});n.connect(i).connect(e.destination),n.addEventListener("ended",(function t(){n.removeEventListener("ended",t),n.disconnect(i),i.disconnect()}))}}(Jn),Er=function(t,e,n){return function(){var i=S.default(k.default.mark((function i(r,s,o,a){var u;return k.default.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return u=e(r),i.next=3,Promise.all(Array.from(u.activeInputs).map(function(){var e=S.default(k.default.mark((function e(i){var r,u,c,l,h;return k.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=_.default(i,2),u=r[0],c=r[1],l=t(u),e.next=4,l.render(u,s,a);case 4:h=e.sent,n(u)||h.connect(o,c);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 3:case"end":return i.stop()}}),i)})));return function(t,e,n,r){return i.apply(this,arguments)}}()}(lr,gt,zt),jr=function(t){return function(e,n,i,r){return t(n,e,i,r)}}(Er),Mr=function(t,e,n,i,r,s,o,a,u,c,l){return function(h,f){var p=h.createBufferSource();return jn(p,f),Pn(p,f,"playbackRate"),En(p,f,"buffer"),En(p,f,"loop"),En(p,f,"loopEnd"),En(p,f,"loopStart"),e(n,(function(){return n(h)}))||function(t){var e,n;t.start=(e=t.start,n=!1,function(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2?arguments[2]:void 0;if(n)throw rn();e.call(t,i,r,s),n=!0})}(p),e(i,(function(){return i(h)}))||u(p),e(r,(function(){return r(h)}))||c(p,h),e(s,(function(){return s(h)}))||qn(p),e(o,(function(){return o(h)}))||l(p,h),e(a,(function(){return a(h)}))||In(p),t(h,p),p}}(Rr,ar,(function(t){var e=t.createBufferSource();e.start();try{e.start()}catch(t){return!0}return!1}),(function(t){var e=t.createBufferSource(),n=t.createBuffer(1,1,44100);e.buffer=n;try{e.start(0,1)}catch(t){return!1}return!0}),(function(t){var e=t.createBufferSource();e.start();try{e.stop()}catch(t){return!1}return!0}),Qi,Hi,$i,(function(t){var e;t.start=(e=t.start,function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0,s=t.buffer,o=null===s?i:Math.min(s.duration,i);null!==s&&o>s.duration-.5/t.context.sampleRate?e.call(t,n,0,0):e.call(t,n,o,r)})}),function(t){return function(e,n){var i=n.createBuffer(1,1,44100);null===e.buffer&&(e.buffer=i),t(e,"buffer",(function(t){return function(){var n=t.call(e);return n===i?null:n}}),(function(t){return function(n){return t.call(e,null===n?i:n)}}))}}(Ii),tr),Pr=function(t,e){return function(n,i,r,s){return t(i).replay(r),e(i,n,r,s)}}(function(t){return function(e){var n=t(e);if(null===n.renderer)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return n.renderer}}(gt),Er),qr=function(t,e,n,i,r){return function(){var s=new WeakMap,o=null,a=null,u=function(){var u=S.default(k.default.mark((function u(c,l,h){var f,p,d,m;return k.default.wrap((function(u){for(;;)switch(u.prev=u.next){case 0:if(f=n(c),(p=nt(f,l))||(d={buffer:f.buffer,channelCount:f.channelCount,channelCountMode:f.channelCountMode,channelInterpretation:f.channelInterpretation,loop:f.loop,loopEnd:f.loopEnd,loopStart:f.loopStart,playbackRate:f.playbackRate.value},f=e(l,d),null!==o&&(m=f).start.apply(m,A.default(o)),null!==a&&f.stop(a)),s.set(l,f),p){u.next=9;break}return u.next=7,i(l,c.playbackRate,f.playbackRate,h);case 7:u.next=11;break;case 9:return u.next=11,t(l,c.playbackRate,f.playbackRate,h);case 11:return u.next=13,r(c,l,f,h);case 13:return u.abrupt("return",f);case 14:case"end":return u.stop()}}),u)})));return function(t,e,n){return u.apply(this,arguments)}}();return{set start(t){o=t},set stop(t){a=t},render:function(t,e,n){var i=s.get(e);return void 0!==i?Promise.resolve(i):u(t,e,n)}}}}(jr,Mr,Nt,Pr,hr),Ir=function(t,n,i,r,s,o,a,u,c,l,h,f){return function(p,d,m){var _=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,g=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,v=new e.AutomationEventList(m.defaultValue),y=d?r(v):null,b={get defaultValue(){return m.defaultValue},get maxValue(){return null===_?m.maxValue:_},get minValue(){return null===g?m.minValue:g},get value(){return m.value},set value(t){m.value=t,b.setValueAtTime(t,p.context.currentTime)},cancelAndHoldAtTime:function(t){if("function"==typeof m.cancelAndHoldAtTime)null===y&&v.flush(p.context.currentTime),v.add(s(t)),m.cancelAndHoldAtTime(t);else{var e=Array.from(v).pop();null===y&&v.flush(p.context.currentTime),v.add(s(t));var n=Array.from(v).pop();m.cancelScheduledValues(t),e!==n&&void 0!==n&&("exponentialRampToValue"===n.type?m.exponentialRampToValueAtTime(n.value,n.endTime):"linearRampToValue"===n.type?m.linearRampToValueAtTime(n.value,n.endTime):"setValue"===n.type?m.setValueAtTime(n.value,n.startTime):"setValueCurve"===n.type&&m.setValueCurveAtTime(n.values,n.startTime,n.duration))}return b},cancelScheduledValues:function(t){return null===y&&v.flush(p.context.currentTime),v.add(o(t)),m.cancelScheduledValues(t),b},exponentialRampToValueAtTime:function(t,e){if(0===t)throw new RangeError;if(!Number.isFinite(e)||e<0)throw new RangeError;return null===y&&v.flush(p.context.currentTime),v.add(a(t,e)),m.exponentialRampToValueAtTime(t,e),b},linearRampToValueAtTime:function(t,e){return null===y&&v.flush(p.context.currentTime),v.add(u(t,e)),m.linearRampToValueAtTime(t,e),b},setTargetAtTime:function(t,e,n){return null===y&&v.flush(p.context.currentTime),v.add(c(t,e,n)),m.setTargetAtTime(t,e,n),b},setValueAtTime:function(t,e){return null===y&&v.flush(p.context.currentTime),v.add(l(t,e)),m.setValueAtTime(t,e),b},setValueCurveAtTime:function(t,e,n){var i=t instanceof Float32Array?t:new Float32Array(t);if(null!==f&&"webkitAudioContext"===f.name){for(var r=e+n,s=p.context.sampleRate,o=Math.ceil(e*s),a=Math.floor(r*s),u=a-o,c=new Float32Array(u),l=0;l<u;l+=1){var d=(i.length-1)/n*((o+l)/s-e),_=Math.floor(d),g=Math.ceil(d);c[l]=_===g?i[_]:(1-(d-_))*i[_]+(1-(g-d))*i[g]}null===y&&v.flush(p.context.currentTime),v.add(h(c,e,n)),m.setValueCurveAtTime(c,e,n);var x=a/s;x<r&&b.setValueAtTime(c[c.length-1],x),b.setValueAtTime(i[i.length-1],r)}else null===y&&v.flush(p.context.currentTime),v.add(h(i,e,n)),m.setValueCurveAtTime(i,e,n);return b}};return i.set(b,m),n.set(b,p),t(b,y),b}}((Wi=j,function(t,e){Wi.set(t,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:e})}),_r,M,(function(t){return{replay:function(e){var n,i=ie(t);try{for(i.s();!(n=i.n()).done;){var r=n.value;if("exponentialRampToValue"===r.type){var s=r.endTime,o=r.value;e.exponentialRampToValueAtTime(o,s)}else if("linearRampToValue"===r.type){var a=r.endTime,u=r.value;e.linearRampToValueAtTime(u,a)}else if("setTarget"===r.type){var c=r.startTime,l=r.target,h=r.timeConstant;e.setTargetAtTime(l,c,h)}else if("setValue"===r.type){var f=r.startTime,p=r.value;e.setValueAtTime(p,f)}else{if("setValueCurve"!==r.type)throw new Error("Can't apply an unknown automation.");var d=r.duration,m=r.startTime,_=r.values;e.setValueCurveAtTime(_,m,d)}}}catch(t){i.e(t)}finally{i.f()}}}}),e.createCancelAndHoldAutomationEvent,e.createCancelScheduledValuesAutomationEvent,e.createExponentialRampToValueAutomationEvent,e.createLinearRampToValueAutomationEvent,e.createSetTargetAutomationEvent,e.createSetValueAutomationEvent,e.createSetValueCurveAutomationEvent,vr),Fr=function(t,e,n,i,r,s,o,a){return function(t){x.default(c,t);var u=dt(c);function c(t,i){var a;g.default(this,c);var l=s(t),h=pt(pt({},mt),i),f=r(l,h),p=o(l),d=p?e():null;return(a=u.call(this,t,!1,f,d))._audioBufferSourceNodeRenderer=d,a._isBufferNullified=!1,a._isBufferSet=null!==h.buffer,a._nativeAudioBufferSourceNode=f,a._onended=null,a._playbackRate=n(T.default(a),p,f.playbackRate,lt,ct),a}return b.default(c,[{key:"start",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0;if(this._nativeAudioBufferSourceNode.start(e,n,i),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.start=void 0===i?[e,n]:[e,n,i]),"closed"!==this.context.state){X(this);var r=function e(){t._nativeAudioBufferSourceNode.removeEventListener("ended",e),ht(t)&&H(t)};this._nativeAudioBufferSourceNode.addEventListener("ended",r)}}},{key:"stop",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this._nativeAudioBufferSourceNode.stop(t),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.stop=t)}},{key:"buffer",get:function(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer},set:function(t){if(this._nativeAudioBufferSourceNode.buffer=t,null!==t){if(this._isBufferSet)throw i();this._isBufferSet=!0}}},{key:"loop",get:function(){return this._nativeAudioBufferSourceNode.loop},set:function(t){this._nativeAudioBufferSourceNode.loop=t}},{key:"loopEnd",get:function(){return this._nativeAudioBufferSourceNode.loopEnd},set:function(t){this._nativeAudioBufferSourceNode.loopEnd=t}},{key:"loopStart",get:function(){return this._nativeAudioBufferSourceNode.loopStart},set:function(t){this._nativeAudioBufferSourceNode.loopStart=t}},{key:"onended",get:function(){return this._onended},set:function(t){var e="function"==typeof t?a(this,t):null;this._nativeAudioBufferSourceNode.onended=e;var n=this._nativeAudioBufferSourceNode.onended;this._onended=null!==n&&n===e?t:n}},{key:"playbackRate",get:function(){return this._playbackRate}}]),c}(t)}(wr,qr,Ir,rn,Mr,pr,mr,er),Vr=function(t,e,n,i,r,s,o,a){return function(t){x.default(c,t);var u=Ot(c);function c(t,n){var i;g.default(this,c);var l=s(t),h=o(l),f=r(l,n,h),p=h?e(a):null;return(i=u.call(this,t,!1,f,p))._isNodeOfNativeOfflineAudioContext=h,i._nativeAudioDestinationNode=f,i}return b.default(c,[{key:"channelCount",get:function(){return this._nativeAudioDestinationNode.channelCount},set:function(t){if(this._isNodeOfNativeOfflineAudioContext)throw i();if(t>this._nativeAudioDestinationNode.maxChannelCount)throw n();this._nativeAudioDestinationNode.channelCount=t}},{key:"channelCountMode",get:function(){return this._nativeAudioDestinationNode.channelCountMode},set:function(t){if(this._isNodeOfNativeOfflineAudioContext)throw i();this._nativeAudioDestinationNode.channelCountMode=t}},{key:"maxChannelCount",get:function(){return this._nativeAudioDestinationNode.maxChannelCount}}]),c}(t)}(wr,(function(t){var e=null,n=function(){var e=S.default(k.default.mark((function e(n,i,r){var s;return k.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=i.destination,e.next=3,t(n,i,s,r);case 3:return e.abrupt("return",s);case 4:case"end":return e.stop()}}),e)})));return function(t,n,i){return e.apply(this,arguments)}}();return{render:function(t,i,r){return null===e&&(e=n(t,i,r)),e}}}),rt,rn,function(t,e){return function(n,i,r){var s=n.destination;if(s.channelCount!==i)try{s.channelCount=i}catch(t){}r&&"explicit"!==s.channelCountMode&&(s.channelCountMode="explicit"),0===s.maxChannelCount&&Object.defineProperty(s,"maxChannelCount",{value:i});var o=t(n,{channelCount:i,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,gain:1});return e(o,"channelCount",(function(t){return function(){return t.call(o)}}),(function(t){return function(e){t.call(o,e);try{s.channelCount=e}catch(t){if(e>s.maxChannelCount)throw t}}})),e(o,"channelCountMode",(function(t){return function(){return t.call(o)}}),(function(t){return function(e){t.call(o,e),s.channelCountMode=e}})),e(o,"channelInterpretation",(function(t){return function(){return t.call(o)}}),(function(t){return function(e){t.call(o,e),s.channelInterpretation=e}})),Object.defineProperty(o,"maxChannelCount",{get:function(){return s.maxChannelCount}}),o.connect(s),o}}(Jn,Ii),pr,mr,hr),Nr=function(t,e,n,i,r){return function(){var s=new WeakMap,o=function(){var o=S.default(k.default.mark((function o(a,u,c){var l,h,f;return k.default.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(l=n(a),(h=nt(l,u))||(f={Q:l.Q.value,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,detune:l.detune.value,frequency:l.frequency.value,gain:l.gain.value,type:l.type},l=e(u,f)),s.set(u,l),h){o.next=15;break}return o.next=7,i(u,a.Q,l.Q,c);case 7:return o.next=9,i(u,a.detune,l.detune,c);case 9:return o.next=11,i(u,a.frequency,l.frequency,c);case 11:return o.next=13,i(u,a.gain,l.gain,c);case 13:o.next=23;break;case 15:return o.next=17,t(u,a.Q,l.Q,c);case 17:return o.next=19,t(u,a.detune,l.detune,c);case 19:return o.next=21,t(u,a.frequency,l.frequency,c);case 21:return o.next=23,t(u,a.gain,l.gain,c);case 23:return o.next=25,r(a,u,l,c);case 25:return o.abrupt("return",l);case 26:case"end":return o.stop()}}),o)})));return function(t,e,n){return o.apply(this,arguments)}}();return{render:function(t,e,n){var i=s.get(e);return void 0!==i?Promise.resolve(i):o(t,e,n)}}}}(jr,Yn,Nt,Pr,hr),Lr=function(t){return function(e,n){return t.set(e,n)}}(sr),zr=function(t,e,n,i,r,s,o,a){return function(t){x.default(c,t);var u=ke(c);function c(t,i){var l;g.default(this,c);var h=s(t),f=Oe(Oe({},Se),i),p=r(h,f),d=o(h),m=d?n():null;return(l=u.call(this,t,!1,p,m))._Q=e(T.default(l),d,p.Q,lt,ct),l._detune=e(T.default(l),d,p.detune,1200*Math.log2(lt),-1200*Math.log2(lt)),l._frequency=e(T.default(l),d,p.frequency,t.sampleRate/2,0),l._gain=e(T.default(l),d,p.gain,40*Math.log10(lt),ct),l._nativeBiquadFilterNode=p,a(T.default(l),1),l}return b.default(c,[{key:"getFrequencyResponse",value:function(t,e,n){if(this._nativeBiquadFilterNode.getFrequencyResponse(t,e,n),t.length!==e.length||e.length!==n.length)throw i()}},{key:"detune",get:function(){return this._detune}},{key:"frequency",get:function(){return this._frequency}},{key:"gain",get:function(){return this._gain}},{key:"Q",get:function(){return this._Q}},{key:"type",get:function(){return this._nativeBiquadFilterNode.type},set:function(t){this._nativeBiquadFilterNode.type=t}}]),c}(t)}(wr,Ir,Nr,sn,Yn,pr,mr,Lr),Br=function(t,e){return function(n,i,r){var s,o,a=new Set;return n.connect=(s=n.connect,function(r){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,c=0===a.size;if(e(r))return s.call(n,r,o,u),t(a,[r,o,u],(function(t){return t[0]===r&&t[1]===o&&t[2]===u}),!0),c&&i(),r;s.call(n,r,o),t(a,[r,o],(function(t){return t[0]===r&&t[1]===o}),!0),c&&i()}),n.disconnect=(o=n.disconnect,function(t,i,s){var u=a.size>0;if(void 0===t)o.apply(n),a.clear();else if("number"==typeof t){o.call(n,t);var c,l=Cn(a);try{for(l.s();!(c=l.n()).done;){var h=c.value;h[1]===t&&a.delete(h)}}catch(t){l.e(t)}finally{l.f()}}else{e(t)?o.call(n,t,i,s):o.call(n,t,i);var f,p=Cn(a);try{for(p.s();!(f=p.n()).done;){var d=f.value;d[0]!==t||void 0!==i&&d[1]!==i||void 0!==s&&d[2]!==s||a.delete(d)}}catch(t){p.e(t)}finally{p.f()}}var m=0===a.size;u&&m&&r()}),n}}(Dt,br),Wr=function(t,e){return function(n,i){i.channelCount=1,i.channelCountMode="explicit",Object.defineProperty(i,"channelCount",{get:function(){return 1},set:function(){throw t()}}),Object.defineProperty(i,"channelCountMode",{get:function(){return"explicit"},set:function(){throw t()}});var r=n.createBufferSource();e(i,(function(){for(var t=i.numberOfInputs,e=0;e<t;e+=1)r.connect(i,0,e)}),(function(){return r.disconnect(i)}))}}(rn,Br),Gr=function(t,e){return function(n,i){var r=n.createChannelMerger(i.numberOfInputs);return null!==t&&"webkitAudioContext"===t.name&&e(n,r),jn(r,i),r}}(vr,Wr),Ur=function(t,e,n){return function(){var i=new WeakMap,r=function(){var r=S.default(k.default.mark((function r(s,o,a){var u,c;return k.default.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return u=e(s),nt(u,o)||(c={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,numberOfInputs:u.numberOfInputs},u=t(o,c)),i.set(o,u),r.next=6,n(s,o,u,a);case 6:return r.abrupt("return",u);case 7:case"end":return r.stop()}}),r)})));return function(t,e,n){return r.apply(this,arguments)}}();return{render:function(t,e,n){var s=i.get(e);return void 0!==s?Promise.resolve(s):r(t,e,n)}}}}(Gr,Nt,hr),Yr=function(t,e,n,i,r){return function(t){x.default(o,t);var s=De(o);function o(t,a){g.default(this,o);var u=i(t),c=Ae(Ae({},Ce),a),l=n(u,c),h=r(u)?e():null;return s.call(this,t,!1,l,h)}return o}(t)}(wr,Ur,Gr,pr,mr),Zr=function(t,e,n){return function(){var i=new WeakMap,r=function(){var r=S.default(k.default.mark((function r(s,o,a){var u,c;return k.default.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return u=e(s),nt(u,o)||(c={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,numberOfOutputs:u.numberOfOutputs},u=t(o,c)),i.set(o,u),r.next=6,n(s,o,u,a);case 6:return r.abrupt("return",u);case 7:case"end":return r.stop()}}),r)})));return function(t,e,n){return r.apply(this,arguments)}}();return{render:function(t,e,n){var s=i.get(e);return void 0!==s?Promise.resolve(s):r(t,e,n)}}}}(Zn,Nt,hr),Xr=function(t,e,n,i,r,s){return function(t){x.default(a,t);var o=je(a);function a(t,u){g.default(this,a);var c=i(t),l=s(Ee(Ee({},Me),u)),h=n(c,l),f=r(c)?e():null;return o.call(this,t,!1,h,f)}return a}(t)}(wr,Zr,Zn,pr,mr,(function(t){return Li(Li({},t),{},{channelCount:t.numberOfOutputs})})),Qr=function(t,e,n,i){return function(r,s){var o=s.offset,a=D.default(s,["offset"]),u=r.createBuffer(1,2,44100),c=e(r,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),l=n(r,Hn(Hn({},a),{},{gain:o})),h=u.getChannelData(0);h[0]=1,h[1]=1,c.buffer=u,c.loop=!0;var f={get bufferSize(){},get channelCount(){return l.channelCount},set channelCount(t){l.channelCount=t},get channelCountMode(){return l.channelCountMode},set channelCountMode(t){l.channelCountMode=t},get channelInterpretation(){return l.channelInterpretation},set channelInterpretation(t){l.channelInterpretation=t},get context(){return l.context},get inputs(){return[]},get numberOfInputs(){return c.numberOfInputs},get numberOfOutputs(){return l.numberOfOutputs},get offset(){return l.gain},get onended(){return c.onended},set onended(t){c.onended=t},addEventListener:function(){return c.addEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])},dispatchEvent:function(){return c.dispatchEvent(arguments.length<=0?void 0:arguments[0])},removeEventListener:function(){return c.removeEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])},start:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;c.start.call(c,t)},stop:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;c.stop.call(c,t)}};return t(r,c),i(Xn(f,l),(function(){return c.connect(l)}),(function(){return c.disconnect(l)}))}}(Rr,Mr,Jn,Br),Hr=function(t,e,n,i,r){return function(s,o){if(void 0===s.createConstantSource)return n(s,o);var a=s.createConstantSource();return jn(a,o),Pn(a,o,"offset"),e(i,(function(){return i(s)}))||qn(a),e(r,(function(){return r(s)}))||In(a),t(s,a),a}}(Rr,ar,Qr,Qi,$i),$r=function(t,e,n,i,r){return function(){var s=new WeakMap,o=null,a=null,u=function(){var u=S.default(k.default.mark((function u(c,l,h){var f,p,d;return k.default.wrap((function(u){for(;;)switch(u.prev=u.next){case 0:if(f=n(c),(p=nt(f,l))||(d={channelCount:f.channelCount,channelCountMode:f.channelCountMode,channelInterpretation:f.channelInterpretation,offset:f.offset.value},f=e(l,d),null!==o&&f.start(o),null!==a&&f.stop(a)),s.set(l,f),p){u.next=9;break}return u.next=7,i(l,c.offset,f.offset,h);case 7:u.next=11;break;case 9:return u.next=11,t(l,c.offset,f.offset,h);case 11:return u.next=13,r(c,l,f,h);case 13:return u.abrupt("return",f);case 14:case"end":return u.stop()}}),u)})));return function(t,e,n){return u.apply(this,arguments)}}();return{set start(t){o=t},set stop(t){a=t},render:function(t,e,n){var i=s.get(e);return void 0!==i?Promise.resolve(i):u(t,e,n)}}}}(jr,Hr,Nt,Pr,hr),Jr=function(t,e,n,i,r,s,o){return function(t){x.default(u,t);var a=Ie(u);function u(t,o){var c;g.default(this,u);var l=r(t),h=qe(qe({},Fe),o),f=i(l,h),p=s(l),d=p?n():null;return(c=a.call(this,t,!1,f,d))._constantSourceNodeRenderer=d,c._nativeConstantSourceNode=f,c._offset=e(T.default(c),p,f.offset,lt,ct),c._onended=null,c}return b.default(u,[{key:"start",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(this._nativeConstantSourceNode.start(e),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.start=e),"closed"!==this.context.state){X(this);var n=function e(){t._nativeConstantSourceNode.removeEventListener("ended",e),ht(t)&&H(t)};this._nativeConstantSourceNode.addEventListener("ended",n)}}},{key:"stop",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this._nativeConstantSourceNode.stop(t),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.stop=t)}},{key:"offset",get:function(){return this._offset}},{key:"onended",get:function(){return this._onended},set:function(t){var e="function"==typeof t?o(this,t):null;this._nativeConstantSourceNode.onended=e;var n=this._nativeConstantSourceNode.onended;this._onended=null!==n&&n===e?t:n}}]),u}(t)}(wr,Ir,$r,Hr,pr,mr,er),Kr=function(t,e){return function(n,i){var r=n.createConvolver();if(jn(r,i),i.disableNormalization===r.normalize&&(r.normalize=!i.disableNormalization),En(r,i,"buffer"),i.channelCount>2)throw t();if(e(r,"channelCount",(function(t){return function(){return t.call(r)}}),(function(e){return function(n){if(n>2)throw t();return e.call(r,n)}})),"max"===i.channelCountMode)throw t();return e(r,"channelCountMode",(function(t){return function(){return t.call(r)}}),(function(e){return function(n){if("max"===n)throw t();return e.call(r,n)}})),r}}(ui,Ii),ts=function(t,e,n){return function(){var i=new WeakMap,r=function(){var r=S.default(k.default.mark((function r(s,o,a){var u,c;return k.default.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(u=e(s),nt(u,o)||(c={buffer:u.buffer,channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,disableNormalization:!u.normalize},u=t(o,c)),i.set(o,u),!Et(u)){r.next=9;break}return r.next=7,n(s,o,u.inputs[0],a);case 7:r.next=11;break;case 9:return r.next=11,n(s,o,u,a);case 11:return r.abrupt("return",u);case 12:case"end":return r.stop()}}),r)})));return function(t,e,n){return r.apply(this,arguments)}}();return{render:function(t,e,n){var s=i.get(e);return void 0!==s?Promise.resolve(s):r(t,e,n)}}}}(Kr,Nt,hr),es=function(t,e,n,i,r,s){return function(t){x.default(a,t);var o=Le(a);function a(t,u){var c;g.default(this,a);var l=i(t),h=Ne(Ne({},ze),u),f=n(l,h),p=r(l)?e():null;return(c=o.call(this,t,!1,f,p))._isBufferNullified=!1,c._nativeConvolverNode=f,null!==h.buffer&&s(T.default(c),h.buffer.duration),c}return b.default(a,[{key:"buffer",get:function(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer},set:function(t){if(this._nativeConvolverNode.buffer=t,null===t&&null!==this._nativeConvolverNode.buffer){var e=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=e.createBuffer(1,1,44100),this._isBufferNullified=!0,s(this,0)}else this._isBufferNullified=!1,s(this,null===this._nativeConvolverNode.buffer?0:this._nativeConvolverNode.buffer.duration)}},{key:"normalize",get:function(){return this._nativeConvolverNode.normalize},set:function(t){this._nativeConvolverNode.normalize=t}}]),a}(t)}(wr,ts,Kr,pr,mr,Lr),ns=function(t,e,n,i,r){return function(s){var o=new WeakMap,a=function(){var a=S.default(k.default.mark((function a(u,c,l){var h,f,p;return k.default.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(h=n(u),(f=nt(h,c))||(p={channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,delayTime:h.delayTime.value,maxDelayTime:s},h=e(c,p)),o.set(c,h),f){a.next=9;break}return a.next=7,i(c,u.delayTime,h.delayTime,l);case 7:a.next=11;break;case 9:return a.next=11,t(c,u.delayTime,h.delayTime,l);case 11:return a.next=13,r(u,c,h,l);case 13:return a.abrupt("return",h);case 14:case"end":return a.stop()}}),a)})));return function(t,e,n){return a.apply(this,arguments)}}();return{render:function(t,e,n){var i=o.get(e);return void 0!==i?Promise.resolve(i):a(t,e,n)}}}}(jr,$n,Nt,Pr,hr),is=function(t,e,n,i,r,s,o){return function(t){x.default(u,t);var a=Ye(u);function u(t,c){var l;g.default(this,u);var h=r(t),f=Ue(Ue({},Ze),c),p=i(h,f),d=s(h),m=d?n(f.maxDelayTime):null;return(l=a.call(this,t,!1,p,m))._delayTime=e(T.default(l),d,p.delayTime),o(T.default(l),f.maxDelayTime),l}return b.default(u,[{key:"delayTime",get:function(){return this._delayTime}}]),u}(t)}(wr,Ir,ns,$n,pr,mr,Lr),rs=function(t){return function(e,n){var i=e.createDynamicsCompressor();if(jn(i,n),n.channelCount>2)throw t();if("max"===n.channelCountMode)throw t();return Pn(i,n,"attack"),Pn(i,n,"knee"),Pn(i,n,"ratio"),Pn(i,n,"release"),Pn(i,n,"threshold"),i}}(ui),ss=function(t,e,n,i,r){return function(){var s=new WeakMap,o=function(){var o=S.default(k.default.mark((function o(a,u,c){var l,h,f;return k.default.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(l=n(a),(h=nt(l,u))||(f={attack:l.attack.value,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,knee:l.knee.value,ratio:l.ratio.value,release:l.release.value,threshold:l.threshold.value},l=e(u,f)),s.set(u,l),h){o.next=17;break}return o.next=7,i(u,a.attack,l.attack,c);case 7:return o.next=9,i(u,a.knee,l.knee,c);case 9:return o.next=11,i(u,a.ratio,l.ratio,c);case 11:return o.next=13,i(u,a.release,l.release,c);case 13:return o.next=15,i(u,a.threshold,l.threshold,c);case 15:o.next=27;break;case 17:return o.next=19,t(u,a.attack,l.attack,c);case 19:return o.next=21,t(u,a.knee,l.knee,c);case 21:return o.next=23,t(u,a.ratio,l.ratio,c);case 23:return o.next=25,t(u,a.release,l.release,c);case 25:return o.next=27,t(u,a.threshold,l.threshold,c);case 27:return o.next=29,r(a,u,l,c);case 29:return o.abrupt("return",l);case 30:case"end":return o.stop()}}),o)})));return function(t,e,n){return o.apply(this,arguments)}}();return{render:function(t,e,n){var i=s.get(e);return void 0!==i?Promise.resolve(i):o(t,e,n)}}}}(jr,rs,Nt,Pr,hr),os=function(t,e,n,i,r,s,o,a){return function(t){x.default(c,t);var u=$e(c);function c(t,r){var l;g.default(this,c);var h=s(t),f=He(He({},Je),r),p=i(h,f),d=o(h),m=d?n():null;return(l=u.call(this,t,!1,p,m))._attack=e(T.default(l),d,p.attack),l._knee=e(T.default(l),d,p.knee),l._nativeDynamicsCompressorNode=p,l._ratio=e(T.default(l),d,p.ratio),l._release=e(T.default(l),d,p.release),l._threshold=e(T.default(l),d,p.threshold),a(T.default(l),.006),l}return b.default(c,[{key:"attack",get:function(){return this._attack}},{key:"channelCount",get:function(){return this._nativeDynamicsCompressorNode.channelCount},set:function(t){var e=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=t,t>2)throw this._nativeDynamicsCompressorNode.channelCount=e,r()}},{key:"channelCountMode",get:function(){return this._nativeDynamicsCompressorNode.channelCountMode},set:function(t){var e=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=t,"max"===t)throw this._nativeDynamicsCompressorNode.channelCountMode=e,r()}},{key:"knee",get:function(){return this._knee}},{key:"ratio",get:function(){return this._ratio}},{key:"reduction",get:function(){return"number"==typeof this._nativeDynamicsCompressorNode.reduction.value?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}},{key:"release",get:function(){return this._release}},{key:"threshold",get:function(){return this._threshold}}]),c}(t)}(wr,Ir,ss,rs,ui,pr,mr,Lr),as=function(t,e,n,i,r){return function(){var s=new WeakMap,o=function(){var o=S.default(k.default.mark((function o(a,u,c){var l,h,f;return k.default.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(l=n(a),(h=nt(l,u))||(f={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,gain:l.gain.value},l=e(u,f)),s.set(u,l),h){o.next=9;break}return o.next=7,i(u,a.gain,l.gain,c);case 7:o.next=11;break;case 9:return o.next=11,t(u,a.gain,l.gain,c);case 11:return o.next=13,r(a,u,l,c);case 13:return o.abrupt("return",l);case 14:case"end":return o.stop()}}),o)})));return function(t,e,n){return o.apply(this,arguments)}}();return{render:function(t,e,n){var i=s.get(e);return void 0!==i?Promise.resolve(i):o(t,e,n)}}}}(jr,Jn,Nt,Pr,hr),us=function(t,e,n,i,r,s){return function(t){x.default(a,t);var o=en(a);function a(t,u){var c;g.default(this,a);var l=r(t),h=tn(tn({},nn),u),f=i(l,h),p=s(l),d=p?n():null;return(c=o.call(this,t,!1,f,d))._gain=e(T.default(c),p,f.gain,lt,ct),c}return b.default(a,[{key:"gain",get:function(){return this._gain}}]),a}(t)}(wr,Ir,as,Jn,pr,mr),cs=function(t,e,n,i){return function(r,s,o){var a=o.channelCount,u=o.channelCountMode,c=o.channelInterpretation,l=o.feedback,h=o.feedforward,f=Nn(s,r.sampleRate),p=l instanceof Float64Array?l:new Float64Array(l),d=h instanceof Float64Array?h:new Float64Array(h),m=p.length,_=d.length,g=Math.min(m,_);if(0===m||m>20)throw i();if(0===p[0])throw e();if(0===_||_>20)throw i();if(0===d[0])throw e();if(1!==p[0]){for(var v=0;v<_;v+=1)d[v]/=p[0];for(var y=1;y<m;y+=1)p[y]/=p[0]}var b=n(r,f,a,a);b.channelCount=a,b.channelCountMode=u,b.channelInterpretation=c;for(var x=[],w=[],O=[],k=0;k<a;k+=1){x.push(0);var S=new Float32Array(32),T=new Float32Array(32);S.fill(0),T.fill(0),w.push(S),O.push(T)}b.onaudioprocess=function(t){for(var e=t.inputBuffer,n=t.outputBuffer,i=e.numberOfChannels,r=0;r<i;r+=1){var s=e.getChannelData(r),o=n.getChannelData(r);x[r]=ln(p,m,d,_,g,w[r],O[r],x[r],32,s,o)}};var A=r.sampleRate/2;return Xn({get bufferSize(){return f},get channelCount(){return b.channelCount},set channelCount(t){b.channelCount=t},get channelCountMode(){return b.channelCountMode},set channelCountMode(t){b.channelCountMode=t},get channelInterpretation(){return b.channelInterpretation},set channelInterpretation(t){b.channelInterpretation=t},get context(){return b.context},get inputs(){return[b]},get numberOfInputs(){return b.numberOfInputs},get numberOfOutputs(){return b.numberOfOutputs},addEventListener:function(){return b.addEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])},dispatchEvent:function(){return b.dispatchEvent(arguments.length<=0?void 0:arguments[0])},getFrequencyResponse:function(e,n,i){if(e.length!==n.length||n.length!==i.length)throw t();for(var r=e.length,s=0;s<r;s+=1){var o=-Math.PI*(e[s]/A),a=[Math.cos(o),Math.sin(o)],u=Kn(ti(d,a),ti(p,a));n[s]=Math.sqrt(u[0]*u[0]+u[1]*u[1]),i[s]=Math.atan2(u[1],u[0])}},removeEventListener:function(){return b.removeEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])}},b)}}(sn,rn,ii,ui),ls=function(t,e,n,i){return function(r){return t(kn,(function(){return kn(r)}))?Promise.resolve(t(i,i)).then((function(t){if(!t){var e=n(r,512,0,1);r.oncomplete=function(){e.onaudioprocess=null,e.disconnect()},e.onaudioprocess=function(){return r.currentTime},e.connect(r.destination)}return r.startRendering()})):new Promise((function(t){var n=e(r,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});r.oncomplete=function(e){n.disconnect(),t(e.renderedBuffer)},n.connect(r.destination),r.startRendering()}))}}(ar,Jn,ii,function(t,e){return function(){if(null===e)return Promise.resolve(!1);var n=new e(1,1,44100),i=t(n,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise((function(t){n.oncomplete=function(){i.disconnect(),t(0!==n.currentTime)},n.startRendering()}))}}(Jn,dr)),hs=function(t,e,n,i,r){return function(s,o){var a=new WeakMap,u=null,c=function(){var c=S.default(k.default.mark((function c(l,h,f){var p,d,m,_,g;return k.default.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if(p=null,d=e(l),m=nt(d,h),void 0===h.createIIRFilter?p=t(h,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):m||(d=h.createIIRFilter(o,s)),a.set(h,null===p?d:p),null===p){c.next=17;break}if(null!==u){c.next=11;break}if(null!==n){c.next=9;break}throw new Error("Missing the native OfflineAudioContext constructor.");case 9:_=new n(l.context.destination.channelCount,l.context.length,h.sampleRate),u=S.default(k.default.mark((function t(){var e;return k.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i(l,_,_.destination,f);case 2:return t.next=4,r(_);case 4:return e=t.sent,t.abrupt("return",hn(e,h,s,o));case 6:case"end":return t.stop()}}),t)})))();case 11:return c.next=13,u;case 13:return g=c.sent,p.buffer=g,p.start(0),c.abrupt("return",p);case 17:return c.next=19,i(l,h,d,f);case 19:return c.abrupt("return",d);case 20:case"end":return c.stop()}}),c)})));return function(t,e,n){return c.apply(this,arguments)}}();return{render:function(t,e,n){var i=a.get(e);return void 0!==i?Promise.resolve(i):c(t,e,n)}}}}(Mr,Nt,dr,hr,ls),fs=function(t){return function(e,n,i){if(void 0===e.createIIRFilter)return t(e,n,i);var r=e.createIIRFilter(i.feedforward,i.feedback);return jn(r,i),r}}(cs),ps=function(t,e,n,i,r,s){return function(t){x.default(a,t);var o=un(a);function a(t,u){var c;g.default(this,a);var l=i(t),h=r(l),f=an(an({},cn),u),p=e(l,h?null:t.baseLatency,f),d=h?n(f.feedback,f.feedforward):null;return c=o.call(this,t,!1,p,d),function(t){var e;t.getFrequencyResponse=(e=t.getFrequencyResponse,function(n,i,r){if(n.length!==i.length||i.length!==r.length)throw sn();return e.call(t,n,i,r)})}(p),c._nativeIIRFilterNode=p,s(T.default(c),1),c}return b.default(a,[{key:"getFrequencyResponse",value:function(t,e,n){return this._nativeIIRFilterNode.getFrequencyResponse(t,e,n)}}]),a}(t)}(wr,fs,hs,pr,mr,Lr),ds=function(t,e,n,i,r){return function(s,o){var a,u,c,l,h,f,p=o.listener,d=void 0===p.forwardX?(a=e(o,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),u=r(o),c=i(o,256,9,0),l=function(e,i){var r=n(o,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:i});return r.connect(a,0,e),r.start(),Object.defineProperty(r.offset,"defaultValue",{get:function(){return i}}),t({context:s},u,r.offset,lt,ct)},h=[0,0,-1,0,1,0],f=[0,0,0],c.onaudioprocess=function(t){var e=t.inputBuffer,n=[e.getChannelData(0)[0],e.getChannelData(1)[0],e.getChannelData(2)[0],e.getChannelData(3)[0],e.getChannelData(4)[0],e.getChannelData(5)[0]];n.some((function(t,e){return t!==h[e]}))&&(p.setOrientation.apply(p,n),h=n);var i=[e.getChannelData(6)[0],e.getChannelData(7)[0],e.getChannelData(8)[0]];i.some((function(t,e){return t!==f[e]}))&&(p.setPosition.apply(p,i),f=i)},a.connect(c),{forwardX:l(0,0),forwardY:l(1,0),forwardZ:l(2,-1),positionX:l(6,0),positionY:l(7,0),positionZ:l(8,0),upX:l(3,0),upY:l(4,1),upZ:l(5,0)}):p,m=d.forwardX,_=d.forwardY,g=d.forwardZ,v=d.positionX,y=d.positionY,b=d.positionZ,x=d.upX,w=d.upY,O=d.upZ;return{get forwardX(){return m},get forwardY(){return _},get forwardZ(){return g},get positionX(){return v},get positionY(){return y},get positionZ(){return b},get upX(){return x},get upY(){return w},get upZ(){return O}}}}(Ir,Gr,Hr,ii,mr),ms=new WeakMap,_s=function(t,e,n,i,r,s){return function(n){x.default(a,n);var o=On(a);function a(n,s){var u;return g.default(this,a),(u=o.call(this,n))._nativeContext=n,P.set(T.default(u),n),i(n)&&r.set(n,new Set),u._destination=new t(T.default(u),s),u._listener=e(T.default(u),n),u._onstatechange=null,u}return b.default(a,[{key:"currentTime",get:function(){return this._nativeContext.currentTime}},{key:"destination",get:function(){return this._destination}},{key:"listener",get:function(){return this._listener}},{key:"onstatechange",get:function(){return this._onstatechange},set:function(t){var e="function"==typeof t?s(this,t):null;this._nativeContext.onstatechange=e;var n=this._nativeContext.onstatechange;this._onstatechange=null!==n&&n===e?t:n}},{key:"sampleRate",get:function(){return this._nativeContext.sampleRate}},{key:"state",get:function(){return this._nativeContext.state}}]),a}(n)}(Vr,ds,gr,mr,ms,er),gs=function(t,e,n,i,r,s){return function(o,a){var u=o.createOscillator();return jn(u,a),Pn(u,a,"detune"),Pn(u,a,"frequency"),void 0!==a.periodicWave?u.setPeriodicWave(a.periodicWave):En(u,a,"type"),e(n,(function(){return n(o)}))||qn(u),e(i,(function(){return i(o)}))||s(u,o),e(r,(function(){return r(o)}))||In(u),t(o,u),u}}(Rr,ar,Qi,Hi,$i,tr),vs=function(t,e,n,i,r){return function(){var s=new WeakMap,o=null,a=null,u=null,c=function(){var c=S.default(k.default.mark((function c(l,h,f){var p,d,m;return k.default.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if(p=n(l),(d=nt(p,h))||(m={channelCount:p.channelCount,channelCountMode:p.channelCountMode,channelInterpretation:p.channelInterpretation,detune:p.detune.value,frequency:p.frequency.value,periodicWave:null===o?void 0:o,type:p.type},p=e(h,m),null!==a&&p.start(a),null!==u&&p.stop(u)),s.set(h,p),d){c.next=11;break}return c.next=7,i(h,l.detune,p.detune,f);case 7:return c.next=9,i(h,l.frequency,p.frequency,f);case 9:c.next=15;break;case 11:return c.next=13,t(h,l.detune,p.detune,f);case 13:return c.next=15,t(h,l.frequency,p.frequency,f);case 15:return c.next=17,r(l,h,p,f);case 17:return c.abrupt("return",p);case 18:case"end":return c.stop()}}),c)})));return function(t,e,n){return c.apply(this,arguments)}}();return{set periodicWave(t){o=t},set start(t){a=t},set stop(t){u=t},render:function(t,e,n){var i=s.get(e);return void 0!==i?Promise.resolve(i):c(t,e,n)}}}}(jr,gs,Nt,Pr,hr),ys=function(t,e,n,i,r,s,o){return function(t){x.default(u,t);var a=mi(u);function u(t,o){var c;g.default(this,u);var l=r(t),h=di(di({},_i),o),f=n(l,h),p=s(l),d=p?i():null,m=t.sampleRate/2;return(c=a.call(this,t,!1,f,d))._detune=e(T.default(c),p,f.detune,153600,-153600),c._frequency=e(T.default(c),p,f.frequency,m,-m),c._nativeOscillatorNode=f,c._onended=null,c._oscillatorNodeRenderer=d,null!==c._oscillatorNodeRenderer&&void 0!==h.periodicWave&&(c._oscillatorNodeRenderer.periodicWave=h.periodicWave),c}return b.default(u,[{key:"setPeriodicWave",value:function(t){this._nativeOscillatorNode.setPeriodicWave(t),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=t)}},{key:"start",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(this._nativeOscillatorNode.start(e),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.start=e),"closed"!==this.context.state){X(this);var n=function e(){t._nativeOscillatorNode.removeEventListener("ended",e),ht(t)&&H(t)};this._nativeOscillatorNode.addEventListener("ended",n)}}},{key:"stop",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this._nativeOscillatorNode.stop(t),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.stop=t)}},{key:"detune",get:function(){return this._detune}},{key:"frequency",get:function(){return this._frequency}},{key:"onended",get:function(){return this._onended},set:function(t){var e="function"==typeof t?o(this,t):null;this._nativeOscillatorNode.onended=e;var n=this._nativeOscillatorNode.onended;this._onended=null!==n&&n===e?t:n}},{key:"type",get:function(){return this._nativeOscillatorNode.type},set:function(t){this._nativeOscillatorNode.type=t,null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=null)}}]),u}(t)}(wr,Ir,gs,vs,pr,mr,er),bs=function(t){return function(e,n){var i=t(e,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),r=e.createBuffer(1,2,44100);return i.buffer=r,i.loop=!0,i.connect(n),i.start(),function(){i.stop(),i.disconnect(n)}}}(Mr),xs=function(t,e,n,i,r){return function(s,o){var a=o.curve,u=o.oversample,c=D.default(o,["curve","oversample"]),l=s.createWaveShaper(),h=s.createWaveShaper();jn(l,c),jn(h,c);var f=n(s,ai(ai({},c),{},{gain:1})),p=n(s,ai(ai({},c),{},{gain:-1})),d=n(s,ai(ai({},c),{},{gain:1})),m=n(s,ai(ai({},c),{},{gain:-1})),_=null,g=!1,v=null,y={get bufferSize(){},get channelCount(){return l.channelCount},set channelCount(t){f.channelCount=t,p.channelCount=t,l.channelCount=t,d.channelCount=t,h.channelCount=t,m.channelCount=t},get channelCountMode(){return l.channelCountMode},set channelCountMode(t){f.channelCountMode=t,p.channelCountMode=t,l.channelCountMode=t,d.channelCountMode=t,h.channelCountMode=t,m.channelCountMode=t},get channelInterpretation(){return l.channelInterpretation},set channelInterpretation(t){f.channelInterpretation=t,p.channelInterpretation=t,l.channelInterpretation=t,d.channelInterpretation=t,h.channelInterpretation=t,m.channelInterpretation=t},get context(){return l.context},get curve(){return v},set curve(n){if(null!==n&&n.length<2)throw e();if(null===n)l.curve=n,h.curve=n;else{var r=n.length,o=new Float32Array(r+2-r%2),a=new Float32Array(r+2-r%2);o[0]=n[0],a[0]=-n[r-1];for(var u=Math.ceil((r+1)/2),c=(r+1)/2-1,p=1;p<u;p+=1){var d=p/u*c,m=Math.floor(d),y=Math.ceil(d);o[p]=m===y?n[m]:(1-(d-m))*n[m]+(1-(y-d))*n[y],a[p]=m===y?-n[r-1-m]:-(1-(d-m))*n[r-1-m]-(1-(y-d))*n[r-1-y]}o[u]=r%2==1?n[u-1]:(n[u-2]+n[u-1])/2,l.curve=o,h.curve=a}v=n,g&&(i(v)&&null===_?_=t(s,f):null!==_&&(_(),_=null))},get inputs(){return[f]},get numberOfInputs(){return l.numberOfInputs},get numberOfOutputs(){return l.numberOfOutputs},get oversample(){return l.oversample},set oversample(t){l.oversample=t,h.oversample=t},addEventListener:function(){return f.addEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])},dispatchEvent:function(){return f.dispatchEvent(arguments.length<=0?void 0:arguments[0])},removeEventListener:function(){return f.removeEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])}};return null!==a&&(y.curve=a instanceof Float32Array?a:new Float32Array(a)),u!==y.oversample&&(y.oversample=u),r(Xn(y,d),(function(){f.connect(l).connect(d),f.connect(p).connect(h).connect(m).connect(d),g=!0,i(v)&&(_=t(s,f))}),(function(){f.disconnect(l),l.disconnect(d),f.disconnect(p),p.disconnect(h),h.disconnect(m),m.disconnect(d),g=!1,null!==_&&(_(),_=null)}))}}(bs,rn,Jn,qi,Br),ws=function(t,e,n,i,r,s,o){return function(a,u){var c=a.createWaveShaper();if(null!==s&&"webkitAudioContext"===s.name)return n(a,u);jn(c,u);var l=null===u.curve||u.curve instanceof Float32Array?u.curve:new Float32Array(u.curve);if(null!==l&&l.length<2)throw e();En(c,{curve:l},"curve"),En(c,u,"oversample");var h=null,f=!1;return o(c,"curve",(function(t){return function(){return t.call(c)}}),(function(e){return function(n){return e.call(c,n),f&&(i(n)&&null===h?h=t(a,c):i(n)||null===h||(h(),h=null)),n}})),r(c,(function(){f=!0,i(c.curve)&&(h=t(a,c))}),(function(){f=!1,null!==h&&(h(),h=null)}))}}(bs,rn,xs,qi,Br,vr,Ii),Os=function(t,e,n,i,r,s,o,a,u){return function(c,l){var h=l.coneInnerAngle,f=l.coneOuterAngle,p=l.coneOuterGain,d=l.distanceModel,m=l.maxDistance,_=l.orientationX,g=l.orientationY,v=l.orientationZ,y=l.panningModel,b=l.positionX,x=l.positionY,w=l.positionZ,O=l.refDistance,k=l.rolloffFactor,S=D.default(l,["coneInnerAngle","coneOuterAngle","coneOuterGain","distanceModel","maxDistance","orientationX","orientationY","orientationZ","panningModel","positionX","positionY","positionZ","refDistance","rolloffFactor"]),T=c.createPanner();if(S.channelCount>2)throw o();if("max"===S.channelCountMode)throw o();jn(T,S);var C={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},R=n(c,ni(ni({},C),{},{channelInterpretation:"speakers",numberOfInputs:6})),E=i(c,ni(ni({},S),{},{gain:1})),j=i(c,ni(ni({},C),{},{gain:1})),M=i(c,ni(ni({},C),{},{gain:0})),P=i(c,ni(ni({},C),{},{gain:0})),q=i(c,ni(ni({},C),{},{gain:0})),I=i(c,ni(ni({},C),{},{gain:0})),F=i(c,ni(ni({},C),{},{gain:0})),V=r(c,256,6,1),N=s(c,ni(ni({},C),{},{curve:new Float32Array([1,1]),oversample:"none"})),L=[_,g,v],z=[b,x,w];V.onaudioprocess=function(t){var e=t.inputBuffer,n=[e.getChannelData(0)[0],e.getChannelData(1)[0],e.getChannelData(2)[0]];n.some((function(t,e){return t!==L[e]}))&&(T.setOrientation.apply(T,n),L=n);var i=[e.getChannelData(3)[0],e.getChannelData(4)[0],e.getChannelData(5)[0]];i.some((function(t,e){return t!==z[e]}))&&(T.setPosition.apply(T,i),z=i)},Object.defineProperty(M.gain,"defaultValue",{get:function(){return 0}}),Object.defineProperty(P.gain,"defaultValue",{get:function(){return 0}}),Object.defineProperty(q.gain,"defaultValue",{get:function(){return 0}}),Object.defineProperty(I.gain,"defaultValue",{get:function(){return 0}}),Object.defineProperty(F.gain,"defaultValue",{get:function(){return 0}});var B={get bufferSize(){},get channelCount(){return T.channelCount},set channelCount(t){if(t>2)throw o();E.channelCount=t,T.channelCount=t},get channelCountMode(){return T.channelCountMode},set channelCountMode(t){if("max"===t)throw o();E.channelCountMode=t,T.channelCountMode=t},get channelInterpretation(){return T.channelInterpretation},set channelInterpretation(t){E.channelInterpretation=t,T.channelInterpretation=t},get coneInnerAngle(){return T.coneInnerAngle},set coneInnerAngle(t){T.coneInnerAngle=t},get coneOuterAngle(){return T.coneOuterAngle},set coneOuterAngle(t){T.coneOuterAngle=t},get coneOuterGain(){return T.coneOuterGain},set coneOuterGain(t){if(t<0||t>1)throw e();T.coneOuterGain=t},get context(){return T.context},get distanceModel(){return T.distanceModel},set distanceModel(t){T.distanceModel=t},get inputs(){return[E]},get maxDistance(){return T.maxDistance},set maxDistance(t){if(t<0)throw new RangeError;T.maxDistance=t},get numberOfInputs(){return T.numberOfInputs},get numberOfOutputs(){return T.numberOfOutputs},get orientationX(){return j.gain},get orientationY(){return M.gain},get orientationZ(){return P.gain},get panningModel(){return T.panningModel},set panningModel(t){T.panningModel=t},get positionX(){return q.gain},get positionY(){return I.gain},get positionZ(){return F.gain},get refDistance(){return T.refDistance},set refDistance(t){if(t<0)throw new RangeError;T.refDistance=t},get rolloffFactor(){return T.rolloffFactor},set rolloffFactor(t){if(t<0)throw new RangeError;T.rolloffFactor=t},addEventListener:function(){return E.addEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])},dispatchEvent:function(){return E.dispatchEvent(arguments.length<=0?void 0:arguments[0])},removeEventListener:function(){return E.removeEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])}};return h!==B.coneInnerAngle&&(B.coneInnerAngle=h),f!==B.coneOuterAngle&&(B.coneOuterAngle=f),p!==B.coneOuterGain&&(B.coneOuterGain=p),d!==B.distanceModel&&(B.distanceModel=d),m!==B.maxDistance&&(B.maxDistance=m),_!==B.orientationX.value&&(B.orientationX.value=_),g!==B.orientationY.value&&(B.orientationY.value=g),v!==B.orientationZ.value&&(B.orientationZ.value=v),y!==B.panningModel&&(B.panningModel=y),b!==B.positionX.value&&(B.positionX.value=b),x!==B.positionY.value&&(B.positionY.value=x),w!==B.positionZ.value&&(B.positionZ.value=w),O!==B.refDistance&&(B.refDistance=O),k!==B.rolloffFactor&&(B.rolloffFactor=k),1===L[0]&&0===L[1]&&0===L[2]||T.setOrientation.apply(T,A.default(L)),0===z[0]&&0===z[1]&&0===z[2]||T.setPosition.apply(T,A.default(z)),u(Xn(B,T),(function(){E.connect(T),t(E,N,0,0),N.connect(j).connect(R,0,0),N.connect(M).connect(R,0,1),N.connect(P).connect(R,0,2),N.connect(q).connect(R,0,3),N.connect(I).connect(R,0,4),N.connect(F).connect(R,0,5),R.connect(V).connect(c.destination)}),(function(){E.disconnect(T),a(E,N,0,0),N.disconnect(j),j.disconnect(R),N.disconnect(M),M.disconnect(R),N.disconnect(P),P.disconnect(R),N.disconnect(q),q.disconnect(R),N.disconnect(I),I.disconnect(R),N.disconnect(F),F.disconnect(R),R.disconnect(V),V.disconnect(c.destination)}))}}(jt,rn,Gr,Jn,ii,ws,ui,Vt,Br),ks=function(t){return function(e,n){var i=e.createPanner();return void 0===i.orientationX?t(e,n):(jn(i,n),Pn(i,n,"orientationX"),Pn(i,n,"orientationY"),Pn(i,n,"orientationZ"),Pn(i,n,"positionX"),Pn(i,n,"positionY"),Pn(i,n,"positionZ"),En(i,n,"coneInnerAngle"),En(i,n,"coneOuterAngle"),En(i,n,"coneOuterGain"),En(i,n,"distanceModel"),En(i,n,"maxDistance"),En(i,n,"panningModel"),En(i,n,"refDistance"),En(i,n,"rolloffFactor"),i)}}(Os),Ss=function(t,e,n,i,r,s,o,a,u,c){return function(){var l=new WeakMap,h=null,f=function(){var f=S.default(k.default.mark((function f(p,d,m){var _,g,y,b,x,w,O;return k.default.wrap((function(f){for(;;)switch(f.prev=f.next){case 0:if(_=null,g=s(p),y={channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation},b=wi(wi({},y),{},{coneInnerAngle:g.coneInnerAngle,coneOuterAngle:g.coneOuterAngle,coneOuterGain:g.coneOuterGain,distanceModel:g.distanceModel,maxDistance:g.maxDistance,panningModel:g.panningModel,refDistance:g.refDistance,rolloffFactor:g.rolloffFactor}),x=nt(g,d),"bufferSize"in g?_=i(d,wi(wi({},y),{},{gain:1})):x||(w=wi(wi({},b),{},{orientationX:g.orientationX.value,orientationY:g.orientationY.value,orientationZ:g.orientationZ.value,positionX:g.positionX.value,positionY:g.positionY.value,positionZ:g.positionZ.value}),g=r(d,w)),l.set(d,null===_?g:_),null===_){f.next=12;break}return f.delegateYield(k.default.mark((function t(){var s,l,f,g,v,x,w,O,T,A,D,C,R,E;return k.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!==h){t.next=7;break}if(null!==o){t.next=3;break}throw new Error("Missing the native OfflineAudioContext constructor.");case 3:s=new o(6,p.context.length,d.sampleRate),(l=e(s,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6})).connect(s.destination),h=S.default(k.default.mark((function t(){var e,i;return k.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([p.orientationX,p.orientationY,p.orientationZ,p.positionX,p.positionY,p.positionZ].map(function(){var t=S.default(k.default.mark((function t(e,i){var r;return k.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n(s,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:0===i?1:0}),t.next=3,a(s,e,r.offset,m);case 3:return t.abrupt("return",r);case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()));case 2:for(e=t.sent,i=0;i<6;i+=1)e[i].connect(l,0,i),e[i].start(0);return t.abrupt("return",c(s));case 5:case"end":return t.stop()}}),t)})))();case 7:return t.next=9,h;case 9:return f=t.sent,g=i(d,wi(wi({},y),{},{gain:1})),t.next=13,u(p,d,g,m);case 13:for(v=[],x=0;x<f.numberOfChannels;x+=1)v.push(f.getChannelData(x));for(w=[v[0][0],v[1][0],v[2][0]],O=[v[3][0],v[4][0],v[5][0]],T=i(d,wi(wi({},y),{},{gain:1})),A=r(d,wi(wi({},b),{},{orientationX:w[0],orientationY:w[1],orientationZ:w[2],positionX:O[0],positionY:O[1],positionZ:O[2]})),g.connect(T).connect(A.inputs[0]),A.connect(_),D=128;D<f.length;D+=128)C=[v[0][D],v[1][D],v[2][D]],R=[v[3][D],v[4][D],v[5][D]],(C.some((function(t,e){return t!==w[e]}))||R.some((function(t,e){return t!==O[e]})))&&(w=C,O=R,E=D/d.sampleRate,T.gain.setValueAtTime(0,E),T=i(d,wi(wi({},y),{},{gain:0})),A=r(d,wi(wi({},b),{},{orientationX:w[0],orientationY:w[1],orientationZ:w[2],positionX:O[0],positionY:O[1],positionZ:O[2]})),T.gain.setValueAtTime(1,E),g.connect(T).connect(A.inputs[0]),A.connect(_));return t.abrupt("return",{v:_});case 23:case"end":return t.stop()}}),t)}))(),"t0",9);case 9:if(O=f.t0,"object"!==v.default(O)){f.next=12;break}return f.abrupt("return",O.v);case 12:if(x){f.next=27;break}return f.next=15,a(d,p.orientationX,g.orientationX,m);case 15:return f.next=17,a(d,p.orientationY,g.orientationY,m);case 17:return f.next=19,a(d,p.orientationZ,g.orientationZ,m);case 19:return f.next=21,a(d,p.positionX,g.positionX,m);case 21:return f.next=23,a(d,p.positionY,g.positionY,m);case 23:return f.next=25,a(d,p.positionZ,g.positionZ,m);case 25:f.next=39;break;case 27:return f.next=29,t(d,p.orientationX,g.orientationX,m);case 29:return f.next=31,t(d,p.orientationY,g.orientationY,m);case 31:return f.next=33,t(d,p.orientationZ,g.orientationZ,m);case 33:return f.next=35,t(d,p.positionX,g.positionX,m);case 35:return f.next=37,t(d,p.positionY,g.positionY,m);case 37:return f.next=39,t(d,p.positionZ,g.positionZ,m);case 39:if(!Et(g)){f.next=44;break}return f.next=42,u(p,d,g.inputs[0],m);case 42:f.next=46;break;case 44:return f.next=46,u(p,d,g,m);case 46:return f.abrupt("return",g);case 47:case"end":return f.stop()}}),f)})));return function(t,e,n){return f.apply(this,arguments)}}();return{render:function(t,e,n){var i=l.get(e);return void 0!==i?Promise.resolve(i):f(t,e,n)}}}}(jr,Gr,Hr,Jn,ks,Nt,dr,Pr,hr,ls),Ts=function(t,e,n,i,r,s,o){return function(t){x.default(u,t);var a=yi(u);function u(t,c){var l;g.default(this,u);var h=r(t),f=vi(vi({},bi),c),p=n(h,f),d=s(h),m=d?i():null;return(l=a.call(this,t,!1,p,m))._nativePannerNode=p,l._orientationX=e(T.default(l),d,p.orientationX,lt,ct),l._orientationY=e(T.default(l),d,p.orientationY,lt,ct),l._orientationZ=e(T.default(l),d,p.orientationZ,lt,ct),l._positionX=e(T.default(l),d,p.positionX,lt,ct),l._positionY=e(T.default(l),d,p.positionY,lt,ct),l._positionZ=e(T.default(l),d,p.positionZ,lt,ct),o(T.default(l),1),l}return b.default(u,[{key:"coneInnerAngle",get:function(){return this._nativePannerNode.coneInnerAngle},set:function(t){this._nativePannerNode.coneInnerAngle=t}},{key:"coneOuterAngle",get:function(){return this._nativePannerNode.coneOuterAngle},set:function(t){this._nativePannerNode.coneOuterAngle=t}},{key:"coneOuterGain",get:function(){return this._nativePannerNode.coneOuterGain},set:function(t){this._nativePannerNode.coneOuterGain=t}},{key:"distanceModel",get:function(){return this._nativePannerNode.distanceModel},set:function(t){this._nativePannerNode.distanceModel=t}},{key:"maxDistance",get:function(){return this._nativePannerNode.maxDistance},set:function(t){this._nativePannerNode.maxDistance=t}},{key:"orientationX",get:function(){return this._orientationX}},{key:"orientationY",get:function(){return this._orientationY}},{key:"orientationZ",get:function(){return this._orientationZ}},{key:"panningModel",get:function(){return this._nativePannerNode.panningModel},set:function(t){this._nativePannerNode.panningModel=t}},{key:"positionX",get:function(){return this._positionX}},{key:"positionY",get:function(){return this._positionY}},{key:"positionZ",get:function(){return this._positionZ}},{key:"refDistance",get:function(){return this._nativePannerNode.refDistance},set:function(t){this._nativePannerNode.refDistance=t}},{key:"rolloffFactor",get:function(){return this._nativePannerNode.rolloffFactor},set:function(t){this._nativePannerNode.rolloffFactor=t}}]),u}(t)}(wr,Ir,ks,Ss,pr,mr,Lr),As=function(t){return function(e,n){var i=n.disableNormalization,r=n.imag,s=n.real,o=r instanceof Float32Array?r:new Float32Array(r),a=s instanceof Float32Array?s:new Float32Array(s),u=e.createPeriodicWave(a,o,{disableNormalization:i});if(Array.from(r).length<2)throw t();return u}}(rt),Ds=function(t,e,n,i){return function(){function r(s,o){g.default(this,r);var a=e(s),u=i(ki(ki({},Si),o)),c=t(a,u);return n.add(c),c}return b.default(r,null,[{key:Symbol.hasInstance,value:function(t){return null!==t&&"object"===v.default(t)&&Object.getPrototypeOf(t)===r.prototype||n.has(t)}}]),r}()}(As,pr,new WeakSet,(function(t){var e=t.imag,n=t.real;return Bi(Bi({},t),{},void 0===e?void 0===n?{imag:[0,0],real:[0,0]}:{imag:Array.from(n,(function(){return 0})),real:n}:void 0===n?{imag:e,real:Array.from(e,(function(){return 0}))}:{imag:e,real:n})})),Cs=function(t,e,n,i,r,s){var o=new Float32Array([1,1]),a=Math.PI/2,u={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},c=si(si({},u),{},{oversample:"none"}),l=function(t,s,l,h,f){if(1===s)return function(t,e,r,s){for(var l=new Float32Array(16385),h=new Float32Array(16385),f=0;f<16385;f+=1){var p=f/16384*a;l[f]=Math.cos(p),h[f]=Math.sin(p)}var d=n(t,si(si({},u),{},{gain:0})),m=i(t,si(si({},c),{},{curve:l})),_=i(t,si(si({},c),{},{curve:o})),g=n(t,si(si({},u),{},{gain:0})),v=i(t,si(si({},c),{},{curve:h}));return{connectGraph:function(){e.connect(d),e.connect(_.inputs[0]),e.connect(g),_.connect(r),r.connect(m.inputs[0]),r.connect(v.inputs[0]),m.connect(d.gain),v.connect(g.gain),d.connect(s,0,0),g.connect(s,0,1)},disconnectGraph:function(){e.disconnect(d),e.disconnect(_.inputs[0]),e.disconnect(g),_.disconnect(r),r.disconnect(m.inputs[0]),r.disconnect(v.inputs[0]),m.disconnect(d.gain),v.disconnect(g.gain),d.disconnect(s,0,0),g.disconnect(s,0,1)}}}(t,l,h,f);if(2===s)return function(t,r,s,l){for(var h=new Float32Array(16385),f=new Float32Array(16385),p=new Float32Array(16385),d=new Float32Array(16385),m=Math.floor(8192.5),_=0;_<16385;_+=1)if(_>m){var g=(_-m)/(16384-m)*a;h[_]=Math.cos(g),f[_]=Math.sin(g),p[_]=0,d[_]=1}else{var v=_/(16384-m)*a;h[_]=1,f[_]=0,p[_]=Math.cos(v),d[_]=Math.sin(v)}var y=e(t,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),b=n(t,si(si({},u),{},{gain:0})),x=i(t,si(si({},c),{},{curve:h})),w=n(t,si(si({},u),{},{gain:0})),O=i(t,si(si({},c),{},{curve:f})),k=i(t,si(si({},c),{},{curve:o})),S=n(t,si(si({},u),{},{gain:0})),T=i(t,si(si({},c),{},{curve:p})),A=n(t,si(si({},u),{},{gain:0})),D=i(t,si(si({},c),{},{curve:d}));return{connectGraph:function(){r.connect(y),r.connect(k.inputs[0]),y.connect(b,0),y.connect(w,0),y.connect(S,1),y.connect(A,1),k.connect(s),s.connect(x.inputs[0]),s.connect(O.inputs[0]),s.connect(T.inputs[0]),s.connect(D.inputs[0]),x.connect(b.gain),O.connect(w.gain),T.connect(S.gain),D.connect(A.gain),b.connect(l,0,0),S.connect(l,0,0),w.connect(l,0,1),A.connect(l,0,1)},disconnectGraph:function(){r.disconnect(y),r.disconnect(k.inputs[0]),y.disconnect(b,0),y.disconnect(w,0),y.disconnect(S,1),y.disconnect(A,1),k.disconnect(s),s.disconnect(x.inputs[0]),s.disconnect(O.inputs[0]),s.disconnect(T.inputs[0]),s.disconnect(D.inputs[0]),x.disconnect(b.gain),O.disconnect(w.gain),T.disconnect(S.gain),D.disconnect(A.gain),b.disconnect(l,0,0),S.disconnect(l,0,0),w.disconnect(l,0,1),A.disconnect(l,0,1)}}}(t,l,h,f);throw r()};return function(e,i){var o=i.channelCount,a=i.channelCountMode,u=i.pan,c=D.default(i,["channelCount","channelCountMode","pan"]);if("max"===a)throw r();var h=t(e,si(si({},c),{},{channelCount:1,channelCountMode:a,numberOfInputs:2})),f=n(e,si(si({},c),{},{channelCount:o,channelCountMode:a,gain:1})),p=n(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:u}),d=l(e,o,f,p,h),m=d.connectGraph,_=d.disconnectGraph;Object.defineProperty(p.gain,"defaultValue",{get:function(){return 0}}),Object.defineProperty(p.gain,"minValue",{get:function(){return-1}});var g={get bufferSize(){},get channelCount(){return f.channelCount},set channelCount(t){if(f.channelCount!==t){v&&_();var n=l(e,t,f,p,h);m=n.connectGraph,_=n.disconnectGraph,v&&m()}f.channelCount=t},get channelCountMode(){return f.channelCountMode},set channelCountMode(t){if("clamped-max"===t||"max"===t)throw r();f.channelCountMode=t},get channelInterpretation(){return f.channelInterpretation},set channelInterpretation(t){f.channelInterpretation=t},get context(){return f.context},get inputs(){return[f]},get numberOfInputs(){return f.numberOfInputs},get numberOfOutputs(){return f.numberOfOutputs},get pan(){return p.gain},addEventListener:function(){return f.addEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])},dispatchEvent:function(){return f.dispatchEvent(arguments.length<=0?void 0:arguments[0])},removeEventListener:function(){return f.removeEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])}},v=!1;return s(Xn(g,h),(function(){m(),v=!0}),(function(){_(),v=!1}))}}(Gr,Zn,Jn,ws,ui,Br),Rs=function(t,e){return function(n,i){var r=i.channelCountMode;if("clamped-max"===r)throw e();if(void 0===n.createStereoPanner)return t(n,i);var s=n.createStereoPanner();return jn(s,i),Pn(s,i,"pan"),Object.defineProperty(s,"channelCountMode",{get:function(){return r},set:function(t){if(t!==r)throw e()}}),s}}(Cs,ui),Es=function(t,e,n,i,r){return function(){var s=new WeakMap,o=function(){var o=S.default(k.default.mark((function o(a,u,c){var l,h,f;return k.default.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(l=n(a),(h=nt(l,u))||(f={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,pan:l.pan.value},l=e(u,f)),s.set(u,l),h){o.next=9;break}return o.next=7,i(u,a.pan,l.pan,c);case 7:o.next=11;break;case 9:return o.next=11,t(u,a.pan,l.pan,c);case 11:if(!Et(l)){o.next=16;break}return o.next=14,r(a,u,l.inputs[0],c);case 14:o.next=18;break;case 16:return o.next=18,r(a,u,l,c);case 18:return o.abrupt("return",l);case 19:case"end":return o.stop()}}),o)})));return function(t,e,n){return o.apply(this,arguments)}}();return{render:function(t,e,n){var i=s.get(e);return void 0!==i?Promise.resolve(i):o(t,e,n)}}}}(jr,Rs,Nt,Pr,hr),js=function(t,e,n,i,r,s){return function(t){x.default(a,t);var o=Di(a);function a(t,u){var c;g.default(this,a);var l=r(t),h=Ai(Ai({},Ci),u),f=n(l,h),p=s(l),d=p?i():null;return(c=o.call(this,t,!1,f,d))._pan=e(T.default(c),p,f.pan),c}return b.default(a,[{key:"pan",get:function(){return this._pan}}]),a}(t)}(wr,Ir,Rs,Es,pr,mr),Ms=function(t,e,n){return function(){var i=new WeakMap,r=function(){var r=S.default(k.default.mark((function r(s,o,a){var u,c;return k.default.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(u=e(s),nt(u,o)||(c={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,curve:u.curve,oversample:u.oversample},u=t(o,c)),i.set(o,u),!Et(u)){r.next=9;break}return r.next=7,n(s,o,u.inputs[0],a);case 7:r.next=11;break;case 9:return r.next=11,n(s,o,u,a);case 11:return r.abrupt("return",u);case 12:case"end":return r.stop()}}),r)})));return function(t,e,n){return r.apply(this,arguments)}}();return{render:function(t,e,n){var s=i.get(e);return void 0!==s?Promise.resolve(s):r(t,e,n)}}}}(ws,Nt,hr),Ps=function(t,e,n,i,r,s,o){return function(t){x.default(u,t);var a=Mi(u);function u(t,e){var c;g.default(this,u);var l=r(t),h=ji(ji({},Pi),e),f=n(l,h),p=s(l)?i():null;return(c=a.call(this,t,!0,f,p))._isCurveNullified=!1,c._nativeWaveShaperNode=f,o(T.default(c),1),c}return b.default(u,[{key:"curve",get:function(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve},set:function(t){if(null===t)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(t.length<2)throw e();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=t}}},{key:"oversample",get:function(){return this._nativeWaveShaperNode.oversample},set:function(t){this._nativeWaveShaperNode.oversample=t}}]),u}(t)}(wr,rn,ws,Ms,pr,mr,Lr),qs=function(t){return null!==t&&t.isSecureContext}(ur),Is=function(t){return function(e,n,i){Object.defineProperties(t,{currentFrame:{configurable:!0,get:function(){return Math.round(e*n)}},currentTime:{configurable:!0,get:function(){return e}}});try{return i()}finally{null!==t&&(delete t.currentFrame,delete t.currentTime)}}}(ur),Fs=new WeakMap,Vs=function(t,e){return function(n){var i=t.get(n);if(void 0!==i)return i;if(null===e)throw new Error("Missing the native OfflineAudioContext constructor.");return i=new e(1,1,8e3),t.set(n,i),i}}(Fs,dr),Ns=function(t){return null===t?null:t.hasOwnProperty("AudioWorkletNode")?t.AudioWorkletNode:null}(ur),Ls=qs?function(t,e,n,i,r,s,o,a,u,c,l,h){return function(f,p){var d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{credentials:"omit"},m=s(f),v=new URL(p,h.location.href).toString();if(void 0!==m.audioWorklet)return Promise.all([r(p),Promise.resolve(t(l,l))]).then((function(t){var e=_.default(t,2),n=e[0],i=e[1],r=z(n,v),s=_.default(r,2),u=s[0],c=s[1],l=i?c:c.replace(/\s+extends\s+AudioWorkletProcessor\s*{/," extends (class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}){"),h=i?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));",f=i?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));",p="".concat(u,";(registerProcessor=>{").concat(l,"\n})((n,p)=>registerProcessor(n,class extends p{").concat(h,"process(i,o,p){").concat(f,"return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}))"),g=new Blob([p],{type:"application/javascript; charset=utf-8"}),y=URL.createObjectURL(g);return m.audioWorklet.addModule(y,d).then((function(){if(!a(m))return o(m).audioWorklet.addModule(y,d)})).finally((function(){return URL.revokeObjectURL(y)}))}));var y=c.get(f);if(void 0!==y&&y.has(p))return Promise.resolve();var b=u.get(f);if(void 0!==b){var x=b.get(p);if(void 0!==x)return x}var w=r(p).then((function(t){var e=z(t,v),i=_.default(e,2),r=i[0],s=i[1],o="".concat(r,";((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{").concat(s,"\n})})(window,'_AWGS')");return n(o)})).then((function(){var t=h._AWGS.pop();if(void 0===t)throw new SyntaxError;i(m.currentTime,m.sampleRate,(function(){return t((function t(){g.default(this,t)}),void 0,(function(t,n){if(""===t.trim())throw e();var i=F.get(m);if(void 0!==i){if(i.has(t))throw e();W(n),B(n.parameterDescriptors),i.set(t,n)}else W(n),B(n.parameterDescriptors),F.set(m,new Map([[t,n]]))}),m.sampleRate,void 0,void 0)}))}));return void 0===b?u.set(f,new Map([[p,w]])):b.set(p,w),w.then((function(){var t=c.get(f);void 0===t?c.set(f,new Set([p])):t.add(p)})).finally((function(){var t=u.get(f);void 0!==t&&t.delete(p)})),w}}(ar,ui,function(t){return function(e){return new Promise((function(n,i){if(null!==t){var r=t.document.head;if(null===r)i(new SyntaxError);else{var s=t.document.createElement("script"),o=new Blob([e],{type:"application/javascript"}),a=URL.createObjectURL(o),u=t.onerror,c=function(){t.onerror=u,URL.revokeObjectURL(a)};t.onerror=function(e,n,r,s,o){return n===a||n===t.location.href&&1===r&&1===s?(c(),i(o),!1):null!==u?u(e,n,r,s,o):void 0},s.onerror=function(){c(),i(new SyntaxError)},s.onload=function(){c(),n()},s.src=a,s.type="module",r.appendChild(s)}}else i(new SyntaxError)}))}}(ur),Is,function(t){return function(){var e=S.default(k.default.mark((function e(n){var i;return k.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(n);case 3:if(!(i=e.sent).ok){e.next=6;break}return e.abrupt("return",i.text());case 6:e.next=10;break;case 8:e.prev=8,e.t0=e.catch(0);case 10:throw t();case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}()}((function(){return new DOMException("","AbortError")})),pr,Vs,mr,new WeakMap,new WeakMap,function(t,e){return S.default(k.default.mark((function n(){var i,r,s,o,a,u,c;return k.default.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(null!==t){n.next=2;break}return n.abrupt("return",!0);case 2:if(null!==e){n.next=4;break}return n.abrupt("return",!1);case 4:return i=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),r=new e(1,128,8e3),s=URL.createObjectURL(i),o=!1,a=!1,n.prev=9,n.next=12,r.audioWorklet.addModule(s);case 12:return u=new t(r,"a",{numberOfOutputs:0}),c=r.createOscillator(),u.port.onmessage=function(){return o=!0},u.onprocessorerror=function(){return a=!0},c.connect(u),n.next=19,r.startRendering();case 19:n.next=23;break;case 21:n.prev=21,n.t0=n.catch(9);case 23:return n.prev=23,URL.revokeObjectURL(s),n.finish(23);case 26:return n.abrupt("return",o&&!a);case 27:case"end":return n.stop()}}),n,null,[[9,21,23,26]])})))}(Ns,dr),ur):void 0,zs=function(t,e){return function(n){return t(n)||e(n)}}(yr,mr),Bs=function(t,e,n,i,r,s,o,a,u,c,l){return function(h,f){var p=o(h)?h:s(h);if(r.has(f)){var d=n();return Promise.reject(d)}try{r.add(f)}catch(t){}return e(u,(function(){return u(p)}))?p.decodeAudioData(f).then((function(n){return e(a,(function(){return a(n)}))||l(n),t.add(n),n})):new Promise((function(e,n){var r=function(){try{t=f,(new MessageChannel).port1.postMessage(t,[t])}catch(t){}var t},s=function(t){n(t),r()};try{p.decodeAudioData(f,(function(n){"function"!=typeof n.copyFromChannel&&(c(n),st(n)),t.add(n),r(),e(n)}),(function(t){s(null===t?i():t)}))}catch(t){s(t)}}))}}(kr,ar,(function(){return new DOMException("","DataCloneError")}),(function(){return new DOMException("","EncodingError")}),new WeakSet,pr,zs,it,kn,Ar,Dr),Ws=function(t,e,n,i,r,s,o,a,u,c,l,h,f,p,d,m,_,v,y,w){return function(d){x.default(k,d);var O=xe(k);function k(e,n){var i;return g.default(this,k),(i=O.call(this,e,n))._nativeContext=e,i._audioWorklet=void 0===t?void 0:{addModule:function(e,n){return t(T.default(i),e,n)}},i}return b.default(k,[{key:"createAnalyser",value:function(){return new e(this)}},{key:"createBiquadFilter",value:function(){return new r(this)}},{key:"createBuffer",value:function(t,e,i){return new n({length:e,numberOfChannels:t,sampleRate:i})}},{key:"createBufferSource",value:function(){return new i(this)}},{key:"createChannelMerger",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6;return new s(this,{numberOfInputs:t})}},{key:"createChannelSplitter",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6;return new o(this,{numberOfOutputs:t})}},{key:"createConstantSource",value:function(){return new a(this)}},{key:"createConvolver",value:function(){return new u(this)}},{key:"createDelay",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return new l(this,{maxDelayTime:t})}},{key:"createDynamicsCompressor",value:function(){return new h(this)}},{key:"createGain",value:function(){return new f(this)}},{key:"createIIRFilter",value:function(t,e){return new p(this,{feedback:e,feedforward:t})}},{key:"createOscillator",value:function(){return new m(this)}},{key:"createPanner",value:function(){return new _(this)}},{key:"createPeriodicWave",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{disableNormalization:!1};return new v(this,be(be({},n),{},{imag:e,real:t}))}},{key:"createStereoPanner",value:function(){return new y(this)}},{key:"createWaveShaper",value:function(){return new w(this)}},{key:"decodeAudioData",value:function(t,e,n){return c(this._nativeContext,t).then((function(t){return"function"==typeof e&&e(t),t})).catch((function(t){throw"function"==typeof n&&n(t),t}))}},{key:"audioWorklet",get:function(){return this._audioWorklet}}]),k}(d)}(Ls,Or,Cr,Fr,zr,Yr,Xr,Jr,es,Bs,is,os,us,ps,_s,ys,Ts,Ds,js,Ps),Gs=function(t,e,n,i){return function(t){x.default(s,t);var r=mn(s);function s(t,o){var a;g.default(this,s);var u=n(t),c=e(u,o);if(i(u))throw TypeError();return(a=r.call(this,t,!0,c,null))._nativeMediaElementAudioSourceNode=c,a}return b.default(s,[{key:"mediaElement",get:function(){return this._nativeMediaElementAudioSourceNode.mediaElement}}]),s}(t)}(wr,(function(t,e){return t.createMediaElementSource(e.mediaElement)}),pr,mr),Us=function(t,e,n,i){return function(t){x.default(s,t);var r=vn(s);function s(t,o){var a;g.default(this,s);var u=n(t);if(i(u))throw new TypeError;var c=gn(gn({},yn),o),l=e(u,c);return(a=r.call(this,t,!1,l,null))._nativeMediaStreamAudioDestinationNode=l,a}return b.default(s,[{key:"stream",get:function(){return this._nativeMediaStreamAudioDestinationNode.stream}}]),s}(t)}(wr,(function(t,e){var n=t.createMediaStreamDestination();return jn(n,e),1===n.numberOfOutputs&&Object.defineProperty(n,"numberOfOutputs",{get:function(){return 0}}),n}),pr,mr),Ys=function(t,e,n,i){return function(t){x.default(s,t);var r=bn(s);function s(t,o){var a;g.default(this,s);var u=n(t),c=e(u,o);if(i(u))throw new TypeError;return(a=r.call(this,t,!0,c,null))._nativeMediaStreamAudioSourceNode=c,a}return b.default(s,[{key:"mediaStream",get:function(){return this._nativeMediaStreamAudioSourceNode.mediaStream}}]),s}(t)}(wr,(function(t,e){var n=e.mediaStream,i=n.getAudioTracks();i.sort((function(t,e){return t.id<e.id?-1:t.id>e.id?1:0}));var r=i.slice(0,1),s=t.createMediaStreamSource(new MediaStream(r));return Object.defineProperty(s,"mediaStream",{value:n}),s}),pr,mr),Zs=function(t,e){return function(n,i){var r=i.mediaStreamTrack;if("function"==typeof n.createMediaStreamTrackSource)return n.createMediaStreamTrackSource(r);var s=new MediaStream([r]),o=n.createMediaStreamSource(s);if("audio"!==r.kind)throw t();if(e(n))throw new TypeError;return o}}(rn,mr),Xs=function(t,e,n){return function(t){x.default(r,t);var i=xn(r);function r(t,s){g.default(this,r);var o=n(t),a=e(o,s);return i.call(this,t,!0,a,null)}return r}(t)}(wr,Zs,pr),Qs=function(t,e,n,i,r,s,o,a,u){return function(t){x.default(l,t);var c=wt(l);function l(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(g.default(this,l),null===u)throw new Error("Missing the native AudioContext constructor.");var r=new u(e);if(null===r)throw i();if(!xt(e.latencyHint))throw new TypeError("The provided value '".concat(e.latencyHint,"' is not a valid enum value of type AudioContextLatencyCategory."));if(void 0!==e.sampleRate&&r.sampleRate!==e.sampleRate)throw n();t=c.call(this,r,2);var s=e.latencyHint,o=r.sampleRate;if(t._baseLatency="number"==typeof r.baseLatency?r.baseLatency:"balanced"===s?512/o:"interactive"===s||void 0===s?256/o:"playback"===s?1024/o:128*Math.max(2,Math.min(128,Math.round(s*o/128)))/o,t._nativeAudioContext=r,"webkitAudioContext"===u.name?(t._nativeGainNode=r.createGain(),t._nativeOscillatorNode=r.createOscillator(),t._nativeGainNode.gain.value=1e-37,t._nativeOscillatorNode.connect(t._nativeGainNode).connect(r.destination),t._nativeOscillatorNode.start()):(t._nativeGainNode=null,t._nativeOscillatorNode=null),t._state=null,"running"===r.state){t._state="suspended";var a=function e(){"suspended"===t._state&&(t._state=null),r.removeEventListener("statechange",e)};r.addEventListener("statechange",a)}return t}return b.default(l,[{key:"close",value:function(){var t=this;return"closed"===this.state?this._nativeAudioContext.close().then((function(){throw e()})):("suspended"===this._state&&(this._state=null),this._nativeAudioContext.close().then((function(){null!==t._nativeGainNode&&null!==t._nativeOscillatorNode&&(t._nativeOscillatorNode.stop(),t._nativeGainNode.disconnect(),t._nativeOscillatorNode.disconnect()),bt(t)})))}},{key:"createMediaElementSource",value:function(t){return new r(this,{mediaElement:t})}},{key:"createMediaStreamDestination",value:function(){return new s(this)}},{key:"createMediaStreamSource",value:function(t){return new o(this,{mediaStream:t})}},{key:"createMediaStreamTrackSource",value:function(t){return new a(this,{mediaStreamTrack:t})}},{key:"resume",value:function(){var t=this;return"suspended"===this._state?new Promise((function(e,n){t._nativeAudioContext.addEventListener("statechange",(function i(){t._nativeAudioContext.removeEventListener("statechange",i),"running"===t._nativeAudioContext.state?e():t.resume().then(e,n)}))})):this._nativeAudioContext.resume().catch((function(t){if(void 0===t||15===t.code)throw e();throw t}))}},{key:"suspend",value:function(){return this._nativeAudioContext.suspend().catch((function(t){if(void 0===t)throw e();throw t}))}},{key:"baseLatency",get:function(){return this._baseLatency}},{key:"state",get:function(){return null!==this._state?this._state:this._nativeAudioContext.state}}]),l}(t)}(Ws,rn,ui,Ri,Gs,Us,Ys,Xs,vr),Hs=function(t){return function(e){var n=t.get(e);if(void 0===n)throw new Error("The context has no set of AudioWorkletNodes.");return n}}(ms),$s=function(t){return function(e,n){t(e).add(n)}}(Hs),Js=function(t){return function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=e[i];if(void 0===s)throw t();return Zt(n)?s.connect(n,0,r):s.connect(n,0)}}(rt),Ks=function(t){return function(e,n){t(e).delete(n)}}(Hs),to=function(t){return function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return void 0===n?e.forEach((function(t){return t.disconnect()})):"number"==typeof n?Xe(t,e,n).disconnect():Zt(n)?void 0===i?e.forEach((function(t){return t.disconnect(n)})):void 0===r?Xe(t,e,i).disconnect(n,0):Xe(t,e,i).disconnect(n,0,r):void 0===i?e.forEach((function(t){return t.disconnect(n)})):Xe(t,e,i).disconnect(n,0)}}(rt),eo=new WeakMap,no=function(t,e){return function(n){return e(t,n)}}(eo,G),io=function(t,e,n,i,r,s,o,a,u,c,l,h,f){return function(p,d,m,_){if(0===_.numberOfInputs&&0===_.numberOfOutputs)throw u();var g=Array.isArray(_.outputChannelCount)?_.outputChannelCount:Array.from(_.outputChannelCount);if(g.some((function(t){return t<1})))throw u();if(g.length!==_.numberOfOutputs)throw e();if("explicit"!==_.channelCountMode)throw u();var b=_.channelCount*_.numberOfInputs,x=g.reduce((function(t,e){return t+e}),0),w=void 0===m.parameterDescriptors?0:m.parameterDescriptors.length;if(b+w>6||x>6)throw u();for(var O=new MessageChannel,k=[],S=[],T=0;T<_.numberOfInputs;T+=1)k.push(o(p,{channelCount:_.channelCount,channelCountMode:_.channelCountMode,channelInterpretation:_.channelInterpretation,gain:1})),S.push(r(p,{channelCount:_.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:_.channelCount}));var A=[];if(void 0!==m.parameterDescriptors){var D,C=Gn(m.parameterDescriptors);try{var R=function(){var t=D.value,e=t.defaultValue,n=t.maxValue,i=t.minValue,r=t.name,o=s(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:void 0!==_.parameterData[r]?_.parameterData[r]:void 0===e?0:e});Object.defineProperties(o.offset,{defaultValue:{get:function(){return void 0===e?0:e}},maxValue:{get:function(){return void 0===n?lt:n}},minValue:{get:function(){return void 0===i?ct:i}}}),A.push(o)};for(C.s();!(D=C.n()).done;)R()}catch(t){C.e(t)}finally{C.f()}}for(var E=i(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,b+w)}),j=Nn(d,p.sampleRate),M=a(p,j,b+w,Math.max(1,x)),P=r(p,{channelCount:Math.max(1,x),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,x)}),q=[],I=0;I<_.numberOfOutputs;I+=1)q.push(i(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:g[I]}));for(var F=0;F<_.numberOfInputs;F+=1){k[F].connect(S[F]);for(var N=0;N<_.channelCount;N+=1)S[F].connect(E,N,F*_.channelCount+N)}var L=new se(void 0===m.parameterDescriptors?[]:m.parameterDescriptors.map((function(t,e){var n=t.name,i=A[e];return i.connect(E,0,b+e),i.start(0),[n,i.offset]})));E.connect(M);var z,B,W=_.channelInterpretation,G=null,U=0===_.numberOfOutputs?[M]:q,Y={get bufferSize(){return j},get channelCount(){return _.channelCount},set channelCount(t){throw n()},get channelCountMode(){return _.channelCountMode},set channelCountMode(t){throw n()},get channelInterpretation(){return W},set channelInterpretation(t){var e,n=Gn(k);try{for(n.s();!(e=n.n()).done;)e.value.channelInterpretation=t}catch(t){n.e(t)}finally{n.f()}W=t},get context(){return M.context},get inputs(){return k},get numberOfInputs(){return _.numberOfInputs},get numberOfOutputs(){return _.numberOfOutputs},get onprocessorerror(){return G},set onprocessorerror(t){"function"==typeof G&&Y.removeEventListener("processorerror",G),"function"==typeof(G="function"==typeof t?t:null)&&Y.addEventListener("processorerror",G)},get parameters(){return L},get port(){return O.port2},addEventListener:function(){return M.addEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])},connect:t.bind(null,U),disconnect:c.bind(null,U),dispatchEvent:function(){return M.dispatchEvent(arguments.length<=0?void 0:arguments[0])},removeEventListener:function(){return M.removeEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])}},Z=new Map;O.port1.addEventListener=(z=O.port1.addEventListener,function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];if("message"===e[0]){var i="function"==typeof e[1]?e[1]:"object"===v.default(e[1])&&null!==e[1]&&"function"==typeof e[1].handleEvent?e[1].handleEvent:null;if(null!==i){var r=Z.get(e[1]);void 0!==r?e[1]=r:(e[1]=function(t){l(p.currentTime,p.sampleRate,(function(){return i(t)}))},Z.set(i,e[1]))}}return z.call(O.port1,e[0],e[1],e[2])}),O.port1.removeEventListener=(B=O.port1.removeEventListener,function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];if("message"===e[0]){var i=Z.get(e[1]);void 0!==i&&(Z.delete(e[1]),e[1]=i)}return B.call(O.port1,e[0],e[1],e[2])});var X=null;Object.defineProperty(O.port1,"onmessage",{get:function(){return X},set:function(t){"function"==typeof X&&O.port1.removeEventListener("message",X),"function"==typeof(X="function"==typeof t?t:null)&&(O.port1.addEventListener("message",X),O.port1.start())}}),m.prototype.port=O.port1;var Q=null;(function(t,e,n,i){var r=V.get(t);void 0===r&&(r=new WeakMap,V.set(t,r));var s=zn(n,i);return r.set(e,s),s})(p,Y,m,_).then((function(t){return Q=t}));var H=fe(_.numberOfInputs,_.channelCount),$=fe(_.numberOfOutputs,g),J=void 0===m.parameterDescriptors?[]:m.parameterDescriptors.reduce((function(t,e){var n=e.name;return Wn(Wn({},t),{},y.default({},n,new Float32Array(128)))}),{}),K=!0,tt=function(){_.numberOfOutputs>0&&M.disconnect(P);for(var t=0,e=0;t<_.numberOfOutputs;t+=1){for(var n=q[t],i=0;i<g[t];i+=1)P.disconnect(n,e+i,i);e+=g[t]}},et=new Map;M.onaudioprocess=function(t){var e=t.inputBuffer,n=t.outputBuffer;null!==Q&&function(){for(var t=h(Y),i=function(i){for(var r=0;r<_.numberOfInputs;r+=1)for(var s=0;s<_.channelCount;s+=1)le(e,H[r],s,s,i);void 0!==m.parameterDescriptors&&m.parameterDescriptors.forEach((function(t,n){var r=t.name;le(e,J,r,b+n,i)}));for(var o=0;o<_.numberOfInputs;o+=1)for(var a=0;a<g[o];a+=1)0===$[o][a].byteLength&&($[o][a]=new Float32Array(128));try{var u=H.map((function(e,n){if(t[n].size>0)return et.set(n,j/128),e;var i=et.get(n);return void 0===i?[]:(e.every((function(t){return t.every((function(t){return 0===t}))}))&&(1===i?et.delete(n):et.set(n,i-1)),e)})),c=l(p.currentTime+i/p.sampleRate,p.sampleRate,(function(){return Q.process(u,$,J)}));K=c;for(var h=0,f=0;h<_.numberOfOutputs;h+=1){for(var d=0;d<g[h];d+=1)he(n,$[h],d,f+d,i);f+=g[h]}}catch(t){K=!1,Y.dispatchEvent(new ErrorEvent("processorerror",{colno:t.colno,filename:t.filename,lineno:t.lineno,message:t.message}))}if(!K){for(var v=0;v<_.numberOfInputs;v+=1){k[v].disconnect(S[v]);for(var y=0;y<_.channelCount;y+=1)S[i].disconnect(E,y,v*_.channelCount+y)}if(void 0!==m.parameterDescriptors)for(var x=m.parameterDescriptors.length,w=0;w<x;w+=1){var O=A[w];O.disconnect(E,0,b+w),O.stop()}return E.disconnect(M),M.onaudioprocess=null,nt?tt():st(),"break"}},r=0;r<j&&"break"!==i(r);r+=128);}()};var nt=!1,it=o(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),rt=function(){return M.connect(it).connect(p.destination)},st=function(){M.disconnect(it),it.disconnect()};return rt(),f(Y,(function(){if(K){st(),_.numberOfOutputs>0&&M.connect(P);for(var t=0,e=0;t<_.numberOfOutputs;t+=1){for(var n=q[t],i=0;i<g[t];i+=1)P.connect(n,e+i,i);e+=g[t]}}nt=!0}),(function(){K&&(rt(),tt()),nt=!1}))}}(Js,rt,rn,Gr,Zn,Hr,Jn,ii,ui,to,Is,no,Br),ro=function(t,e,n,i,r){return function(s,o,a,u,c,l){if(null!==a)try{var h=new a(s,u,l),f=new Map,p=null;if(Object.defineProperties(h,{channelCount:{get:function(){return l.channelCount},set:function(){throw t()}},channelCountMode:{get:function(){return"explicit"},set:function(){throw t()}},onprocessorerror:{get:function(){return p},set:function(t){"function"==typeof p&&h.removeEventListener("processorerror",p),"function"==typeof(p="function"==typeof t?t:null)&&h.addEventListener("processorerror",p)}}}),h.addEventListener=(_=h.addEventListener,function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];if("processorerror"===e[0]){var i="function"==typeof e[1]?e[1]:"object"===v.default(e[1])&&null!==e[1]&&"function"==typeof e[1].handleEvent?e[1].handleEvent:null;if(null!==i){var r=f.get(e[1]);void 0!==r?e[1]=r:(e[1]=function(t){"error"===t.type?(Object.defineProperties(t,{type:{value:"processorerror"}}),i(t)):i(new ErrorEvent(e[0],Vn({},t)))},f.set(i,e[1]))}}return _.call(h,"error",e[1],e[2]),_.call.apply(_,[h].concat(e))}),h.removeEventListener=(m=h.removeEventListener,function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];if("processorerror"===e[0]){var i=f.get(e[1]);void 0!==i&&(f.delete(e[1]),e[1]=i)}return m.call(h,"error",e[1],e[2]),m.call(h,e[0],e[1],e[2])}),0!==l.numberOfOutputs){var d=n(s,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return h.connect(d).connect(s.destination),r(h,(function(){return d.disconnect()}),(function(){return d.connect(s.destination)}))}return h}catch(t){if(11===t.code)throw i();throw t}var m,_;if(void 0===c)throw i();return function(t){var e=(new MessageChannel).port1;try{e.postMessage(t)}finally{e.close()}}(l),e(s,o,c,l)}}(rn,io,Jn,ui,Br),so=function(t,e,n,i,r,s,o,a,u,c,l,h,f,p,d,m){return function(g,v,y){var b=new WeakMap,x=null,w=function(){var a=S.default(k.default.mark((function a(w,O,T){var A,D,C,R,E,j,M,P,q,I,F,V,N,L,z,B,W,G,U,Y,Z,X,Q,H,$,J,K,tt,et,it,rt,st,ot,at;return k.default.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(A=l(w),D=null,C=nt(A,O),R=Array.isArray(v.outputChannelCount)?v.outputChannelCount:Array.from(v.outputChannelCount),null===h){for(E=R.reduce((function(t,e){return t+e}),0),j=r(O,{channelCount:Math.max(1,E),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,E)}),M=[],P=0;P<w.numberOfOutputs;P+=1)M.push(i(O,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:R[P]}));(q=o(O,{channelCount:v.channelCount,channelCountMode:v.channelCountMode,channelInterpretation:v.channelInterpretation,gain:1})).connect=e.bind(null,M),q.disconnect=u.bind(null,M),D=[j,M,q]}else C||(A=new h(O,g));if(b.set(O,null===D?A:D[2]),null===D){a.next=41;break}if(null!==x){a.next=32;break}if(void 0!==y){a.next=10;break}throw new Error("Missing the processor constructor.");case 10:if(null!==f){a.next=12;break}throw new Error("Missing the native OfflineAudioContext constructor.");case 12:if(I=w.channelCount*w.numberOfInputs,F=void 0===y.parameterDescriptors?0:y.parameterDescriptors.length,V=I+F,N=function(){var t=S.default(k.default.mark((function t(){var e,n,a,u,c,l,h,g,y,b,x,A,D;return k.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(e=new f(V,128*Math.ceil(w.context.length/128),O.sampleRate),n=[],a=[],u=0;u<v.numberOfInputs;u+=1)n.push(o(e,{channelCount:v.channelCount,channelCountMode:v.channelCountMode,channelInterpretation:v.channelInterpretation,gain:1})),a.push(r(e,{channelCount:v.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:v.channelCount}));return t.next=6,Promise.all(Array.from(w.parameters.values()).map(function(){var t=S.default(k.default.mark((function t(n){var i;return k.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=s(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:n.value}),t.next=3,p(e,n,i.offset,T);case 3:return t.abrupt("return",i);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 6:for(c=t.sent,l=i(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,I+F)}),h=0;h<v.numberOfInputs;h+=1)for(n[h].connect(a[h]),g=0;g<v.channelCount;g+=1)a[h].connect(l,g,h*v.channelCount+g);y=de(c.entries());try{for(y.s();!(b=y.n()).done;)x=_.default(b.value,2),A=x[0],(D=x[1]).connect(l,0,I+A),D.start(0)}catch(t){y.e(t)}finally{y.f()}return l.connect(e.destination),t.next=14,Promise.all(n.map((function(t){return d(w,e,t,T)})));case 14:return t.abrupt("return",m(e));case 15:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),a.t0=ve,a.t1=w,0!==V){a.next=22;break}a.t2=null,a.next=25;break;case 22:return a.next=24,N();case 24:a.t2=a.sent;case 25:a.t3=a.t2,a.t4=O,a.t5=v,a.t6=R,a.t7=y,a.t8=c,x=(0,a.t0)(a.t1,a.t3,a.t4,a.t5,a.t6,a.t7,a.t8);case 32:return a.next=34,x;case 34:for(L=a.sent,z=n(O,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),B=D,W=_.default(B,3),G=W[0],U=W[1],Y=W[2],null!==L&&(z.buffer=L,z.start(0)),z.connect(G),Z=0,X=0;Z<w.numberOfOutputs;Z+=1){for(Q=U[Z],H=0;H<R[Z];H+=1)G.connect(Q,X+H,H);X+=R[Z]}return a.abrupt("return",Y);case 41:if(C){a.next=61;break}$=de(w.parameters.entries()),a.prev=43,$.s();case 45:if((J=$.n()).done){a.next=51;break}return K=_.default(J.value,2),tt=K[0],et=K[1],a.next=49,p(O,et,A.parameters.get(tt),T);case 49:a.next=45;break;case 51:a.next=56;break;case 53:a.prev=53,a.t9=a.catch(43),$.e(a.t9);case 56:return a.prev=56,$.f(),a.finish(56);case 59:a.next=78;break;case 61:it=de(w.parameters.entries()),a.prev=62,it.s();case 64:if((rt=it.n()).done){a.next=70;break}return st=_.default(rt.value,2),ot=st[0],at=st[1],a.next=68,t(O,at,A.parameters.get(ot),T);case 68:a.next=64;break;case 70:a.next=75;break;case 72:a.prev=72,a.t10=a.catch(62),it.e(a.t10);case 75:return a.prev=75,it.f(),a.finish(75);case 78:return a.next=80,d(w,O,A,T);case 80:return a.abrupt("return",A);case 81:case"end":return a.stop()}}),a,null,[[43,53,56,59],[62,72,75,78]])})));return function(t,e,n){return a.apply(this,arguments)}}();return{render:function(t,e,n){a(e,t);var i=b.get(e);return void 0!==i?Promise.resolve(i):w(t,e,n)}}}}(jr,Js,Mr,Gr,Zn,Hr,Jn,Ks,to,Is,Nt,Ns,dr,Pr,hr,ls),oo=function(t){return function(e){return t.get(e)}}(Fs),ao=function(t){return function(e,n){t.set(e,n)}}(eo),uo=qs?function(t,e,n,i,r,s,o,a,u,c,l,h,f){return function(e){x.default(d,e);var p=ue(d);function d(e,f,m){var _,v;g.default(this,d);var y=a(e),b=u(y),x=l(ae(ae({},ce),m)),w=F.get(y),O=null==w?void 0:w.get(f),k=b||"closed"!==y.state?y:null!==(v=o(y))&&void 0!==v?v:y,S=r(k,b?null:e.baseLatency,c,f,O,x),A=b?i(f,x,O):null;_=p.call(this,e,!0,S,A);var D=[];S.parameters.forEach((function(t,e){var i=n(T.default(_),b,t);D.push([e,i])})),_._nativeAudioWorkletNode=S,_._onprocessorerror=null,_._parameters=new se(D),b&&t(y,T.default(_));var C=s(T.default(_)).activeInputs;return h(S,C),_}return b.default(d,[{key:"onprocessorerror",get:function(){return this._onprocessorerror},set:function(t){var e="function"==typeof t?f(this,t):null;this._nativeAudioWorkletNode.onprocessorerror=e;var n=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=null!==n&&n===e?t:n}},{key:"parameters",get:function(){return null===this._parameters?this._nativeAudioWorkletNode.parameters:this._parameters}},{key:"port",get:function(){return this._nativeAudioWorkletNode.port}}]),d}(e)}($s,wr,Ir,so,ro,_t,oo,pr,mr,Ns,(function(t){return Vi(Vi({},t),{},{outputChannelCount:void 0!==t.outputChannelCount?t.outputChannelCount:1===t.numberOfInputs&&1===t.numberOfOutputs?[t.channelCount]:Array.from({length:t.numberOfOutputs},(function(){return 1}))})}),ao,er):void 0,co=function(t,e,n,i,r){return function(i){x.default(o,i);var s=wn(o);function o(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(g.default(this,o),null===r)throw new Error("Missing the native AudioContext constructor.");var a=new r(i);if(null===a)throw n();if(!xt(i.latencyHint))throw new TypeError("The provided value '".concat(i.latencyHint,"' is not a valid enum value of type AudioContextLatencyCategory."));if(void 0!==i.sampleRate&&a.sampleRate!==i.sampleRate)throw e();t=s.call(this,a,2);var u=i.latencyHint,c=a.sampleRate;if(t._baseLatency="number"==typeof a.baseLatency?a.baseLatency:"balanced"===u?512/c:"interactive"===u||void 0===u?256/c:"playback"===u?1024/c:128*Math.max(2,Math.min(128,Math.round(u*c/128)))/c,t._nativeAudioContext=a,"webkitAudioContext"===r.name?(t._nativeGainNode=a.createGain(),t._nativeOscillatorNode=a.createOscillator(),t._nativeGainNode.gain.value=1e-37,t._nativeOscillatorNode.connect(t._nativeGainNode).connect(a.destination),t._nativeOscillatorNode.start()):(t._nativeGainNode=null,t._nativeOscillatorNode=null),t._state=null,"running"===a.state){t._state="suspended";var l=function e(){"suspended"===t._state&&(t._state=null),a.removeEventListener("statechange",e)};a.addEventListener("statechange",l)}return t}return b.default(o,[{key:"close",value:function(){var e=this;return"closed"===this.state?this._nativeAudioContext.close().then((function(){throw t()})):("suspended"===this._state&&(this._state=null),this._nativeAudioContext.close().then((function(){null!==e._nativeGainNode&&null!==e._nativeOscillatorNode&&(e._nativeOscillatorNode.stop(),e._nativeGainNode.disconnect(),e._nativeOscillatorNode.disconnect()),bt(e)})))}},{key:"resume",value:function(){var e=this;return"suspended"===this._state?new Promise((function(t,n){e._nativeAudioContext.addEventListener("statechange",(function i(){e._nativeAudioContext.removeEventListener("statechange",i),"running"===e._nativeAudioContext.state?t():e.resume().then(t,n)}))})):this._nativeAudioContext.resume().catch((function(e){if(void 0===e||15===e.code)throw t();throw e}))}},{key:"suspend",value:function(){return this._nativeAudioContext.suspend().catch((function(e){if(void 0===e)throw t();throw e}))}},{key:"baseLatency",get:function(){return this._baseLatency}},{key:"state",get:function(){return null!==this._state?this._state:this._nativeAudioContext.state}}]),o}(i)}(rn,ui,Ri,_s,vr),lo=function(t,e){return function(n,i,r){if(null===e)throw new Error("Missing the native OfflineAudioContext constructor.");try{return new e(n,i,r)}catch(e){if("SyntaxError"===e.name)throw t();throw e}}}(ui,dr),ho=function(t,e,n,i,r,s,o,a){var u=[];return function(c,l){return n(c).render(c,l,u).then((function(){return Promise.all(Array.from(i(l)).map((function(t){return n(t).render(t,l,u)})))})).then((function(){return r(l)})).then((function(n){return"function"!=typeof n.copyFromChannel?(o(n),st(n)):e(s,(function(){return s(n)}))||a(n),t.add(n),n}))}}(kr,ar,lr,Hs,ls,it,Ar,Dr),fo=function(t,e,n,i,r){return function(i){x.default(o,i);var s=An(o);function o(e){var i;g.default(this,o);var r,a=Tn(Tn({},Dn),e),u=a.length,c=a.numberOfChannels,l=a.sampleRate,h=n(c,u,l);return t(kn,(function(){return kn(h)}))||h.addEventListener("statechange",(r=0,function t(e){"running"===i._state&&(r>0?(h.removeEventListener("statechange",t),e.stopImmediatePropagation(),i._waitForThePromiseToSettle(e)):r+=1)})),(i=s.call(this,h,c))._length=u,i._nativeOfflineAudioContext=h,i._state=null,i}return b.default(o,[{key:"startRendering",value:function(){var t=this;return"running"===this._state?Promise.reject(e()):(this._state="running",r(this.destination,this._nativeOfflineAudioContext).finally((function(){t._state=null,bt(t)})))}},{key:"_waitForThePromiseToSettle",value:function(t){var e=this;null===this._state?this._nativeOfflineAudioContext.dispatchEvent(t):setTimeout((function(){return e._waitForThePromiseToSettle(t)}))}},{key:"length",get:function(){return void 0===this._nativeOfflineAudioContext.length?this._length:this._nativeOfflineAudioContext.length}},{key:"state",get:function(){return null===this._state?this._nativeOfflineAudioContext.state:this._state}}]),o}(i)}(ar,rn,lo,_s,ho),po=function(t,e,n,i,r){return function(t){x.default(o,t);var s=hi(o);function o(t,n,r){var a,u;if(g.default(this,o),"number"==typeof t&&void 0!==n&&void 0!==r)u={length:n,numberOfChannels:t,sampleRate:r};else{if("object"!==v.default(t))throw new Error("The given parameters are not valid.");u=t}var c,l=li(li({},fi),u),h=l.length,f=l.numberOfChannels,p=l.sampleRate,d=i(f,h,p);return e(kn,(function(){return kn(d)}))||d.addEventListener("statechange",(c=0,function t(e){"running"===a._state&&(c>0?(d.removeEventListener("statechange",t),e.stopImmediatePropagation(),a._waitForThePromiseToSettle(e)):c+=1)})),(a=s.call(this,d,f))._length=h,a._nativeOfflineAudioContext=d,a._state=null,a}return b.default(o,[{key:"startRendering",value:function(){var t=this;return"running"===this._state?Promise.reject(n()):(this._state="running",r(this.destination,this._nativeOfflineAudioContext).finally((function(){t._state=null,bt(t)})))}},{key:"_waitForThePromiseToSettle",value:function(t){var e=this;null===this._state?this._nativeOfflineAudioContext.dispatchEvent(t):setTimeout((function(){return e._waitForThePromiseToSettle(t)}))}},{key:"length",get:function(){return void 0===this._nativeOfflineAudioContext.length?this._length:this._nativeOfflineAudioContext.length}},{key:"state",get:function(){return null===this._state?this._nativeOfflineAudioContext.state:this._state}}]),o}(t)}(Ws,ar,rn,lo,ho),mo=function(t,e){return function(n){var i=t.get(n);return e(i)||e(n)}}(P,yr),_o=function(t,e){return function(n){return t.has(n)||e(n)}}(E,br),go=function(t,e){return function(n){return t.has(n)||e(n)}}(M,xr),vo=function(t,e){return function(n){var i=t.get(n);return e(i)||e(n)}}(P,mr);t.AnalyserNode=Or,t.AudioBuffer=Cr,t.AudioBufferSourceNode=Fr,t.AudioContext=Qs,t.AudioWorkletNode=uo,t.BiquadFilterNode=zr,t.ChannelMergerNode=Yr,t.ChannelSplitterNode=Xr,t.ConstantSourceNode=Jr,t.ConvolverNode=es,t.DelayNode=is,t.DynamicsCompressorNode=os,t.GainNode=us,t.IIRFilterNode=ps,t.MediaElementAudioSourceNode=Gs,t.MediaStreamAudioDestinationNode=Us,t.MediaStreamAudioSourceNode=Ys,t.MediaStreamTrackAudioSourceNode=Xs,t.MinimalAudioContext=co,t.MinimalOfflineAudioContext=fo,t.OfflineAudioContext=po,t.OscillatorNode=ys,t.PannerNode=Ts,t.PeriodicWave=Ds,t.StereoPannerNode=js,t.WaveShaperNode=Ps,t.addAudioWorkletModule=Ls,t.decodeAudioData=Bs,t.isAnyAudioContext=mo,t.isAnyAudioNode=_o,t.isAnyAudioParam=go,t.isAnyOfflineAudioContext=vo,t.isSupported=function(){return dn(ar,function(t){return function(){if(null===t)return!1;var e=new t(1,1,44100).createBuffer(1,1,44100);if(void 0===e.copyToChannel)return!0;var n=new Float32Array(2);try{e.copyFromChannel(n,0,0)}catch(t){return!1}return!0}}(dr),function(t){return function(){if(null===t)return!1;if(void 0!==t.prototype&&void 0!==t.prototype.close)return!0;var e=new t,n=void 0!==e.close;try{e.close()}catch(t){}return n}}(vr),function(t){return function(){if(null===t)return Promise.resolve(!1);var e=new t(1,1,44100);return new Promise((function(t){var n,i=!0,r=function(n){i&&(i=!1,e.startRendering(),t(n instanceof TypeError))};try{n=e.decodeAudioData(null,(function(){}),r)}catch(t){r(t)}void 0!==n&&n.catch(r)}))}}(dr),function(t){return function(){if(null===t)return!1;var e;try{e=new t({latencyHint:"balanced"})}catch(t){return!1}return e.close(),!0}}(vr),function(t){return function(){if(null===t)return!1;var e=new t(1,1,44100).createGain(),n=e.connect(e)===e;return e.disconnect(e),n}}(dr),function(t,e){return S.default(k.default.mark((function n(){var i,r,s,o,a,u;return k.default.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(null!==t){n.next=2;break}return n.abrupt("return",!0);case 2:if(null!==e){n.next=4;break}return n.abrupt("return",!1);case 4:return i=new Blob(['class A extends AudioWorkletProcessor{process(){this.port.postMessage(0)}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),r=new e(1,128,8e3),s=URL.createObjectURL(i),o=!1,n.prev=8,n.next=11,r.audioWorklet.addModule(s);case 11:return a=new t(r,"a",{numberOfOutputs:0}),u=r.createOscillator(),a.port.onmessage=function(){return o=!0},u.connect(a),u.start(0),n.next=18,r.startRendering();case 18:if(o){n.next=21;break}return n.next=21,new Promise((function(t){return setTimeout(t,5)}));case 21:n.next=25;break;case 23:n.prev=23,n.t0=n.catch(8);case 25:return n.prev=25,URL.revokeObjectURL(s),n.finish(25);case 28:return n.abrupt("return",o);case 29:case"end":return n.stop()}}),n,null,[[8,23,25,28]])})))}(Ns,dr),function(t){return function(){if(null===t)return!1;var e=new t(1,1,44100).createChannelMerger();if("max"===e.channelCountMode)return!0;try{e.channelCount=2}catch(t){return!0}return!1}}(dr),function(t){return function(){if(null===t)return!1;var e=new t(1,1,44100);return void 0===e.createConstantSource||e.createConstantSource().offset.maxValue!==Number.POSITIVE_INFINITY}}(dr),function(t){return function(){if(null===t)return!1;var e=new t(1,1,44100),n=e.createConvolver();n.buffer=e.createBuffer(1,1,e.sampleRate);try{n.buffer=e.createBuffer(1,1,e.sampleRate)}catch(t){return!1}return!0}}(dr),function(t){return function(){if(null===t)return!1;var e=new t(1,1,44100).createConvolver();try{e.channelCount=1}catch(t){return!1}return!0}}(dr),Ji,function(t){return function(){return null!==t&&t.hasOwnProperty("isSecureContext")}}(ur),function(t){return function(){if(null===t)return!1;var e=new t;try{return e.createMediaStreamSource(new MediaStream),!1}catch(t){return!0}}}(vr),function(t){return function(){if(null===t)return Promise.resolve(!1);var e=new t(1,1,44100);if(void 0===e.createStereoPanner)return Promise.resolve(!0);if(void 0===e.createConstantSource)return Promise.resolve(!0);var n=e.createConstantSource(),i=e.createStereoPanner();return n.channelCount=1,n.offset.value=1,i.channelCount=1,n.start(),n.connect(i).connect(e.destination),e.startRendering().then((function(t){return 1!==t.getChannelData(0)[0]}))}}(dr),Ki)},Object.defineProperty(t,"__esModule",{value:!0})}(e,n(14),n(1),n(4),n(6),n(18),n(5),n(19),n(21),n(22),n(23),n(25),n(7),n(26),n(30))},function(t,e,n){var i=n(15),r=n(16),s=n(2),o=n(17);t.exports=function(t,e){return i(t)||r(t,e)||s(t,e)||o()}},function(t,e,n){var i=n(3);t.exports=function(t,e){if(t){if("string"==typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(t,e):void 0}}},function(t,e){t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}},function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},function(t,e){function n(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}t.exports=function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}},function(t,e){function n(e){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?t.exports=n=function(t){return typeof t}:t.exports=n=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(e)}t.exports=n},function(t,e){t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}},function(t,e){!function(){!window.hasOwnProperty("OfflineAudioContext")&&window.hasOwnProperty("webkitOfflineAudioContext")&&(window.OfflineAudioContext=window.webkitOfflineAudioContext);var t=new OfflineAudioContext(1,1,44100).startRendering();t&&"function"==typeof t.then||(OfflineAudioContext.prototype._native_startRendering=OfflineAudioContext.prototype.startRendering,OfflineAudioContext.prototype.startRendering=function(){return new Promise(function(t){this.oncomplete=function(e){t(e.renderedBuffer)},this._native_startRendering()}.bind(this))})}()},function(t,e){void 0!==window.AudioParam&&void 0===AudioParam.prototype.cancelAndHoldAtTime&&(void 0===AudioParam.prototype.cancelValuesAndHoldAtTime?AudioParam.prototype.cancelAndHoldAtTime=function(t){const e=this.getValueAtTime(t);return this.cancelScheduledValues(t),this.setValueAtTime(e,t),this}:AudioParam.prototype.cancelAndHoldAtTime=AudioParam.prototype.cancelValuesAndHoldAtTime)},function(t,e){AudioBuffer.prototype.hasOwnProperty("copyFromChannel")||(AudioBuffer.prototype.copyFromChannel=function(t,e,n){let i=this.getChannelData(0|e).subarray(0|n);t.set(i.subarray(0,Math.min(i.length,t.length)))}),AudioBuffer.prototype.hasOwnProperty("copyToChannel")||(AudioBuffer.prototype.copyToChannel=function(t,e,n){let i=t.subarray(0,Math.min(t.length,this.length-(0|n)));this.getChannelData(0|e).set(i,0|n)})},function(t,e,n){var i=n(12),r=function(t){for(var e=new Float32Array(128),n=0;n<128;n++)e[n]=1;return e}();function s(t,e){e=e||{};var n=t.createBufferSource(),i=t.createBuffer(1,r.length,t.sampleRate),s=t.createGain(),o="number"==typeof e.offset?e.offset:1,a=n.start;return s.channelCount=1,s.channelCountMode="explicit",s.channelInterpretation="discrete",s.gain.value=o,i.getChannelData(0).set(r),n.buffer=i,n.loop=!0,n.connect(s),Object.defineProperties(n,{offset:{value:s.gain,enumerable:!0,writable:!1,configurable:!0},start:{value:function(t){a.call(n,t)},enumerable:!1,writable:!1,configurable:!0},connect:{value:AudioNode.prototype.connect.bind(s),enumerable:!1,writable:!1,configurable:!0},disconnect:{value:AudioNode.prototype.disconnect.bind(s),enumerable:!1,writable:!1,configurable:!0}}),n}s.polyfill=function(){i&&!i.prototype.hasOwnProperty("createConstantSource")&&s.install()},s.install=function(){Object.defineProperty(i.prototype,"createConstantSource",{value:function(){return new s(this)},enumerable:!1,writable:!1,configurable:!0})},"function"==typeof Symbol&&"symbol"==typeof Symbol.hasInstance&&Object.defineProperty(s,Symbol.hasInstance,{value:function(t){return t instanceof AudioNode&&t.offset instanceof AudioParam}}),t.exports=s},function(t,e,n){(function(e){var n=e.AudioContext||e.webkitAudioContext,i=e.OfflineAudioContext||e.webkitOfflineAudioContext,r=e.BaseAudioContext||i&&Object.getPrototypeOf(i);t.exports="function"==typeof r&&r.prototype?r:n}).call(this,n(13))},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){!function(t,e,n,i){"use strict";function r(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var s=r(e),o=r(n),a=r(i),u=function(t,e,n){return{endTime:e,insertTime:n,type:"exponentialRampToValue",value:t}},c=function(t,e,n){return{endTime:e,insertTime:n,type:"linearRampToValue",value:t}},l=function(t,e){return{startTime:e,type:"setValue",value:t}},h=function(t,e,n){return{duration:n,startTime:e,type:"setValueCurve",values:t}},f=function(t,e,n){var i=n.startTime,r=n.target,s=n.timeConstant;return r+(e-r)*Math.exp((i-t)/s)},p=function(t){return"exponentialRampToValue"===t.type},d=function(t){return"linearRampToValue"===t.type},m=function(t){return p(t)||d(t)},_=function(t){return"setValue"===t.type},g=function(t){return"setValueCurve"===t.type},v=function t(e,n,i,r){var s=e[n];return void 0===s?r:m(s)||_(s)?s.value:g(s)?s.values[s.values.length-1]:f(i,t(e,n-1,s.startTime,r),s)},y=function(t,e,n,i,r){return void 0===n?[i.insertTime,r]:m(n)?[n.endTime,n.value]:_(n)?[n.startTime,n.value]:g(n)?[n.startTime+n.duration,n.values[n.values.length-1]]:[n.startTime,v(t,e-1,n.startTime,r)]},b=function(t){return"cancelAndHold"===t.type},x=function(t){return"cancelScheduledValues"===t.type},w=function(t){return b(t)||x(t)?t.cancelTime:p(t)||d(t)?t.endTime:t.startTime},O=function(t,e,n,i){var r=i.endTime,s=i.value;return n===s?s:0<n&&0<s||n<0&&s<0?n*Math.pow(s/n,(t-e)/(r-e)):0},k=function(t,e,n,i){return n+(t-e)/(i.endTime-e)*(i.value-n)},S=function(t,e){var n=e.duration,i=e.startTime,r=e.values;return function(t,e){var n=Math.floor(e),i=Math.ceil(e);return n===i?t[n]:(1-(e-n))*t[n]+(1-(i-e))*t[i]}(r,(t-i)/n*(r.length-1))},T=function(t){return"setTarget"===t.type},A=function(){function t(e){o.default(this,t),this._automationEvents=[],this._currenTime=0,this._defaultValue=e}return a.default(t,[{key:Symbol.iterator,value:function(){return this._automationEvents[Symbol.iterator]()}},{key:"add",value:function(t){var e=w(t);if(b(t)||x(t)){var n=this._automationEvents.findIndex((function(n){return x(t)&&g(n)?n.startTime+n.duration>=e:w(n)>=e})),i=this._automationEvents[n];if(-1!==n&&(this._automationEvents=this._automationEvents.slice(0,n)),b(t)){var r=this._automationEvents[this._automationEvents.length-1];if(void 0!==i&&m(i)){if(T(r))throw new Error("The internal list is malformed.");var s=g(r)?r.startTime+r.duration:w(r),o=g(r)?r.values[r.values.length-1]:r.value,a=p(i)?O(e,s,o,i):k(e,s,o,i),f=p(i)?u(a,e,this._currenTime):c(a,e,this._currenTime);this._automationEvents.push(f)}void 0!==r&&T(r)&&this._automationEvents.push(l(this.getValue(e),e)),void 0!==r&&g(r)&&r.startTime+r.duration>e&&(this._automationEvents[this._automationEvents.length-1]=h(new Float32Array([6,7]),r.startTime,e-r.startTime))}}else{var _=this._automationEvents.findIndex((function(t){return w(t)>e})),v=-1===_?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[_-1];if(void 0!==v&&g(v)&&w(v)+v.duration>e)return!1;var y=p(t)?u(t.value,t.endTime,this._currenTime):d(t)?c(t.value,e,this._currenTime):t;if(-1===_)this._automationEvents.push(y);else{if(g(t)&&e+t.duration>w(this._automationEvents[_]))return!1;this._automationEvents.splice(_,0,y)}}return!0}},{key:"flush",value:function(t){var e=this._automationEvents.findIndex((function(e){return w(e)>t}));if(e>1){var n=this._automationEvents.slice(e-1),i=n[0];T(i)&&n.unshift(l(v(this._automationEvents,e-2,i.startTime,this._defaultValue),i.startTime)),this._automationEvents=n}}},{key:"getValue",value:function(t){if(0===this._automationEvents.length)return this._defaultValue;var e=this._automationEvents[this._automationEvents.length-1],n=this._automationEvents.findIndex((function(e){return w(e)>t})),i=this._automationEvents[n],r=w(e)<=t?e:this._automationEvents[n-1];if(void 0!==r&&T(r)&&(void 0===i||!m(i)||i.insertTime>t))return f(t,v(this._automationEvents,n-2,r.startTime,this._defaultValue),r);if(void 0!==r&&_(r)&&(void 0===i||!m(i)))return r.value;if(void 0!==r&&g(r)&&(void 0===i||!m(i)||r.startTime+r.duration>t))return t<r.startTime+r.duration?S(t,r):r.values[r.values.length-1];if(void 0!==r&&m(r)&&(void 0===i||!m(i)))return r.value;if(void 0!==i&&p(i)){var o=y(this._automationEvents,n-1,r,i,this._defaultValue),a=s.default(o,2),u=a[0],c=a[1];return O(t,u,c,i)}if(void 0!==i&&d(i)){var l=y(this._automationEvents,n-1,r,i,this._defaultValue),h=s.default(l,2),b=h[0],x=h[1];return k(t,b,x,i)}return this._defaultValue}}]),t}();t.AutomationEventList=A,t.createCancelAndHoldAutomationEvent=function(t){return{cancelTime:t,type:"cancelAndHold"}},t.createCancelScheduledValuesAutomationEvent=function(t){return{cancelTime:t,type:"cancelScheduledValues"}},t.createExponentialRampToValueAutomationEvent=function(t,e){return{endTime:e,type:"exponentialRampToValue",value:t}},t.createLinearRampToValueAutomationEvent=function(t,e){return{endTime:e,type:"linearRampToValue",value:t}},t.createSetTargetAutomationEvent=function(t,e,n){return{startTime:e,target:t,timeConstant:n,type:"setTarget"}},t.createSetValueAutomationEvent=l,t.createSetValueCurveAutomationEvent=h,Object.defineProperty(t,"__esModule",{value:!0})}(e,n(1),n(4),n(5))},function(t,e){t.exports=function(t){if(Array.isArray(t))return t}},function(t,e){t.exports=function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],i=!0,r=!1,s=void 0;try{for(var o,a=t[Symbol.iterator]();!(i=(o=a.next()).done)&&(n.push(o.value),!e||n.length!==e);i=!0);}catch(t){r=!0,s=t}finally{try{i||null==a.return||a.return()}finally{if(r)throw s}}return n}}},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(t,e){t.exports=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}},function(t,e,n){var i=n(20);t.exports=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e)}},function(t,e){function n(e,i){return t.exports=n=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},n(e,i)}t.exports=n},function(t,e,n){var i=n(6),r=n(7);t.exports=function(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?r(t):e}},function(t,e){function n(e){return t.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},n(e)}t.exports=n},function(t,e,n){t.exports=n(24)},function(t,e,n){var i=function(t){"use strict";var e=Object.prototype,n=e.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},r=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",o=i.toStringTag||"@@toStringTag";function a(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{a({},"")}catch(t){a=function(t,e,n){return t[e]=n}}function u(t,e,n,i){var r=e&&e.prototype instanceof h?e:h,s=Object.create(r.prototype),o=new O(i||[]);return s._invoke=function(t,e,n){var i="suspendedStart";return function(r,s){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===r)throw s;return S()}for(n.method=r,n.arg=s;;){var o=n.delegate;if(o){var a=b(o,n);if(a){if(a===l)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===i)throw i="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i="executing";var u=c(t,e,n);if("normal"===u.type){if(i=n.done?"completed":"suspendedYield",u.arg===l)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(i="completed",n.method="throw",n.arg=u.arg)}}}(t,n,o),s}function c(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=u;var l={};function h(){}function f(){}function p(){}var d={};d[r]=function(){return this};var m=Object.getPrototypeOf,_=m&&m(m(k([])));_&&_!==e&&n.call(_,r)&&(d=_);var g=p.prototype=h.prototype=Object.create(d);function v(t){["next","throw","return"].forEach((function(e){a(t,e,(function(t){return this._invoke(e,t)}))}))}function y(t,e){var i;this._invoke=function(r,s){function o(){return new e((function(i,o){!function i(r,s,o,a){var u=c(t[r],t,s);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){i("next",t,o,a)}),(function(t){i("throw",t,o,a)})):e.resolve(h).then((function(t){l.value=t,o(l)}),(function(t){return i("throw",t,o,a)}))}a(u.arg)}(r,s,i,o)}))}return i=i?i.then(o,o):o()}}function b(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,b(t,e),"throw"===e.method))return l;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var i=c(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,l;var r=i.arg;return r?r.done?(e[t.resultName]=r.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,l):r:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,l)}function x(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function w(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(x,this),this.reset(!0)}function k(t){if(t){var e=t[r];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,s=function e(){for(;++i<t.length;)if(n.call(t,i))return e.value=t[i],e.done=!1,e;return e.value=void 0,e.done=!0,e};return s.next=s}}return{next:S}}function S(){return{value:void 0,done:!0}}return f.prototype=g.constructor=p,p.constructor=f,f.displayName=a(p,o,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,a(t,o,"GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},v(y.prototype),y.prototype[s]=function(){return this},t.AsyncIterator=y,t.async=function(e,n,i,r,s){void 0===s&&(s=Promise);var o=new y(u(e,n,i,r),s);return t.isGeneratorFunction(n)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},v(g),a(g,o,"Generator"),g[r]=function(){return this},g.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var i=e.pop();if(i in t)return n.value=i,n.done=!1,n}return n.done=!0,n}},t.values=k,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(w),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function i(n,i){return o.type="throw",o.arg=t,e.next=n,i&&(e.method="next",e.arg=void 0),!!i}for(var r=this.tryEntries.length-1;r>=0;--r){var s=this.tryEntries[r],o=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var a=n.call(s,"catchLoc"),u=n.call(s,"finallyLoc");if(a&&u){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(a){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i];if(r.tryLoc<=this.prev&&n.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var s=r;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=t,o.arg=e,s?(this.method="next",this.next=s.finallyLoc,l):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),l},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),w(n),l}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;w(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:k(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},t}(t.exports);try{regeneratorRuntime=i}catch(t){Function("r","regeneratorRuntime = r")(i)}},function(t,e){function n(t,e,n,i,r,s,o){try{var a=t[s](o),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(i,r)}t.exports=function(t){return function(){var e=this,i=arguments;return new Promise((function(r,s){var o=t.apply(e,i);function a(t){n(o,r,s,a,u,"next",t)}function u(t){n(o,r,s,a,u,"throw",t)}a(void 0)}))}}},function(t,e,n){var i=n(27),r=n(28),s=n(2),o=n(29);t.exports=function(t){return i(t)||r(t)||s(t)||o()}},function(t,e,n){var i=n(3);t.exports=function(t){if(Array.isArray(t))return i(t)}},function(t,e){t.exports=function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(t,e,n){var i=n(31);t.exports=function(t,e){if(null==t)return{};var n,r,s=i(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}},function(t,e){t.exports=function(t,e){if(null==t)return{};var n,i,r={},s=Object.keys(t);for(i=0;i<s.length;i++)n=s[i],e.indexOf(n)>=0||(r[n]=t[n]);return r}},function(t,e,n){"use strict";n.r(e),n.d(e,"getContext",(function(){return ut})),n.d(e,"setContext",(function(){return ct})),n.d(e,"Clock",(function(){return Bt})),n.d(e,"Context",(function(){return tt})),n.d(e,"Delay",(function(){return Wt})),n.d(e,"Gain",(function(){return Pt})),n.d(e,"Offline",(function(){return Gt})),n.d(e,"OfflineContext",(function(){return st})),n.d(e,"Param",(function(){return Ct})),n.d(e,"ToneAudioBuffer",(function(){return rt})),n.d(e,"ToneAudioBuffers",(function(){return Ut})),n.d(e,"ToneAudioNode",(function(){return Rt})),n.d(e,"connectSeries",(function(){return Et})),n.d(e,"connect",(function(){return jt})),n.d(e,"disconnect",(function(){return Mt})),n.d(e,"FrequencyClass",(function(){return xt})),n.d(e,"Frequency",(function(){return kt})),n.d(e,"MidiClass",(function(){return Yt})),n.d(e,"Midi",(function(){return Zt})),n.d(e,"TimeClass",(function(){return yt})),n.d(e,"Time",(function(){return bt})),n.d(e,"TicksClass",(function(){return Xt})),n.d(e,"Ticks",(function(){return Qt})),n.d(e,"TransportTimeClass",(function(){return St})),n.d(e,"TransportTime",(function(){return Tt})),n.d(e,"Emitter",(function(){return J})),n.d(e,"IntervalTimeline",(function(){return $t})),n.d(e,"StateTimeline",(function(){return Dt})),n.d(e,"Timeline",(function(){return Z})),n.d(e,"isUndef",(function(){return p})),n.d(e,"isDefined",(function(){return d})),n.d(e,"isFunction",(function(){return m})),n.d(e,"isNumber",(function(){return _})),n.d(e,"isObject",(function(){return g})),n.d(e,"isBoolean",(function(){return v})),n.d(e,"isArray",(function(){return y})),n.d(e,"isString",(function(){return b})),n.d(e,"isNote",(function(){return x})),n.d(e,"dbToGain",(function(){return ht})),n.d(e,"gainToDb",(function(){return ft})),n.d(e,"intervalToFrequencyRatio",(function(){return pt})),n.d(e,"ftom",(function(){return mt})),n.d(e,"mtof",(function(){return gt})),n.d(e,"optionsFromArguments",(function(){return F})),n.d(e,"defaultArg",(function(){return V})),n.d(e,"Unit",(function(){return r})),n.d(e,"debug",(function(){return i})),n.d(e,"Noise",(function(){return ae})),n.d(e,"UserMedia",(function(){return le})),n.d(e,"Oscillator",(function(){return pe})),n.d(e,"AMOscillator",(function(){return ve})),n.d(e,"FMOscillator",(function(){return ye})),n.d(e,"PulseOscillator",(function(){return be})),n.d(e,"FatOscillator",(function(){return xe})),n.d(e,"PWMOscillator",(function(){return we})),n.d(e,"OmniOscillator",(function(){return ke})),n.d(e,"ToneOscillatorNode",(function(){return fe})),n.d(e,"LFO",(function(){return De})),n.d(e,"ToneBufferSource",(function(){return oe})),n.d(e,"Player",(function(){return Ee})),n.d(e,"Players",(function(){return je})),n.d(e,"GrainPlayer",(function(){return Me})),n.d(e,"Add",(function(){return Se})),n.d(e,"Abs",(function(){return Pe})),n.d(e,"AudioToGain",(function(){return _e})),n.d(e,"GainToAudio",(function(){return qe})),n.d(e,"GreaterThan",(function(){return Ne})),n.d(e,"GreaterThanZero",(function(){return Ve})),n.d(e,"Multiply",(function(){return ge})),n.d(e,"Negate",(function(){return Ie})),n.d(e,"Pow",(function(){return Le})),n.d(e,"Signal",(function(){return Ft})),n.d(e,"connectSignal",(function(){return Vt})),n.d(e,"Scale",(function(){return Te})),n.d(e,"ScaleExp",(function(){return ze})),n.d(e,"Subtract",(function(){return Fe})),n.d(e,"SyncedSignal",(function(){return Be})),n.d(e,"WaveShaper",(function(){return me})),n.d(e,"Zero",(function(){return Ae})),n.d(e,"AMSynth",(function(){return He})),n.d(e,"DuoSynth",(function(){return en})),n.d(e,"FMSynth",(function(){return nn})),n.d(e,"MetalSynth",(function(){return sn})),n.d(e,"MembraneSynth",(function(){return on})),n.d(e,"MonoSynth",(function(){return tn})),n.d(e,"NoiseSynth",(function(){return an})),n.d(e,"PluckSynth",(function(){return mn})),n.d(e,"PolySynth",(function(){return _n})),n.d(e,"Sampler",(function(){return gn})),n.d(e,"Synth",(function(){return Xe})),n.d(e,"Loop",(function(){return yn})),n.d(e,"Part",(function(){return bn})),n.d(e,"Pattern",(function(){return Rn})),n.d(e,"Sequence",(function(){return En})),n.d(e,"ToneEvent",(function(){return vn})),n.d(e,"AutoFilter",(function(){return qn})),n.d(e,"AutoPanner",(function(){return Fn})),n.d(e,"AutoWah",(function(){return Nn})),n.d(e,"BitCrusher",(function(){return Ln})),n.d(e,"Chebyshev",(function(){return Bn})),n.d(e,"Chorus",(function(){return Zn})),n.d(e,"Distortion",(function(){return Xn})),n.d(e,"FeedbackDelay",(function(){return Hn})),n.d(e,"FrequencyShifter",(function(){return Jn})),n.d(e,"Freeverb",(function(){return ei})),n.d(e,"JCReverb",(function(){return si})),n.d(e,"PingPongDelay",(function(){return ai})),n.d(e,"PitchShift",(function(){return ui})),n.d(e,"Phaser",(function(){return ci})),n.d(e,"Reverb",(function(){return li})),n.d(e,"StereoWidener",(function(){return di})),n.d(e,"Tremolo",(function(){return mi})),n.d(e,"Vibrato",(function(){return _i})),n.d(e,"Analyser",(function(){return gi})),n.d(e,"Meter",(function(){return yi})),n.d(e,"FFT",(function(){return bi})),n.d(e,"DCMeter",(function(){return xi})),n.d(e,"Waveform",(function(){return wi})),n.d(e,"Follower",(function(){return Vn})),n.d(e,"Channel",(function(){return Si})),n.d(e,"CrossFade",(function(){return jn})),n.d(e,"Merge",(function(){return Gn})),n.d(e,"MidSideMerge",(function(){return fi})),n.d(e,"MidSideSplit",(function(){return hi})),n.d(e,"Mono",(function(){return Ti})),n.d(e,"MultibandSplit",(function(){return Ai})),n.d(e,"Panner",(function(){return In})),n.d(e,"Panner3D",(function(){return Ri})),n.d(e,"PanVol",(function(){return ki})),n.d(e,"Recorder",(function(){return Ei})),n.d(e,"Solo",(function(){return Oi})),n.d(e,"Split",(function(){return Wn})),n.d(e,"Volume",(function(){return Kt})),n.d(e,"Compressor",(function(){return ji})),n.d(e,"Gate",(function(){return Mi})),n.d(e,"Limiter",(function(){return Pi})),n.d(e,"MidSideCompressor",(function(){return qi})),n.d(e,"MultibandCompressor",(function(){return Ii})),n.d(e,"AmplitudeEnvelope",(function(){return Ze})),n.d(e,"Envelope",(function(){return We})),n.d(e,"FrequencyEnvelope",(function(){return Ke})),n.d(e,"EQ3",(function(){return Fi})),n.d(e,"Filter",(function(){return Je})),n.d(e,"OnePoleFilter",(function(){return pn})),n.d(e,"FeedbackCombFilter",(function(){return fn})),n.d(e,"LowpassCombFilter",(function(){return dn})),n.d(e,"Convolver",(function(){return Vi})),n.d(e,"BiquadFilter",(function(){return $e})),n.d(e,"version",(function(){return L})),n.d(e,"start",(function(){return lt})),n.d(e,"supported",(function(){return s.isSupported})),n.d(e,"now",(function(){return Ni})),n.d(e,"immediate",(function(){return Li})),n.d(e,"getTransport",(function(){return zi})),n.d(e,"getDestination",(function(){return Bi})),n.d(e,"getListener",(function(){return Wi})),n.d(e,"getDraw",(function(){return Gi})),n.d(e,"loaded",(function(){return Ui})),n.d(e,"Buffer",(function(){return Yi})),n.d(e,"Buffers",(function(){return Zi})),n.d(e,"BufferSource",(function(){return Xi}));var i={};n.r(i),n.d(i,"assert",(function(){return o})),n.d(i,"assertRange",(function(){return a})),n.d(i,"assertContextRunning",(function(){return u})),n.d(i,"setLogger",(function(){return l})),n.d(i,"log",(function(){return h})),n.d(i,"warn",(function(){return f}));var r={};n.r(r);var s=n(0);function o(t,e){if(!t)throw new Error(e)}function a(t,e,n=1/0){if(!(e<=t&&t<=n))throw new RangeError(`Value must be within [${e}, ${n}], got: ${t}`)}function u(t){t.isOffline||"running"===t.state||f('The AudioContext is "suspended". Invoke Tone.start() from a user action to start the audio.')}let c=console;function l(t){c=t}function h(...t){c.log(...t)}function f(...t){c.warn(...t)}function p(t){return void 0===t}function d(t){return!p(t)}function m(t){return"function"==typeof t}function _(t){return"number"==typeof t}function g(t){return"[object Object]"===Object.prototype.toString.call(t)&&t.constructor===Object}function v(t){return"boolean"==typeof t}function y(t){return Array.isArray(t)}function b(t){return"string"==typeof t}function x(t){return b(t)&&/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i.test(t)}let w=!0;function O(t,e,n){let i;if(w)try{i=new s.OfflineAudioContext(t,e,n)}catch(r){w=!1,console.warn("create stdOfflineAudioContext failed",r),console.warn("will use native OfflineAudioContext"),i=new OfflineAudioContext(t,e,n)}else i=new OfflineAudioContext(t,e,n);return i}const k="object"==typeof self?self:null,S=k&&(k.hasOwnProperty("AudioContext")||k.hasOwnProperty("webkitAudioContext"));let T=!0;function A(t,e,n,i){var r,s=arguments.length,o=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(o=(s<3?r(o):s>3?r(e,n,o):r(e,n))||o);return s>3&&o&&Object.defineProperty(e,n,o),o}function D(t,e,n,i){return new(n||(n=Promise))((function(r,s){function o(t){try{u(i.next(t))}catch(t){s(t)}}function a(t){try{u(i.throw(t))}catch(t){s(t)}}function u(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}u((i=i.apply(t,e||[])).next())}))}Object.create;Object.create;class C{constructor(t,e,n){this._callback=t,this._type=e,this._updateInterval=n,this._createClock()}_createWorker(){const t=new Blob([`\n\t\t\t// the initial timeout time\n\t\t\tlet timeoutTime =  ${(1e3*this._updateInterval).toFixed(1)};\n\t\t\t// onmessage callback\n\t\t\tself.onmessage = function(msg){\n\t\t\t\ttimeoutTime = parseInt(msg.data);\n\t\t\t};\n\t\t\t// the tick function which posts a message\n\t\t\t// and schedules a new tick\n\t\t\tfunction tick(){\n\t\t\t\tsetTimeout(tick, timeoutTime);\n\t\t\t\tself.postMessage('tick');\n\t\t\t}\n\t\t\t// call tick initially\n\t\t\ttick();\n\t\t\t`],{type:"text/javascript"}),e=URL.createObjectURL(t),n=new Worker(e);n.onmessage=this._callback.bind(this),this._worker=n}_createTimeout(){this._timeout=setTimeout(()=>{this._createTimeout(),this._callback()},1e3*this._updateInterval)}_createClock(){if("worker"===this._type)try{this._createWorker()}catch(t){this._type="timeout",this._createClock()}else"timeout"===this._type&&this._createTimeout()}_disposeClock(){this._timeout&&(clearTimeout(this._timeout),this._timeout=0),this._worker&&(this._worker.terminate(),this._worker.onmessage=null)}get updateInterval(){return this._updateInterval}set updateInterval(t){this._updateInterval=Math.max(t,128/44100),"worker"===this._type&&this._worker.postMessage(Math.max(1e3*t,1))}get type(){return this._type}set type(t){this._disposeClock(),this._type=t,this._createClock()}dispose(){this._disposeClock()}}function R(t){return Object(s.isAnyAudioParam)(t)}function E(t){return Object(s.isAnyAudioNode)(t)}function j(t){return Object(s.isAnyOfflineAudioContext)(t)}function M(t){return Object(s.isAnyAudioContext)(t)}function P(t){return t instanceof AudioBuffer}function q(t,e){return"value"===t||R(e)||E(e)||P(e)}function I(t,...e){if(!e.length)return t;const n=e.shift();if(g(t)&&g(n))for(const e in n)q(e,n[e])?t[e]=n[e]:g(n[e])?(t[e]||Object.assign(t,{[e]:{}}),I(t[e],n[e])):Object.assign(t,{[e]:n[e]});return I(t,...e)}function F(t,e,n=[],i){const r={},s=Array.from(e);if(g(s[0])&&i&&!Reflect.has(s[0],i)){Object.keys(s[0]).some(e=>Reflect.has(t,e))||(I(r,{[i]:s[0]}),n.splice(n.indexOf(i),1),s.shift())}if(1===s.length&&g(s[0]))I(r,s[0]);else for(let t=0;t<n.length;t++)d(s[t])&&(r[n[t]]=s[t]);return I(t,r)}function V(t,e){return p(t)?e:t}function N(t,e){return e.forEach(e=>{Reflect.has(t,e)&&delete t[e]}),t}const L="dev";
/**
 * Tone.js
 * @author Yotam Mann
 * @license http://opensource.org/licenses/MIT MIT License
 * @copyright 2014-2019 Yotam Mann
 */class z{constructor(){this.debug=!1,this._wasDisposed=!1}static getDefaults(){return{}}log(...t){(this.debug||k&&this.toString()===k.TONE_DEBUG_CLASS)&&h(this,...t)}dispose(){return this._wasDisposed=!0,this}get disposed(){return this._wasDisposed}toString(){return this.name}}z.version=L;function B(t,e){return t>e+1e-6}function W(t,e){return B(t,e)||U(t,e)}function G(t,e){return t+1e-6<e}function U(t,e){return Math.abs(t-e)<1e-6}function Y(t,e,n){return Math.max(Math.min(t,n),e)}class Z extends z{constructor(){super(),this.name="Timeline",this._timeline=[];const t=F(Z.getDefaults(),arguments,["memory"]);this.memory=t.memory,this.increasing=t.increasing}static getDefaults(){return{memory:1/0,increasing:!1}}get length(){return this._timeline.length}add(t){if(o(Reflect.has(t,"time"),"Timeline: events must have a time attribute"),t.time=t.time.valueOf(),this.increasing&&this.length){const e=this._timeline[this.length-1];o(W(t.time,e.time),"The time must be greater than or equal to the last scheduled time"),this._timeline.push(t)}else{const e=this._search(t.time);this._timeline.splice(e+1,0,t)}if(this.length>this.memory){const t=this.length-this.memory;this._timeline.splice(0,t)}return this}remove(t){const e=this._timeline.indexOf(t);return-1!==e&&this._timeline.splice(e,1),this}get(t,e="time"){const n=this._search(t,e);return-1!==n?this._timeline[n]:null}peek(){return this._timeline[0]}shift(){return this._timeline.shift()}getAfter(t,e="time"){const n=this._search(t,e);return n+1<this._timeline.length?this._timeline[n+1]:null}getBefore(t){const e=this._timeline.length;if(e>0&&this._timeline[e-1].time<t)return this._timeline[e-1];const n=this._search(t);return n-1>=0?this._timeline[n-1]:null}cancel(t){if(this._timeline.length>1){let e=this._search(t);if(e>=0)if(U(this._timeline[e].time,t)){for(let n=e;n>=0&&U(this._timeline[n].time,t);n--)e=n;this._timeline=this._timeline.slice(0,e)}else this._timeline=this._timeline.slice(0,e+1);else this._timeline=[]}else 1===this._timeline.length&&W(this._timeline[0].time,t)&&(this._timeline=[]);return this}cancelBefore(t){const e=this._search(t);return e>=0&&(this._timeline=this._timeline.slice(e+1)),this}previousEvent(t){const e=this._timeline.indexOf(t);return e>0?this._timeline[e-1]:null}_search(t,e="time"){if(0===this._timeline.length)return-1;let n=0;const i=this._timeline.length;let r=i;if(i>0&&this._timeline[i-1][e]<=t)return i-1;for(;n<r;){let i=Math.floor(n+(r-n)/2);const s=this._timeline[i],o=this._timeline[i+1];if(U(s[e],t)){for(let n=i;n<this._timeline.length;n++){if(!U(this._timeline[n][e],t))break;i=n}return i}if(G(s[e],t)&&B(o[e],t))return i;B(s[e],t)?r=i:n=i+1}return-1}_iterate(t,e=0,n=this._timeline.length-1){this._timeline.slice(e,n+1).forEach(t)}forEach(t){return this._iterate(t),this}forEachBefore(t,e){const n=this._search(t);return-1!==n&&this._iterate(e,0,n),this}forEachAfter(t,e){const n=this._search(t);return this._iterate(e,n+1),this}forEachBetween(t,e,n){let i=this._search(t),r=this._search(e);return-1!==i&&-1!==r?(this._timeline[i].time!==t&&(i+=1),this._timeline[r].time===e&&(r-=1),this._iterate(n,i,r)):-1===i&&this._iterate(n,0,r),this}forEachFrom(t,e){let n=this._search(t);for(;n>=0&&this._timeline[n].time>=t;)n--;return this._iterate(e,n+1),this}forEachAtTime(t,e){const n=this._search(t);if(-1!==n&&U(this._timeline[n].time,t)){let i=n;for(let e=n;e>=0&&U(this._timeline[e].time,t);e--)i=e;this._iterate(t=>{e(t)},i,n)}return this}dispose(){return super.dispose(),this._timeline=[],this}}const X=[];function Q(t){X.push(t)}const H=[];function $(t){H.push(t)}class J extends z{constructor(){super(...arguments),this.name="Emitter"}on(t,e){return t.split(/\W+/).forEach(t=>{p(this._events)&&(this._events={}),this._events.hasOwnProperty(t)||(this._events[t]=[]),this._events[t].push(e)}),this}once(t,e){const n=(...i)=>{e(...i),this.off(t,n)};return this.on(t,n),this}off(t,e){return t.split(/\W+/).forEach(n=>{if(p(this._events)&&(this._events={}),this._events.hasOwnProperty(t))if(p(e))this._events[t]=[];else{const n=this._events[t];for(let t=n.length-1;t>=0;t--)n[t]===e&&n.splice(t,1)}}),this}emit(t,...e){if(this._events&&this._events.hasOwnProperty(t)){const n=this._events[t].slice(0);for(let t=0,i=n.length;t<i;t++)n[t].apply(this,e)}return this}static mixin(t){["on","once","off","emit"].forEach(e=>{const n=Object.getOwnPropertyDescriptor(J.prototype,e);Object.defineProperty(t.prototype,e,n)})}dispose(){return super.dispose(),this._events=void 0,this}}class K extends J{constructor(){super(...arguments),this._isOffline=!1}}class tt extends K{constructor(){super(),this.name="Context",this._constants=new Map,this._timeouts=new Z,this._timeoutIds=0,this._initialized=!1,this._isOffline=!1,this._workletModules=new Map;const t=F(tt.getDefaults(),arguments,["context"]);t.context?this._context=t.context:(this._context=function(t){return new s.AudioContext(t)}({latencyHint:t.latencyHint}),this._context._nativeAudioContext&&this._context._nativeAudioContext.createScriptProcessor&&(this._context.createScriptProcessor=this._context._nativeAudioContext.createScriptProcessor)),this._ticker=new C(this.emit.bind(this,"tick"),t.clockSource,t.updateInterval),this.on("tick",this._timeoutLoop.bind(this)),this._context.onstatechange=()=>{this.emit("statechange",this.state)},this._setLatencyHint(t.latencyHint),this.lookAhead=t.lookAhead}get isOffline(){return this._isOffline}static getDefaults(){return{clockSource:"worker",latencyHint:"interactive",lookAhead:.1,updateInterval:.05}}initialize(){var t;return this._initialized||(t=this,X.forEach(e=>{e(t)}),this._initialized=!0),this}createAnalyser(){return this._context.createAnalyser()}createOscillator(){return this._context.createOscillator()}createBufferSource(){return this._context.createBufferSource()}createBiquadFilter(){return this._context.createBiquadFilter()}createBuffer(t,e,n){return this._context.createBuffer(t,e,n)}createChannelMerger(t){return this._context.createChannelMerger(t)}createChannelSplitter(t){return this._context.createChannelSplitter(t)}createConstantSource(){return this._context.createConstantSource()}createConvolver(){return this._context.createConvolver()}createDelay(t){return this._context.createDelay(t)}createDynamicsCompressor(){return this._context.createDynamicsCompressor()}createGain(){return this._context.createGain()}createIIRFilter(t,e){if(void 0===this._context.createIIRFilter)throw Error("createIIRFilter dose not support in your browser");return this._context.createIIRFilter(t,e)}createPanner(){return this._context.createPanner()}createPeriodicWave(t,e,n){return this._context.createPeriodicWave(t,e,n)}createStereoPanner(){return this._context.createStereoPanner()}createWaveShaper(){return this._context.createWaveShaper()}createScriptProcessor(){return void 0!==this._context._nativeAudioContext?this._context._nativeAudioContext.createScriptProcessor():this._context.createScriptProcessor()}createMediaStreamSource(t){o(M(this._context),"Not available if OfflineAudioContext");return this._context.createMediaStreamSource(t)}createMediaElementSource(t){o(M(this._context),"Not available if OfflineAudioContext");return this._context.createMediaElementSource(t)}createMediaStreamDestination(){o(M(this._context),"Not available if OfflineAudioContext");return this._context.createMediaStreamDestination()}decodeAudioData(t){return this._context.decodeAudioData(t)}get currentTime(){return this._context.currentTime}get state(){return this._context.state}get sampleRate(){return this._context.sampleRate}get listener(){return this.initialize(),this._listener}set listener(t){o(!this._initialized,"The listener cannot be set after initialization."),this._listener=t}get transport(){return this.initialize(),this._transport}set transport(t){o(!this._initialized,"The transport cannot be set after initialization."),this._transport=t}get draw(){return this.initialize(),this._draw}set draw(t){o(!this._initialized,"Draw cannot be set after initialization."),this._draw=t}get destination(){return this.initialize(),this._destination}set destination(t){o(!this._initialized,"The destination cannot be set after initialization."),this._destination=t}createAudioWorkletNode(t,e){return function(t,e,n){let i;if(o(d(s.AudioWorkletNode),"This node only works in a secure context (https or localhost)"),T)try{i=new s.AudioWorkletNode(t,e,n)}catch(r){T=!1,console.warn("create stdAudioWorkletNode failed",r),console.warn("will use native AudioWorkletNode"),i=new AudioWorkletNode(t,e,n)}else i=new AudioWorkletNode(t,e,n);return i}
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */(this.rawContext,t,e)}addAudioWorkletModule(t,e){return D(this,void 0,void 0,(function*(){o(d(this.rawContext.audioWorklet),"AudioWorkletNode is only available in a secure context (https or localhost)"),this._workletModules.has(e)||this._workletModules.set(e,this.rawContext.audioWorklet.addModule(t)),yield this._workletModules.get(e)}))}workletsAreReady(){return D(this,void 0,void 0,(function*(){const t=[];this._workletModules.forEach(e=>t.push(e)),yield Promise.all(t)}))}get updateInterval(){return this._ticker.updateInterval}set updateInterval(t){this._ticker.updateInterval=t}get clockSource(){return this._ticker.type}set clockSource(t){this._ticker.type=t}get latencyHint(){return this._latencyHint}_setLatencyHint(t){let e=0;if(this._latencyHint=t,b(t))switch(t){case"interactive":e=.1;break;case"playback":e=.5;break;case"balanced":e=.25}this.lookAhead=e,this.updateInterval=e/2}get rawContext(){return this._context}now(){return this._context.currentTime+this.lookAhead}immediate(){return this._context.currentTime}resume(){return"suspended"===this._context.state&&M(this._context)?this._context.resume():Promise.resolve()}close(){return D(this,void 0,void 0,(function*(){var t;M(this._context)&&(yield this._context.close()),this._initialized&&(t=this,H.forEach(e=>e(t)))}))}getConstant(t){if(this._constants.has(t))return this._constants.get(t);{const e=this._context.createBuffer(1,128,this._context.sampleRate),n=e.getChannelData(0);for(let e=0;e<n.length;e++)n[e]=t;const i=this._context.createBufferSource();return i.channelCount=1,i.channelCountMode="explicit",i.buffer=e,i.loop=!0,i.start(0),this._constants.set(t,i),i}}dispose(){return super.dispose(),this._ticker.dispose(),this._timeouts.dispose(),Object.keys(this._constants).map(t=>this._constants[t].disconnect()),this}_timeoutLoop(){const t=this.now();let e=this._timeouts.peek();for(;this._timeouts.length&&e&&e.time<=t;)e.callback(),this._timeouts.shift(),e=this._timeouts.peek()}setTimeout(t,e){this._timeoutIds++;const n=this.now();return this._timeouts.add({callback:t,id:this._timeoutIds,time:n+e}),this._timeoutIds}clearTimeout(t){return this._timeouts.forEach(e=>{e.id===t&&this._timeouts.remove(e)}),this}clearInterval(t){return this.clearTimeout(t)}setInterval(t,e){const n=++this._timeoutIds,i=()=>{const r=this.now();this._timeouts.add({callback:()=>{t(),i()},id:n,time:r+e})};return i(),n}}function et(t,e){y(e)?e.forEach(e=>et(t,e)):Object.defineProperty(t,e,{enumerable:!0,writable:!1})}function nt(t,e){y(e)?e.forEach(e=>nt(t,e)):Object.defineProperty(t,e,{writable:!0})}const it=()=>{};class rt extends z{constructor(){super(),this.name="ToneAudioBuffer",this.onload=it;const t=F(rt.getDefaults(),arguments,["url","onload","onerror"]);this.reverse=t.reverse,this.onload=t.onload,t.url&&P(t.url)||t.url instanceof rt?this.set(t.url):b(t.url)&&this.load(t.url).catch(t.onerror)}static getDefaults(){return{onerror:it,onload:it,reverse:!1}}get sampleRate(){return this._buffer?this._buffer.sampleRate:ut().sampleRate}set(t){return t instanceof rt?t.loaded?this._buffer=t.get():t.onload=()=>{this.set(t),this.onload(this)}:this._buffer=t,this._reversed&&this._reverse(),this}get(){return this._buffer}load(t){return D(this,void 0,void 0,(function*(){const e=rt.load(t).then(t=>{this.set(t),this.onload(this)});rt.downloads.push(e);try{yield e}finally{const t=rt.downloads.indexOf(e);rt.downloads.splice(t,1)}return this}))}dispose(){return super.dispose(),this._buffer=void 0,this}fromArray(t){const e=y(t)&&t[0].length>0,n=e?t.length:1,i=e?t[0].length:t.length,r=ut(),s=r.createBuffer(n,i,r.sampleRate),o=e||1!==n?t:[t];for(let t=0;t<n;t++)s.copyToChannel(o[t],t);return this._buffer=s,this}toMono(t){if(_(t))this.fromArray(this.toArray(t));else{let t=new Float32Array(this.length);const e=this.numberOfChannels;for(let n=0;n<e;n++){const e=this.toArray(n);for(let n=0;n<e.length;n++)t[n]+=e[n]}t=t.map(t=>t/e),this.fromArray(t)}return this}toArray(t){if(_(t))return this.getChannelData(t);if(1===this.numberOfChannels)return this.toArray(0);{const t=[];for(let e=0;e<this.numberOfChannels;e++)t[e]=this.getChannelData(e);return t}}getChannelData(t){return this._buffer?this._buffer.getChannelData(t):new Float32Array(0)}slice(t,e=this.duration){const n=Math.floor(t*this.sampleRate),i=Math.floor(e*this.sampleRate);o(n<i,"The start time must be less than the end time");const r=i-n,s=ut().createBuffer(this.numberOfChannels,r,this.sampleRate);for(let t=0;t<this.numberOfChannels;t++)s.copyToChannel(this.getChannelData(t).subarray(n,i),t);return new rt(s)}_reverse(){if(this.loaded)for(let t=0;t<this.numberOfChannels;t++)this.getChannelData(t).reverse();return this}get loaded(){return this.length>0}get duration(){return this._buffer?this._buffer.duration:0}get length(){return this._buffer?this._buffer.length:0}get numberOfChannels(){return this._buffer?this._buffer.numberOfChannels:0}get reverse(){return this._reversed}set reverse(t){this._reversed!==t&&(this._reversed=t,this._reverse())}static fromArray(t){return(new rt).fromArray(t)}static fromUrl(t){return D(this,void 0,void 0,(function*(){const e=new rt;return yield e.load(t)}))}static load(t){return D(this,void 0,void 0,(function*(){const e=t.match(/\[([^\]\[]+\|.+)\]$/);if(e){const n=e[1].split("|");let i=n[0];for(const t of n)if(rt.supportsType(t)){i=t;break}t=t.replace(e[0],i)}const n=""===rt.baseUrl||rt.baseUrl.endsWith("/")?rt.baseUrl:rt.baseUrl+"/",i=yield fetch(n+t);if(!i.ok)throw new Error("could not load url: "+t);const r=yield i.arrayBuffer();return yield ut().decodeAudioData(r)}))}static supportsType(t){const e=t.split("."),n=e[e.length-1];return""!==document.createElement("audio").canPlayType("audio/"+n)}static loaded(){return D(this,void 0,void 0,(function*(){for(yield Promise.resolve();rt.downloads.length;)yield rt.downloads[0]}))}}rt.baseUrl="",rt.downloads=[];class st extends tt{constructor(){super({clockSource:"offline",context:j(arguments[0])?arguments[0]:O(arguments[0],arguments[1]*arguments[2],arguments[2]),lookAhead:0,updateInterval:j(arguments[0])?128/arguments[0].sampleRate:128/arguments[2]}),this.name="OfflineContext",this._currentTime=0,this._isOffline=!0,this._isOffline=!0,this._duration=j(arguments[0])?arguments[0].length/arguments[0].sampleRate:arguments[1]}get isOffline(){return this._isOffline}now(){return this._currentTime}get currentTime(){return this._currentTime}_renderClock(t){return D(this,void 0,void 0,(function*(){let e=0;for(;this._duration-this._currentTime>=0;){this.emit("tick"),this._currentTime+=128/this.sampleRate,e++;const n=Math.floor(this.sampleRate/128);t&&e%n==0&&(yield new Promise(t=>setTimeout(t,1)))}}))}render(t=!0){return D(this,void 0,void 0,(function*(){yield this.workletsAreReady(),yield this._renderClock(t);const e=yield this._context.startRendering();return new rt(e)}))}close(){return Promise.resolve()}}const ot=new class extends K{constructor(){super(...arguments),this.lookAhead=0,this.latencyHint=0,this.isOffline=!1}createAnalyser(){return{}}createOscillator(){return{}}createBufferSource(){return{}}createBiquadFilter(){return{}}createBuffer(t,e,n){return{}}createChannelMerger(t){return{}}createChannelSplitter(t){return{}}createConstantSource(){return{}}createConvolver(){return{}}createDelay(t){return{}}createDynamicsCompressor(){return{}}createGain(){return{}}createIIRFilter(t,e){return{}}createPanner(){return{}}createPeriodicWave(t,e,n){return{}}createStereoPanner(){return{}}createWaveShaper(){return{}}createScriptProcessor(){return{}}createMediaStreamSource(t){return{}}createMediaElementSource(t){return{}}createMediaStreamDestination(){return{}}decodeAudioData(t){return Promise.resolve({})}createAudioWorkletNode(t,e){return{}}get rawContext(){return{}}addAudioWorkletModule(t,e){return D(this,void 0,void 0,(function*(){return Promise.resolve()}))}resume(){return Promise.resolve()}setTimeout(t,e){return 0}clearTimeout(t){return this}setInterval(t,e){return 0}clearInterval(t){return this}getConstant(t){return{}}get currentTime(){return 0}get state(){return{}}get sampleRate(){return 0}get listener(){return{}}get transport(){return{}}get draw(){return{}}set draw(t){}get destination(){return{}}set destination(t){}now(){return 0}immediate(){return 0}};let at=ot;function ut(){return at===ot&&S&&ct(new tt),at}function ct(t){at=M(t)?new tt(t):j(t)?new st(t):t}function lt(){return at.resume()}function ht(t){return Math.pow(10,t/20)}function ft(t){return Math.log(t)/Math.LN10*20}function pt(t){return Math.pow(2,t/12)}let dt=440;function mt(t){return Math.round(_t(t))}function _t(t){return 69+12*Math.log2(t/dt)}function gt(t){return dt*Math.pow(2,(t-69)/12)}class vt extends z{constructor(t,e,n){super(),this.defaultUnits="s",this._val=e,this._units=n,this.context=t,this._expressions=this._getExpressions()}_getExpressions(){return{hz:{method:t=>this._frequencyToUnits(parseFloat(t)),regexp:/^(\d+(?:\.\d+)?)hz$/i},i:{method:t=>this._ticksToUnits(parseInt(t,10)),regexp:/^(\d+)i$/i},m:{method:t=>this._beatsToUnits(parseInt(t,10)*this._getTimeSignature()),regexp:/^(\d+)m$/i},n:{method:(t,e)=>{const n=parseInt(t,10),i="."===e?1.5:1;return 1===n?this._beatsToUnits(this._getTimeSignature())*i:this._beatsToUnits(4/n)*i},regexp:/^(\d+)n(\.?)$/i},number:{method:t=>this._expressions[this.defaultUnits].method.call(this,t),regexp:/^(\d+(?:\.\d+)?)$/},s:{method:t=>this._secondsToUnits(parseFloat(t)),regexp:/^(\d+(?:\.\d+)?)s$/},samples:{method:t=>parseInt(t,10)/this.context.sampleRate,regexp:/^(\d+)samples$/},t:{method:t=>{const e=parseInt(t,10);return this._beatsToUnits(8/(3*Math.floor(e)))},regexp:/^(\d+)t$/i},tr:{method:(t,e,n)=>{let i=0;return t&&"0"!==t&&(i+=this._beatsToUnits(this._getTimeSignature()*parseFloat(t))),e&&"0"!==e&&(i+=this._beatsToUnits(parseFloat(e))),n&&"0"!==n&&(i+=this._beatsToUnits(parseFloat(n)/4)),i},regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?$/}}}valueOf(){if(this._val instanceof vt&&this.fromType(this._val),p(this._val))return this._noArg();if(b(this._val)&&p(this._units)){for(const t in this._expressions)if(this._expressions[t].regexp.test(this._val.trim())){this._units=t;break}}else if(g(this._val)){let t=0;for(const e in this._val)if(d(this._val[e])){const n=this._val[e];t+=new this.constructor(this.context,e).valueOf()*n}return t}if(d(this._units)){const t=this._expressions[this._units],e=this._val.toString().trim().match(t.regexp);return e?t.method.apply(this,e.slice(1)):t.method.call(this,this._val)}return b(this._val)?parseFloat(this._val):this._val}_frequencyToUnits(t){return 1/t}_beatsToUnits(t){return 60/this._getBpm()*t}_secondsToUnits(t){return t}_ticksToUnits(t){return t*this._beatsToUnits(1)/this._getPPQ()}_noArg(){return this._now()}_getBpm(){return this.context.transport.bpm.value}_getTimeSignature(){return this.context.transport.timeSignature}_getPPQ(){return this.context.transport.PPQ}fromType(t){switch(this._units=void 0,this.defaultUnits){case"s":this._val=t.toSeconds();break;case"i":this._val=t.toTicks();break;case"hz":this._val=t.toFrequency();break;case"midi":this._val=t.toMidi()}return this}toFrequency(){return 1/this.toSeconds()}toSamples(){return this.toSeconds()*this.context.sampleRate}toMilliseconds(){return 1e3*this.toSeconds()}}class yt extends vt{constructor(){super(...arguments),this.name="TimeClass"}_getExpressions(){return Object.assign(super._getExpressions(),{now:{method:t=>this._now()+new this.constructor(this.context,t).valueOf(),regexp:/^\+(.+)/},quantize:{method:t=>{const e=new yt(this.context,t).valueOf();return this._secondsToUnits(this.context.transport.nextSubdivision(e))},regexp:/^@(.+)/}})}quantize(t,e=1){const n=new this.constructor(this.context,t).valueOf(),i=this.valueOf();return i+(Math.round(i/n)*n-i)*e}toNotation(){const t=this.toSeconds(),e=["1m"];for(let t=1;t<9;t++){const n=Math.pow(2,t);e.push(n+"n."),e.push(n+"n"),e.push(n+"t")}e.push("0");let n=e[0],i=new yt(this.context,e[0]).toSeconds();return e.forEach(e=>{const r=new yt(this.context,e).toSeconds();Math.abs(r-t)<Math.abs(i-t)&&(n=e,i=r)}),n}toBarsBeatsSixteenths(){const t=this._beatsToUnits(1);let e=this.valueOf()/t;e=parseFloat(e.toFixed(4));const n=Math.floor(e/this._getTimeSignature());let i=e%1*4;e=Math.floor(e)%this._getTimeSignature();const r=i.toString();r.length>3&&(i=parseFloat(parseFloat(r).toFixed(3)));return[n,e,i].join(":")}toTicks(){const t=this._beatsToUnits(1),e=this.valueOf()/t;return Math.round(e*this._getPPQ())}toSeconds(){return this.valueOf()}toMidi(){return mt(this.toFrequency())}_now(){return this.context.now()}}function bt(t,e){return new yt(ut(),t,e)}class xt extends yt{constructor(){super(...arguments),this.name="Frequency",this.defaultUnits="hz"}static get A4(){return dt}static set A4(t){!function(t){dt=t}(t)}_getExpressions(){return Object.assign({},super._getExpressions(),{midi:{regexp:/^(\d+(?:\.\d+)?midi)/,method(t){return"midi"===this.defaultUnits?t:xt.mtof(t)}},note:{regexp:/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,method(t,e){const n=wt[t.toLowerCase()]+12*(parseInt(e,10)+1);return"midi"===this.defaultUnits?n:xt.mtof(n)}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method(t,e,n){let i=1;return t&&"0"!==t&&(i*=this._beatsToUnits(this._getTimeSignature()*parseFloat(t))),e&&"0"!==e&&(i*=this._beatsToUnits(parseFloat(e))),n&&"0"!==n&&(i*=this._beatsToUnits(parseFloat(n)/4)),i}}})}transpose(t){return new xt(this.context,this.valueOf()*pt(t))}harmonize(t){return t.map(t=>this.transpose(t))}toMidi(){return mt(this.valueOf())}toNote(){const t=this.toFrequency(),e=Math.log2(t/xt.A4);let n=Math.round(12*e)+57;const i=Math.floor(n/12);i<0&&(n+=-12*i);return Ot[n%12]+i.toString()}toSeconds(){return 1/super.toSeconds()}toTicks(){const t=this._beatsToUnits(1),e=this.valueOf()/t;return Math.floor(e*this._getPPQ())}_noArg(){return 0}_frequencyToUnits(t){return t}_ticksToUnits(t){return 1/(60*t/(this._getBpm()*this._getPPQ()))}_beatsToUnits(t){return 1/super._beatsToUnits(t)}_secondsToUnits(t){return 1/t}static mtof(t){return gt(t)}static ftom(t){return mt(t)}}const wt={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13},Ot=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];function kt(t,e){return new xt(ut(),t,e)}class St extends yt{constructor(){super(...arguments),this.name="TransportTime"}_now(){return this.context.transport.seconds}}function Tt(t,e){return new St(ut(),t,e)}class At extends z{constructor(){super();const t=F(At.getDefaults(),arguments,["context"]);this.defaultContext?this.context=this.defaultContext:this.context=t.context}static getDefaults(){return{context:ut()}}now(){return this.context.currentTime+this.context.lookAhead}immediate(){return this.context.currentTime}get sampleTime(){return 1/this.context.sampleRate}get blockTime(){return 128/this.context.sampleRate}toSeconds(t){return new yt(this.context,t).toSeconds()}toFrequency(t){return new xt(this.context,t).toFrequency()}toTicks(t){return new St(this.context,t).toTicks()}_getPartialProperties(t){const e=this.get();return Object.keys(e).forEach(n=>{p(t[n])&&delete e[n]}),e}get(){const t=this.constructor.getDefaults();return Object.keys(t).forEach(e=>{if(Reflect.has(this,e)){const n=this[e];d(n)&&d(n.value)&&d(n.setValueAtTime)?t[e]=n.value:n instanceof At?t[e]=n._getPartialProperties(t[e]):y(n)||_(n)||b(n)||v(n)?t[e]=n:delete t[e]}}),t}set(t){return Object.keys(t).forEach(e=>{Reflect.has(this,e)&&d(this[e])&&(this[e]&&d(this[e].value)&&d(this[e].setValueAtTime)?this[e].value!==t[e]&&(this[e].value=t[e]):this[e]instanceof At?this[e].set(t[e]):this[e]=t[e])}),this}}class Dt extends Z{constructor(t="stopped"){super(),this.name="StateTimeline",this._initial=t,this.setStateAtTime(this._initial,0)}getValueAtTime(t){const e=this.get(t);return null!==e?e.state:this._initial}setStateAtTime(t,e,n){return a(e,0),this.add(Object.assign({},n,{state:t,time:e})),this}getLastState(t,e){for(let n=this._search(e);n>=0;n--){const e=this._timeline[n];if(e.state===t)return e}}getNextState(t,e){const n=this._search(e);if(-1!==n)for(let e=n;e<this._timeline.length;e++){const n=this._timeline[e];if(n.state===t)return n}}}class Ct extends At{constructor(){super(F(Ct.getDefaults(),arguments,["param","units","convert"])),this.name="Param",this.overridden=!1,this._minOutput=1e-7;const t=F(Ct.getDefaults(),arguments,["param","units","convert"]);for(o(d(t.param)&&(R(t.param)||t.param instanceof Ct),"param must be an AudioParam");!R(t.param);)t.param=t.param._param;this._swappable=!!d(t.swappable)&&t.swappable,this._swappable?(this.input=this.context.createGain(),this._param=t.param,this.input.connect(this._param)):this._param=this.input=t.param,this._events=new Z(1e3),this._initialValue=this._param.defaultValue,this.units=t.units,this.convert=t.convert,this._minValue=t.minValue,this._maxValue=t.maxValue,d(t.value)&&t.value!==this._toType(this._initialValue)&&this.setValueAtTime(t.value,0),this._param.getValueAtTime=t=>this.getValueAtTime(t)}static getDefaults(){return Object.assign(At.getDefaults(),{convert:!0,units:"number"})}get value(){const t=this.now();return this.getValueAtTime(t)}set value(t){this.cancelScheduledValues(this.now()),this.setValueAtTime(t,this.now())}get minValue(){return d(this._minValue)?this._minValue:"time"===this.units||"frequency"===this.units||"normalRange"===this.units||"positive"===this.units||"transportTime"===this.units||"ticks"===this.units||"bpm"===this.units||"hertz"===this.units||"samples"===this.units?0:"audioRange"===this.units?-1:"decibels"===this.units?-1/0:this._param.minValue}get maxValue(){return d(this._maxValue)?this._maxValue:"normalRange"===this.units||"audioRange"===this.units?1:this._param.maxValue}_is(t,e){return this.units===e}_assertRange(t){return"undefined"!=typeof window&&void 0!==window.webkitAudioContext&&"gain"===this._param.name||d(this.maxValue)&&d(this.minValue)&&a(t,this._fromType(this.minValue),this._fromType(this.maxValue)),t}_fromType(t){return this.convert&&!this.overridden?this._is(t,"time")?this.toSeconds(t):this._is(t,"decibels")?ht(t):this._is(t,"frequency")?this.toFrequency(t):t:this.overridden?0:t}_toType(t){return this.convert&&"decibels"===this.units?ft(t):t}setValueAtTime(t,e){const n=this.toSeconds(e),i=this._fromType(t);return o(isFinite(i)&&isFinite(n),`Invalid argument(s) to setValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._assertRange(i),this.log(this.units,"setValueAtTime",t,n),this._events.add({time:n,type:"setValueAtTime",value:i}),this._param.setValueAtTime(i,n),this}getValueAtTime(t){const e=Math.max(this.toSeconds(t),0),n=this._events.getAfter(e),i=this._events.get(e);let r=this._initialValue;if(null===i)r=this._initialValue;else if("setTargetAtTime"!==i.type||null!==n&&"setValueAtTime"!==n.type)if(null===n)r=i.value;else if("linearRampToValueAtTime"===n.type||"exponentialRampToValueAtTime"===n.type){let t=i.value;if("setTargetAtTime"===i.type){const e=this._events.getBefore(i.time);t=null===e?this._initialValue:e.value}r="linearRampToValueAtTime"===n.type?this._linearInterpolate(i.time,t,n.time,n.value,e):this._exponentialInterpolate(i.time,t,n.time,n.value,e)}else r=i.value;else{const t=this._events.getBefore(i.time);let n;n=null===t?this._initialValue:t.value,"setTargetAtTime"===i.type&&(r=this._exponentialApproach(i.time,n,i.value,i.constant,e))}return this._toType(r)}setRampPoint(t){t=this.toSeconds(t);let e=this.getValueAtTime(t);return this.cancelAndHoldAtTime(t),0===this._fromType(e)&&(e=this._toType(this._minOutput)),this.setValueAtTime(e,t),this}linearRampToValueAtTime(t,e){const n=this._fromType(t),i=this.toSeconds(e);return o(isFinite(n)&&isFinite(i),`Invalid argument(s) to linearRampToValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._assertRange(n),this._events.add({time:i,type:"linearRampToValueAtTime",value:n}),this.log(this.units,"linearRampToValueAtTime",t,i),this._param.linearRampToValueAtTime(n,i),this}exponentialRampToValueAtTime(t,e){let n=this._fromType(t);n=Math.max(this._minOutput,n),this._assertRange(n);const i=this.toSeconds(e);return o(isFinite(n)&&isFinite(i),`Invalid argument(s) to exponentialRampToValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._events.add({time:i,type:"exponentialRampToValueAtTime",value:n}),this.log(this.units,"exponentialRampToValueAtTime",t,i),this._param.exponentialRampToValueAtTime(n,i),this}exponentialRampTo(t,e,n){return n=this.toSeconds(n),this.setRampPoint(n),this.exponentialRampToValueAtTime(t,n+this.toSeconds(e)),this}linearRampTo(t,e,n){return n=this.toSeconds(n),this.setRampPoint(n),this.linearRampToValueAtTime(t,n+this.toSeconds(e)),this}targetRampTo(t,e,n){return n=this.toSeconds(n),this.setRampPoint(n),this.exponentialApproachValueAtTime(t,n,e),this}exponentialApproachValueAtTime(t,e,n){e=this.toSeconds(e),n=this.toSeconds(n);const i=Math.log(n+1)/Math.log(200);return this.setTargetAtTime(t,e,i),this.cancelAndHoldAtTime(e+.9*n),this.linearRampToValueAtTime(t,e+n),this}setTargetAtTime(t,e,n){const i=this._fromType(t);o(isFinite(n)&&n>0,"timeConstant must be a number greater than 0");const r=this.toSeconds(e);return this._assertRange(i),o(isFinite(i)&&isFinite(r),`Invalid argument(s) to setTargetAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._events.add({constant:n,time:r,type:"setTargetAtTime",value:i}),this.log(this.units,"setTargetAtTime",t,r,n),this._param.setTargetAtTime(i,r,n),this}setValueCurveAtTime(t,e,n,i=1){n=this.toSeconds(n),e=this.toSeconds(e);const r=this._fromType(t[0])*i;this.setValueAtTime(this._toType(r),e);const s=n/(t.length-1);for(let n=1;n<t.length;n++){const r=this._fromType(t[n])*i;this.linearRampToValueAtTime(this._toType(r),e+n*s)}return this}cancelScheduledValues(t){const e=this.toSeconds(t);return o(isFinite(e),"Invalid argument to cancelScheduledValues: "+JSON.stringify(t)),this._events.cancel(e),this._param.cancelScheduledValues(e),this.log(this.units,"cancelScheduledValues",e),this}cancelAndHoldAtTime(t){const e=this.toSeconds(t),n=this._fromType(this.getValueAtTime(e));o(isFinite(e),"Invalid argument to cancelAndHoldAtTime: "+JSON.stringify(t)),this.log(this.units,"cancelAndHoldAtTime",e,"value="+n);const i=this._events.get(e),r=this._events.getAfter(e);return i&&U(i.time,e)?r?(this._param.cancelScheduledValues(r.time),this._events.cancel(r.time)):(this._param.cancelAndHoldAtTime(e),this._events.cancel(e+this.sampleTime)):r&&(this._param.cancelScheduledValues(r.time),this._events.cancel(r.time),"linearRampToValueAtTime"===r.type?this.linearRampToValueAtTime(this._toType(n),e):"exponentialRampToValueAtTime"===r.type&&this.exponentialRampToValueAtTime(this._toType(n),e)),this._events.add({time:e,type:"setValueAtTime",value:n}),this._param.setValueAtTime(n,e),this}rampTo(t,e=.1,n){return"frequency"===this.units||"bpm"===this.units||"decibels"===this.units?this.exponentialRampTo(t,e,n):this.linearRampTo(t,e,n),this}apply(t){const e=this.context.currentTime;t.setValueAtTime(this.getValueAtTime(e),e);const n=this._events.get(e);if(n&&"setTargetAtTime"===n.type){const i=this._events.getAfter(n.time),r=i?i.time:e+2,s=(r-e)/10;for(let n=e;n<r;n+=s)t.linearRampToValueAtTime(this.getValueAtTime(n),n)}return this._events.forEachAfter(this.context.currentTime,e=>{"cancelScheduledValues"===e.type?t.cancelScheduledValues(e.time):"setTargetAtTime"===e.type?t.setTargetAtTime(e.value,e.time,e.constant):t[e.type](e.value,e.time)}),this}setParam(t){o(this._swappable,"The Param must be assigned as 'swappable' in the constructor");const e=this.input;return e.disconnect(this._param),this.apply(t),this._param=t,e.connect(this._param),this}dispose(){return super.dispose(),this._events.dispose(),this}get defaultValue(){return this._toType(this._param.defaultValue)}_exponentialApproach(t,e,n,i,r){return n+(e-n)*Math.exp(-(r-t)/i)}_linearInterpolate(t,e,n,i,r){return e+(r-t)/(n-t)*(i-e)}_exponentialInterpolate(t,e,n,i,r){return e*Math.pow(i/e,(r-t)/(n-t))}}class Rt extends At{constructor(){super(...arguments),this.name="ToneAudioNode",this._internalChannels=[]}get numberOfInputs(){return d(this.input)?R(this.input)||this.input instanceof Ct?1:this.input.numberOfInputs:0}get numberOfOutputs(){return d(this.output)?this.output.numberOfOutputs:0}_isAudioNode(t){return d(t)&&(t instanceof Rt||E(t))}_getInternalNodes(){const t=this._internalChannels.slice(0);return this._isAudioNode(this.input)&&t.push(this.input),this._isAudioNode(this.output)&&this.input!==this.output&&t.push(this.output),t}_setChannelProperties(t){this._getInternalNodes().forEach(e=>{e.channelCount=t.channelCount,e.channelCountMode=t.channelCountMode,e.channelInterpretation=t.channelInterpretation})}_getChannelProperties(){const t=this._getInternalNodes();o(t.length>0,"ToneAudioNode does not have any internal nodes");const e=t[0];return{channelCount:e.channelCount,channelCountMode:e.channelCountMode,channelInterpretation:e.channelInterpretation}}get channelCount(){return this._getChannelProperties().channelCount}set channelCount(t){const e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelCount:t}))}get channelCountMode(){return this._getChannelProperties().channelCountMode}set channelCountMode(t){const e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelCountMode:t}))}get channelInterpretation(){return this._getChannelProperties().channelInterpretation}set channelInterpretation(t){const e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelInterpretation:t}))}connect(t,e=0,n=0){return jt(this,t,e,n),this}toDestination(){return this.connect(this.context.destination),this}toMaster(){return f("toMaster() has been renamed toDestination()"),this.toDestination()}disconnect(t,e=0,n=0){return Mt(this,t,e,n),this}chain(...t){return Et(this,...t),this}fan(...t){return t.forEach(t=>this.connect(t)),this}dispose(){return super.dispose(),d(this.input)&&(this.input instanceof Rt?this.input.dispose():E(this.input)&&this.input.disconnect()),d(this.output)&&(this.output instanceof Rt?this.output.dispose():E(this.output)&&this.output.disconnect()),this._internalChannels=[],this}}function Et(...t){const e=t.shift();t.reduce((t,e)=>(t instanceof Rt?t.connect(e):E(t)&&jt(t,e),e),e)}function jt(t,e,n=0,i=0){for(o(d(t),"Cannot connect from undefined node"),o(d(e),"Cannot connect to undefined node"),(e instanceof Rt||E(e))&&o(e.numberOfInputs>0,"Cannot connect to node with no inputs"),o(t.numberOfOutputs>0,"Cannot connect from node with no outputs");e instanceof Rt||e instanceof Ct;)d(e.input)&&(e=e.input);for(;t instanceof Rt;)d(t.output)&&(t=t.output);R(e)?t.connect(e,n):t.connect(e,n,i)}function Mt(t,e,n=0,i=0){if(d(e))for(;e instanceof Rt;)e=e.input;for(;!E(t);)d(t.output)&&(t=t.output);R(e)?t.disconnect(e,n):E(e)?t.disconnect(e,n,i):t.disconnect()}class Pt extends Rt{constructor(){super(F(Pt.getDefaults(),arguments,["gain","units"])),this.name="Gain",this._gainNode=this.context.createGain(),this.input=this._gainNode,this.output=this._gainNode;const t=F(Pt.getDefaults(),arguments,["gain","units"]);this.gain=new Ct({context:this.context,convert:t.convert,param:this._gainNode.gain,units:t.units,value:t.gain,minValue:t.minValue,maxValue:t.maxValue}),et(this,"gain")}static getDefaults(){return Object.assign(Rt.getDefaults(),{convert:!0,gain:1,units:"gain"})}dispose(){return super.dispose(),this._gainNode.disconnect(),this.gain.dispose(),this}}class qt extends Rt{constructor(t){super(t),this.onended=it,this._startTime=-1,this._stopTime=-1,this._timeout=-1,this.output=new Pt({context:this.context,gain:0}),this._gainNode=this.output,this.getStateAtTime=function(t){const e=this.toSeconds(t);return-1!==this._startTime&&e>=this._startTime&&(-1===this._stopTime||e<=this._stopTime)?"started":"stopped"},this._fadeIn=t.fadeIn,this._fadeOut=t.fadeOut,this._curve=t.curve,this.onended=t.onended}static getDefaults(){return Object.assign(Rt.getDefaults(),{curve:"linear",fadeIn:0,fadeOut:0,onended:it})}_startGain(t,e=1){o(-1===this._startTime,"Source cannot be started more than once");const n=this.toSeconds(this._fadeIn);return this._startTime=t+n,this._startTime=Math.max(this._startTime,this.context.currentTime),n>0?(this._gainNode.gain.setValueAtTime(0,t),"linear"===this._curve?this._gainNode.gain.linearRampToValueAtTime(e,t+n):this._gainNode.gain.exponentialApproachValueAtTime(e,t,n)):this._gainNode.gain.setValueAtTime(e,t),this}stop(t){return this.log("stop",t),this._stopGain(this.toSeconds(t)),this}_stopGain(t){o(-1!==this._startTime,"'start' must be called before 'stop'"),this.cancelStop();const e=this.toSeconds(this._fadeOut);return this._stopTime=this.toSeconds(t)+e,this._stopTime=Math.max(this._stopTime,this.context.currentTime),e>0?"linear"===this._curve?this._gainNode.gain.linearRampTo(0,e,t):this._gainNode.gain.targetRampTo(0,e,t):(this._gainNode.gain.cancelAndHoldAtTime(t),this._gainNode.gain.setValueAtTime(0,t)),this.context.clearTimeout(this._timeout),this._timeout=this.context.setTimeout(()=>{const t="exponential"===this._curve?2*e:0;this._stopSource(this.now()+t),this._onended()},this._stopTime-this.context.currentTime),this}_onended(){if(this.onended!==it&&(this.onended(this),this.onended=it,!this.context.isOffline)){const t=()=>this.dispose();void 0!==window.requestIdleCallback?window.requestIdleCallback(t):setTimeout(t,1e3)}}get state(){return this.getStateAtTime(this.now())}cancelStop(){return this.log("cancelStop"),o(-1!==this._startTime,"Source is not started"),this._gainNode.gain.cancelScheduledValues(this._startTime+this.sampleTime),this.context.clearTimeout(this._timeout),this._stopTime=-1,this}dispose(){return super.dispose(),this._gainNode.disconnect(),this}}class It extends qt{constructor(){super(F(It.getDefaults(),arguments,["offset"])),this.name="ToneConstantSource";const t=F(It.getDefaults(),arguments,["offset"]);try{this._source=this.context.createConstantSource(),jt(this._source,this._gainNode),this.offset=new Ct({context:this.context,convert:t.convert,param:this._source.offset,units:t.units,value:t.offset,minValue:t.minValue,maxValue:t.maxValue})}catch(t){return void console.error("ToneConstantSource constructor:",t)}}static getDefaults(){return Object.assign(qt.getDefaults(),{convert:!0,offset:1,units:"number"})}start(t){const e=this.toSeconds(t);return this.log("start",e),this._startGain(e),this._source.start(e),this}_stopSource(t){try{this._source.stop(t)}catch(t){console.error("ToneConstantSource _stopSource error:",t)}}dispose(){if(super.dispose(),"started"===this.state)try{this.stop()}catch(t){console.error("ToneConstantSource dispose stop error:",t)}return this._source.disconnect(),this.offset.dispose(),this}}class Ft extends Rt{constructor(){super(F(Ft.getDefaults(),arguments,["value","units"])),this.name="Signal",this.override=!0;const t=F(Ft.getDefaults(),arguments,["value","units"]);this.output=this._constantSource=new It({context:this.context,convert:t.convert,offset:t.value,units:t.units,minValue:t.minValue,maxValue:t.maxValue}),this._constantSource.start(0),this.input=this._param=this._constantSource.offset}static getDefaults(){return Object.assign(Rt.getDefaults(),{convert:!0,units:"number",value:0})}connect(t,e=0,n=0){return Vt(this,t,e,n),this}dispose(){return super.dispose(),this._param.dispose(),this._constantSource.dispose(),this}setValueAtTime(t,e){return this._param.setValueAtTime(t,e),this}getValueAtTime(t){return this._param.getValueAtTime(t)}setRampPoint(t){return this._param.setRampPoint(t),this}linearRampToValueAtTime(t,e){return this._param.linearRampToValueAtTime(t,e),this}exponentialRampToValueAtTime(t,e){return this._param.exponentialRampToValueAtTime(t,e),this}exponentialRampTo(t,e,n){return this._param.exponentialRampTo(t,e,n),this}linearRampTo(t,e,n){return this._param.linearRampTo(t,e,n),this}targetRampTo(t,e,n){return this._param.targetRampTo(t,e,n),this}exponentialApproachValueAtTime(t,e,n){return this._param.exponentialApproachValueAtTime(t,e,n),this}setTargetAtTime(t,e,n){return this._param.setTargetAtTime(t,e,n),this}setValueCurveAtTime(t,e,n,i){return this._param.setValueCurveAtTime(t,e,n,i),this}cancelScheduledValues(t){return this._param.cancelScheduledValues(t),this}cancelAndHoldAtTime(t){return this._param.cancelAndHoldAtTime(t),this}rampTo(t,e,n){return this._param.rampTo(t,e,n),this}get value(){return this._param.value}set value(t){this._param.value=t}get convert(){return this._param.convert}set convert(t){this._param.convert=t}get units(){return this._param.units}get overridden(){return this._param.overridden}set overridden(t){this._param.overridden=t}get maxValue(){return this._param.maxValue}get minValue(){return this._param.minValue}apply(t){return this._param.apply(t),this}}function Vt(t,e,n,i){(e instanceof Ct||R(e)||e instanceof Ft&&e.override)&&(e.cancelScheduledValues(0),e.setValueAtTime(0,0),e instanceof Ft&&(e.overridden=!0)),jt(t,e,n,i)}class Nt extends Ct{constructor(){super(F(Nt.getDefaults(),arguments,["value"])),this.name="TickParam",this._events=new Z(1/0),this._multiplier=1;const t=F(Nt.getDefaults(),arguments,["value"]);this._multiplier=t.multiplier,this._events.cancel(0),this._events.add({ticks:0,time:0,type:"setValueAtTime",value:this._fromType(t.value)}),this.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(Ct.getDefaults(),{multiplier:1,units:"hertz",value:1})}setTargetAtTime(t,e,n){e=this.toSeconds(e),this.setRampPoint(e);const i=this._fromType(t),r=this._events.get(e),s=Math.round(Math.max(1/n,1));for(let t=0;t<=s;t++){const s=n*t+e,o=this._exponentialApproach(r.time,r.value,i,n,s);this.linearRampToValueAtTime(this._toType(o),s)}return this}setValueAtTime(t,e){const n=this.toSeconds(e);super.setValueAtTime(t,e);const i=this._events.get(n),r=this._events.previousEvent(i),s=this._getTicksUntilEvent(r,n);return i.ticks=Math.max(s,0),this}linearRampToValueAtTime(t,e){const n=this.toSeconds(e);super.linearRampToValueAtTime(t,e);const i=this._events.get(n),r=this._events.previousEvent(i),s=this._getTicksUntilEvent(r,n);return i.ticks=Math.max(s,0),this}exponentialRampToValueAtTime(t,e){e=this.toSeconds(e);const n=this._fromType(t),i=this._events.get(e),r=Math.round(Math.max(10*(e-i.time),1)),s=(e-i.time)/r;for(let t=0;t<=r;t++){const r=s*t+i.time,o=this._exponentialInterpolate(i.time,i.value,e,n,r);this.linearRampToValueAtTime(this._toType(o),r)}return this}_getTicksUntilEvent(t,e){if(null===t)t={ticks:0,time:0,type:"setValueAtTime",value:0};else if(p(t.ticks)){const e=this._events.previousEvent(t);t.ticks=this._getTicksUntilEvent(e,t.time)}const n=this._fromType(this.getValueAtTime(t.time));let i=this._fromType(this.getValueAtTime(e));const r=this._events.get(e);return r&&r.time===e&&"setValueAtTime"===r.type&&(i=this._fromType(this.getValueAtTime(e-this.sampleTime))),.5*(e-t.time)*(n+i)+t.ticks}getTicksAtTime(t){const e=this.toSeconds(t),n=this._events.get(e);return Math.max(this._getTicksUntilEvent(n,e),0)}getDurationOfTicks(t,e){const n=this.toSeconds(e),i=this.getTicksAtTime(e);return this.getTimeOfTick(i+t)-n}getTimeOfTick(t){const e=this._events.get(t,"ticks"),n=this._events.getAfter(t,"ticks");if(e&&e.ticks===t)return e.time;if(e&&n&&"linearRampToValueAtTime"===n.type&&e.value!==n.value){const i=this._fromType(this.getValueAtTime(e.time)),r=(this._fromType(this.getValueAtTime(n.time))-i)/(n.time-e.time),s=Math.sqrt(Math.pow(i,2)-2*r*(e.ticks-t)),o=(-i+s)/r,a=(-i-s)/r;return(o>0?o:a)+e.time}return e?0===e.value?1/0:e.time+(t-e.ticks)/e.value:t/this._initialValue}ticksToTime(t,e){return this.getDurationOfTicks(t,e)}timeToTicks(t,e){const n=this.toSeconds(e),i=this.toSeconds(t),r=this.getTicksAtTime(n);return this.getTicksAtTime(n+i)-r}_fromType(t){return"bpm"===this.units&&this.multiplier?1/(60/t/this.multiplier):super._fromType(t)}_toType(t){return"bpm"===this.units&&this.multiplier?t/this.multiplier*60:super._toType(t)}get multiplier(){return this._multiplier}set multiplier(t){const e=this.value;this._multiplier=t,this.cancelScheduledValues(0),this.setValueAtTime(e,0)}}class Lt extends Ft{constructor(){super(F(Lt.getDefaults(),arguments,["value"])),this.name="TickSignal";const t=F(Lt.getDefaults(),arguments,["value"]);this.input=this._param=new Nt({context:this.context,convert:t.convert,multiplier:t.multiplier,param:this._constantSource.offset,units:t.units,value:t.value})}static getDefaults(){return Object.assign(Ft.getDefaults(),{multiplier:1,units:"hertz",value:1})}ticksToTime(t,e){return this._param.ticksToTime(t,e)}timeToTicks(t,e){return this._param.timeToTicks(t,e)}getTimeOfTick(t){return this._param.getTimeOfTick(t)}getDurationOfTicks(t,e){return this._param.getDurationOfTicks(t,e)}getTicksAtTime(t){return this._param.getTicksAtTime(t)}get multiplier(){return this._param.multiplier}set multiplier(t){this._param.multiplier=t}dispose(){return super.dispose(),this._param.dispose(),this}}class zt extends At{constructor(){super(F(zt.getDefaults(),arguments,["frequency"])),this.name="TickSource",this._state=new Dt,this._tickOffset=new Z;const t=F(zt.getDefaults(),arguments,["frequency"]);this.frequency=new Lt({context:this.context,units:t.units,value:t.frequency}),et(this,"frequency"),this._state.setStateAtTime("stopped",0),this.setTicksAtTime(0,0)}static getDefaults(){return Object.assign({frequency:1,units:"hertz"},At.getDefaults())}get state(){return this.getStateAtTime(this.now())}start(t,e){const n=this.toSeconds(t);return"started"!==this._state.getValueAtTime(n)&&(this._state.setStateAtTime("started",n),d(e)&&this.setTicksAtTime(e,n)),this}stop(t){const e=this.toSeconds(t);if("stopped"===this._state.getValueAtTime(e)){const t=this._state.get(e);t&&t.time>0&&(this._tickOffset.cancel(t.time),this._state.cancel(t.time))}return this._state.cancel(e),this._state.setStateAtTime("stopped",e),this.setTicksAtTime(0,e),this}pause(t){const e=this.toSeconds(t);return"started"===this._state.getValueAtTime(e)&&this._state.setStateAtTime("paused",e),this}cancel(t){return t=this.toSeconds(t),this._state.cancel(t),this._tickOffset.cancel(t),this}getTicksAtTime(t){const e=this.toSeconds(t),n=this._state.getLastState("stopped",e),i={state:"paused",time:e};this._state.add(i);let r=n,s=0;return this._state.forEachBetween(n.time,e+this.sampleTime,t=>{let e=r.time;const n=this._tickOffset.get(t.time);n&&n.time>=r.time&&(s=n.ticks,e=n.time),"started"===r.state&&"started"!==t.state&&(s+=this.frequency.getTicksAtTime(t.time)-this.frequency.getTicksAtTime(e)),r=t}),this._state.remove(i),s}get ticks(){return this.getTicksAtTime(this.now())}set ticks(t){this.setTicksAtTime(t,this.now())}get seconds(){return this.getSecondsAtTime(this.now())}set seconds(t){const e=this.now(),n=this.frequency.timeToTicks(t,e);this.setTicksAtTime(n,e)}getSecondsAtTime(t){t=this.toSeconds(t);const e=this._state.getLastState("stopped",t),n={state:"paused",time:t};this._state.add(n);let i=e,r=0;return this._state.forEachBetween(e.time,t+this.sampleTime,t=>{let e=i.time;const n=this._tickOffset.get(t.time);n&&n.time>=i.time&&(r=n.seconds,e=n.time),"started"===i.state&&"started"!==t.state&&(r+=t.time-e),i=t}),this._state.remove(n),r}setTicksAtTime(t,e){return e=this.toSeconds(e),this._tickOffset.cancel(e),this._tickOffset.add({seconds:this.frequency.getDurationOfTicks(t,e),ticks:t,time:e}),this}getStateAtTime(t){return t=this.toSeconds(t),this._state.getValueAtTime(t)}getTimeOfTick(t,e=this.now()){const n=this._tickOffset.get(e),i=this._state.get(e),r=Math.max(n.time,i.time),s=this.frequency.getTicksAtTime(r)+t-n.ticks;return this.frequency.getTimeOfTick(s)}forEachTickBetween(t,e,n){let i=this._state.get(t);this._state.forEachBetween(t,e,e=>{i&&"started"===i.state&&"started"!==e.state&&this.forEachTickBetween(Math.max(i.time,t),e.time-this.sampleTime,n),i=e});let r=null;if(i&&"started"===i.state){const s=Math.max(i.time,t),o=this.frequency.getTicksAtTime(s),a=o-this.frequency.getTicksAtTime(i.time);let u=Math.ceil(a)-a;u=U(u,1)?0:u;let c=this.frequency.getTimeOfTick(o+u);for(;c<e;){try{n(c,Math.round(this.getTicksAtTime(c)))}catch(t){r=t;break}c+=this.frequency.getDurationOfTicks(1,c)}}if(r)throw r;return this}dispose(){return super.dispose(),this._state.dispose(),this._tickOffset.dispose(),this.frequency.dispose(),this}}class Bt extends At{constructor(){super(F(Bt.getDefaults(),arguments,["callback","frequency"])),this.name="Clock",this.callback=it,this._lastUpdate=0,this._state=new Dt("stopped"),this._boundLoop=this._loop.bind(this);const t=F(Bt.getDefaults(),arguments,["callback","frequency"]);this.callback=t.callback,this._tickSource=new zt({context:this.context,frequency:t.frequency,units:t.units}),this._lastUpdate=0,this.frequency=this._tickSource.frequency,et(this,"frequency"),this._state.setStateAtTime("stopped",0),this.context.on("tick",this._boundLoop)}static getDefaults(){return Object.assign(At.getDefaults(),{callback:it,frequency:1,units:"hertz"})}get state(){return this._state.getValueAtTime(this.now())}start(t,e){u(this.context);const n=this.toSeconds(t);return this.log("start",n),"started"!==this._state.getValueAtTime(n)&&(this._state.setStateAtTime("started",n),this._tickSource.start(n,e),n<this._lastUpdate&&this.emit("start",n,e)),this}stop(t){const e=this.toSeconds(t);return this.log("stop",e),this._state.cancel(e),this._state.setStateAtTime("stopped",e),this._tickSource.stop(e),e<this._lastUpdate&&this.emit("stop",e),this}pause(t){const e=this.toSeconds(t);return"started"===this._state.getValueAtTime(e)&&(this._state.setStateAtTime("paused",e),this._tickSource.pause(e),e<this._lastUpdate&&this.emit("pause",e)),this}get ticks(){return Math.ceil(this.getTicksAtTime(this.now()))}set ticks(t){this._tickSource.ticks=t}get seconds(){return this._tickSource.seconds}set seconds(t){this._tickSource.seconds=t}getSecondsAtTime(t){return this._tickSource.getSecondsAtTime(t)}setTicksAtTime(t,e){return this._tickSource.setTicksAtTime(t,e),this}getTimeOfTick(t,e=this.now()){return this._tickSource.getTimeOfTick(t,e)}getTicksAtTime(t){return this._tickSource.getTicksAtTime(t)}nextTickTime(t,e){const n=this.toSeconds(e),i=this.getTicksAtTime(n);return this._tickSource.getTimeOfTick(i+t,n)}_loop(){const t=this._lastUpdate,e=this.now();this._lastUpdate=e,this.log("loop",t,e),t!==e&&(this._state.forEachBetween(t,e,t=>{switch(t.state){case"started":const e=this._tickSource.getTicksAtTime(t.time);this.emit("start",t.time,e);break;case"stopped":0!==t.time&&this.emit("stop",t.time);break;case"paused":this.emit("pause",t.time)}}),this._tickSource.forEachTickBetween(t,e,(t,e)=>{this.callback(t,e)}))}getStateAtTime(t){const e=this.toSeconds(t);return this._state.getValueAtTime(e)}dispose(){return super.dispose(),this.context.off("tick",this._boundLoop),this._tickSource.dispose(),this._state.dispose(),this}}J.mixin(Bt);class Wt extends Rt{constructor(){super(F(Wt.getDefaults(),arguments,["delayTime","maxDelay"])),this.name="Delay";const t=F(Wt.getDefaults(),arguments,["delayTime","maxDelay"]),e=this.toSeconds(t.maxDelay);this._maxDelay=Math.max(e,this.toSeconds(t.delayTime)),this._delayNode=this.input=this.output=this.context.createDelay(e),this.delayTime=new Ct({context:this.context,param:this._delayNode.delayTime,units:"time",value:t.delayTime,minValue:0,maxValue:this.maxDelay}),et(this,"delayTime")}static getDefaults(){return Object.assign(Rt.getDefaults(),{delayTime:0,maxDelay:1})}get maxDelay(){return this._maxDelay}dispose(){return super.dispose(),this._delayNode.disconnect(),this.delayTime.dispose(),this}}function Gt(t,e,n=2,i=ut().sampleRate){return D(this,void 0,void 0,(function*(){const r=ut(),s=new st(n,e,i);ct(s),yield t(s);const o=s.render();ct(r);const a=yield o;return new rt(a)}))}class Ut extends z{constructor(){super(),this.name="ToneAudioBuffers",this._buffers=new Map,this._loadingCount=0;const t=F(Ut.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");this.baseUrl=t.baseUrl,Object.keys(t.urls).forEach(e=>{this._loadingCount++;const n=t.urls[e];this.add(e,n,this._bufferLoaded.bind(this,t.onload),t.onerror)})}static getDefaults(){return{baseUrl:"",onerror:it,onload:it,urls:{}}}has(t){return this._buffers.has(t.toString())}get(t){return o(this.has(t),"ToneAudioBuffers has no buffer named: "+t),this._buffers.get(t.toString())}_bufferLoaded(t){this._loadingCount--,0===this._loadingCount&&t&&t()}get loaded(){return Array.from(this._buffers).every(([t,e])=>e.loaded)}add(t,e,n=it,i=it){return b(e)?this._buffers.set(t.toString(),new rt(this.baseUrl+e,n,i)):this._buffers.set(t.toString(),new rt(e,n,i)),this}dispose(){return super.dispose(),this._buffers.forEach(t=>t.dispose()),this._buffers.clear(),this}}class Yt extends xt{constructor(){super(...arguments),this.name="MidiClass",this.defaultUnits="midi"}_frequencyToUnits(t){return mt(super._frequencyToUnits(t))}_ticksToUnits(t){return mt(super._ticksToUnits(t))}_beatsToUnits(t){return mt(super._beatsToUnits(t))}_secondsToUnits(t){return mt(super._secondsToUnits(t))}toMidi(){return this.valueOf()}toFrequency(){return gt(this.toMidi())}transpose(t){return new Yt(this.context,this.toMidi()+t)}}function Zt(t,e){return new Yt(ut(),t,e)}class Xt extends St{constructor(){super(...arguments),this.name="Ticks",this.defaultUnits="i"}_now(){return this.context.transport.ticks}_beatsToUnits(t){return this._getPPQ()*t}_secondsToUnits(t){return Math.floor(t/(60/this._getBpm())*this._getPPQ())}_ticksToUnits(t){return t}toTicks(){return this.valueOf()}toSeconds(){return this.valueOf()/this._getPPQ()*(60/this._getBpm())}}function Qt(t,e){return new Xt(ut(),t,e)}class Ht extends At{constructor(){super(...arguments),this.name="Draw",this.expiration=.25,this.anticipation=.008,this._events=new Z,this._boundDrawLoop=this._drawLoop.bind(this),this._animationFrame=-1}schedule(t,e){return this._events.add({callback:t,time:this.toSeconds(e)}),1===this._events.length&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop)),this}cancel(t){return this._events.cancel(this.toSeconds(t)),this}_drawLoop(){const t=this.context.currentTime;for(;this._events.length&&this._events.peek().time-this.anticipation<=t;){const e=this._events.shift();e&&t-e.time<=this.expiration&&e.callback()}this._events.length>0&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop))}dispose(){return super.dispose(),this._events.dispose(),cancelAnimationFrame(this._animationFrame),this}}Q(t=>{t.draw=new Ht({context:t})}),$(t=>{t.draw.dispose()});class $t extends z{constructor(){super(...arguments),this.name="IntervalTimeline",this._root=null,this._length=0}add(t){o(d(t.time),"Events must have a time property"),o(d(t.duration),"Events must have a duration parameter"),t.time=t.time.valueOf();let e=new Jt(t.time,t.time+t.duration,t);for(null===this._root?this._root=e:this._root.insert(e),this._length++;null!==e;)e.updateHeight(),e.updateMax(),this._rebalance(e),e=e.parent;return this}remove(t){if(null!==this._root){const e=[];this._root.search(t.time,e);for(const n of e)if(n.event===t){this._removeNode(n),this._length--;break}}return this}get length(){return this._length}cancel(t){return this.forEachFrom(t,t=>this.remove(t)),this}_setRoot(t){this._root=t,null!==this._root&&(this._root.parent=null)}_replaceNodeInParent(t,e){null!==t.parent?(t.isLeftChild()?t.parent.left=e:t.parent.right=e,this._rebalance(t.parent)):this._setRoot(e)}_removeNode(t){if(null===t.left&&null===t.right)this._replaceNodeInParent(t,null);else if(null===t.right)this._replaceNodeInParent(t,t.left);else if(null===t.left)this._replaceNodeInParent(t,t.right);else{let e,n=null;if(t.getBalance()>0)if(null===t.left.right)e=t.left,e.right=t.right,n=e;else{for(e=t.left.right;null!==e.right;)e=e.right;e.parent&&(e.parent.right=e.left,n=e.parent,e.left=t.left,e.right=t.right)}else if(null===t.right.left)e=t.right,e.left=t.left,n=e;else{for(e=t.right.left;null!==e.left;)e=e.left;e.parent&&(e.parent.left=e.right,n=e.parent,e.left=t.left,e.right=t.right)}null!==t.parent?t.isLeftChild()?t.parent.left=e:t.parent.right=e:this._setRoot(e),n&&this._rebalance(n)}t.dispose()}_rotateLeft(t){const e=t.parent,n=t.isLeftChild(),i=t.right;i&&(t.right=i.left,i.left=t),null!==e?n?e.left=i:e.right=i:this._setRoot(i)}_rotateRight(t){const e=t.parent,n=t.isLeftChild(),i=t.left;i&&(t.left=i.right,i.right=t),null!==e?n?e.left=i:e.right=i:this._setRoot(i)}_rebalance(t){const e=t.getBalance();e>1&&t.left?t.left.getBalance()<0?this._rotateLeft(t.left):this._rotateRight(t):e<-1&&t.right&&(t.right.getBalance()>0?this._rotateRight(t.right):this._rotateLeft(t))}get(t){if(null!==this._root){const e=[];if(this._root.search(t,e),e.length>0){let t=e[0];for(let n=1;n<e.length;n++)e[n].low>t.low&&(t=e[n]);return t.event}}return null}forEach(t){if(null!==this._root){const e=[];this._root.traverse(t=>e.push(t)),e.forEach(e=>{e.event&&t(e.event)})}return this}forEachAtTime(t,e){if(null!==this._root){const n=[];this._root.search(t,n),n.forEach(t=>{t.event&&e(t.event)})}return this}forEachFrom(t,e){if(null!==this._root){const n=[];this._root.searchAfter(t,n),n.forEach(t=>{t.event&&e(t.event)})}return this}dispose(){return super.dispose(),null!==this._root&&this._root.traverse(t=>t.dispose()),this._root=null,this}}class Jt{constructor(t,e,n){this._left=null,this._right=null,this.parent=null,this.height=0,this.event=n,this.low=t,this.high=e,this.max=this.high}insert(t){t.low<=this.low?null===this.left?this.left=t:this.left.insert(t):null===this.right?this.right=t:this.right.insert(t)}search(t,e){t>this.max||(null!==this.left&&this.left.search(t,e),this.low<=t&&this.high>t&&e.push(this),this.low>t||null!==this.right&&this.right.search(t,e))}searchAfter(t,e){this.low>=t&&(e.push(this),null!==this.left&&this.left.searchAfter(t,e)),null!==this.right&&this.right.searchAfter(t,e)}traverse(t){t(this),null!==this.left&&this.left.traverse(t),null!==this.right&&this.right.traverse(t)}updateHeight(){null!==this.left&&null!==this.right?this.height=Math.max(this.left.height,this.right.height)+1:null!==this.right?this.height=this.right.height+1:null!==this.left?this.height=this.left.height+1:this.height=0}updateMax(){this.max=this.high,null!==this.left&&(this.max=Math.max(this.max,this.left.max)),null!==this.right&&(this.max=Math.max(this.max,this.right.max))}getBalance(){let t=0;return null!==this.left&&null!==this.right?t=this.left.height-this.right.height:null!==this.left?t=this.left.height+1:null!==this.right&&(t=-(this.right.height+1)),t}isLeftChild(){return null!==this.parent&&this.parent.left===this}get left(){return this._left}set left(t){this._left=t,null!==t&&(t.parent=this),this.updateHeight(),this.updateMax()}get right(){return this._right}set right(t){this._right=t,null!==t&&(t.parent=this),this.updateHeight(),this.updateMax()}dispose(){this.parent=null,this._left=null,this._right=null,this.event=null}}class Kt extends Rt{constructor(){super(F(Kt.getDefaults(),arguments,["volume"])),this.name="Volume";const t=F(Kt.getDefaults(),arguments,["volume"]);this.input=this.output=new Pt({context:this.context,gain:t.volume,units:"decibels"}),this.volume=this.output.gain,et(this,"volume"),this._unmutedVolume=t.volume,this.mute=t.mute}static getDefaults(){return Object.assign(Rt.getDefaults(),{mute:!1,volume:0})}get mute(){return this.volume.value===-1/0}set mute(t){!this.mute&&t?(this._unmutedVolume=this.volume.value,this.volume.value=-1/0):this.mute&&!t&&(this.volume.value=this._unmutedVolume)}dispose(){return super.dispose(),this.input.dispose(),this.volume.dispose(),this}}class te extends Rt{constructor(){super(F(te.getDefaults(),arguments)),this.name="Destination",this.input=new Kt({context:this.context}),this.output=new Pt({context:this.context}),this.volume=this.input.volume;const t=F(te.getDefaults(),arguments);Et(this.input,this.output,this.context.rawContext.destination),this.mute=t.mute,this._internalChannels=[this.input,this.context.rawContext.destination,this.output]}static getDefaults(){return Object.assign(Rt.getDefaults(),{mute:!1,volume:0})}get mute(){return this.input.mute}set mute(t){this.input.mute=t}chain(...t){return this.input.disconnect(),t.unshift(this.input),t.push(this.output),Et(...t),this}get maxChannelCount(){return this.context.rawContext.destination.maxChannelCount}dispose(){return super.dispose(),this.volume.dispose(),this}}Q(t=>{t.destination=new te({context:t})}),$(t=>{t.destination.dispose()});class ee extends z{constructor(t){super(),this.name="TimelineValue",this._timeline=new Z({memory:10}),this._initialValue=t}set(t,e){return this._timeline.add({value:t,time:e}),this}get(t){const e=this._timeline.get(t);return e?e.value:this._initialValue}}class ne{constructor(t,e){this.id=ne._eventId++;const n=Object.assign(ne.getDefaults(),e);this.transport=t,this.callback=n.callback,this._once=n.once,this.time=n.time}static getDefaults(){return{callback:it,once:!1,time:0}}invoke(t){this.callback&&(this.callback(t),this._once&&this.transport.clear(this.id))}dispose(){return this.callback=void 0,this}}ne._eventId=0;class ie extends ne{constructor(t,e){super(t,e),this._currentId=-1,this._nextId=-1,this._nextTick=this.time,this._boundRestart=this._restart.bind(this);const n=Object.assign(ie.getDefaults(),e);this.duration=new Xt(t.context,n.duration).valueOf(),this._interval=new Xt(t.context,n.interval).valueOf(),this._nextTick=n.time,this.transport.on("start",this._boundRestart),this.transport.on("loopStart",this._boundRestart),this.context=this.transport.context,this._restart()}static getDefaults(){return Object.assign({},ne.getDefaults(),{duration:1/0,interval:1,once:!1})}invoke(t){this._createEvents(t),super.invoke(t)}_createEvents(t){const e=this.transport.getTicksAtTime(t);e>=this.time&&e>=this._nextTick&&this._nextTick+this._interval<this.time+this.duration&&(this._nextTick+=this._interval,this._currentId=this._nextId,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new Xt(this.context,this._nextTick).toSeconds()))}_restart(t){this.transport.clear(this._currentId),this.transport.clear(this._nextId),this._nextTick=this.time;const e=this.transport.getTicksAtTime(t);e>this.time&&(this._nextTick=this.time+Math.ceil((e-this.time)/this._interval)*this._interval),this._currentId=this.transport.scheduleOnce(this.invoke.bind(this),new Xt(this.context,this._nextTick).toSeconds()),this._nextTick+=this._interval,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new Xt(this.context,this._nextTick).toSeconds())}dispose(){return super.dispose(),this.transport.clear(this._currentId),this.transport.clear(this._nextId),this.transport.off("start",this._boundRestart),this.transport.off("loopStart",this._boundRestart),this}}class re extends At{constructor(){super(F(re.getDefaults(),arguments)),this.name="Transport",this._loop=new ee(!1),this._loopStart=0,this._loopEnd=0,this._scheduledEvents={},this._timeline=new Z,this._repeatedEvents=new $t,this._syncedSignals=[],this._swingAmount=0;const t=F(re.getDefaults(),arguments);this._ppq=t.ppq,this._clock=new Bt({callback:this._processTick.bind(this),context:this.context,frequency:0,units:"bpm"}),this._bindClockEvents(),this.bpm=this._clock.frequency,this._clock.frequency.multiplier=t.ppq,this.bpm.setValueAtTime(t.bpm,0),et(this,"bpm"),this._timeSignature=t.timeSignature,this._swingTicks=t.ppq/2}static getDefaults(){return Object.assign(At.getDefaults(),{bpm:120,loopEnd:"4m",loopStart:0,ppq:192,swing:0,swingSubdivision:"8n",timeSignature:4})}_processTick(t,e){if(this._loop.get(t)&&e>=this._loopEnd&&(this.emit("loopEnd",t),this._clock.setTicksAtTime(this._loopStart,t),e=this._loopStart,this.emit("loopStart",t,this._clock.getSecondsAtTime(t)),this.emit("loop",t)),this._swingAmount>0&&e%this._ppq!=0&&e%(2*this._swingTicks)!=0){const n=e%(2*this._swingTicks)/(2*this._swingTicks),i=Math.sin(n*Math.PI)*this._swingAmount;t+=new Xt(this.context,2*this._swingTicks/3).toSeconds()*i}this._timeline.forEachAtTime(e,e=>e.invoke(t))}schedule(t,e){const n=new ne(this,{callback:t,time:new St(this.context,e).toTicks()});return this._addEvent(n,this._timeline)}scheduleRepeat(t,e,n,i=1/0){const r=new ie(this,{callback:t,duration:new yt(this.context,i).toTicks(),interval:new yt(this.context,e).toTicks(),time:new St(this.context,n).toTicks()});return this._addEvent(r,this._repeatedEvents)}scheduleOnce(t,e){const n=new ne(this,{callback:t,once:!0,time:new St(this.context,e).toTicks()});return this._addEvent(n,this._timeline)}clear(t){if(this._scheduledEvents.hasOwnProperty(t)){const e=this._scheduledEvents[t.toString()];e.timeline.remove(e.event),e.event.dispose(),delete this._scheduledEvents[t.toString()]}return this}_addEvent(t,e){return this._scheduledEvents[t.id.toString()]={event:t,timeline:e},e.add(t),t.id}cancel(t=0){const e=this.toTicks(t);return this._timeline.forEachFrom(e,t=>this.clear(t.id)),this._repeatedEvents.forEachFrom(e,t=>this.clear(t.id)),this}_bindClockEvents(){this._clock.on("start",(t,e)=>{e=new Xt(this.context,e).toSeconds(),this.emit("start",t,e)}),this._clock.on("stop",t=>{this.emit("stop",t)}),this._clock.on("pause",t=>{this.emit("pause",t)})}get state(){return this._clock.getStateAtTime(this.now())}start(t,e){let n;return d(e)&&(n=this.toTicks(e)),this._clock.start(t,n),this}stop(t){return this._clock.stop(t),this}pause(t){return this._clock.pause(t),this}toggle(t){return t=this.toSeconds(t),"started"!==this._clock.getStateAtTime(t)?this.start(t):this.stop(t),this}get timeSignature(){return this._timeSignature}set timeSignature(t){y(t)&&(t=t[0]/t[1]*4),this._timeSignature=t}get loopStart(){return new yt(this.context,this._loopStart,"i").toSeconds()}set loopStart(t){this._loopStart=this.toTicks(t)}get loopEnd(){return new yt(this.context,this._loopEnd,"i").toSeconds()}set loopEnd(t){this._loopEnd=this.toTicks(t)}get loop(){return this._loop.get(this.now())}set loop(t){this._loop.set(t,this.now())}setLoopPoints(t,e){return this.loopStart=t,this.loopEnd=e,this}get swing(){return this._swingAmount}set swing(t){this._swingAmount=t}get swingSubdivision(){return new Xt(this.context,this._swingTicks).toNotation()}set swingSubdivision(t){this._swingTicks=this.toTicks(t)}get position(){const t=this.now(),e=this._clock.getTicksAtTime(t);return new Xt(this.context,e).toBarsBeatsSixteenths()}set position(t){const e=this.toTicks(t);this.ticks=e}get seconds(){return this._clock.seconds}set seconds(t){const e=this.now(),n=this._clock.frequency.timeToTicks(t,e);this.ticks=n}get progress(){if(this.loop){const t=this.now();return(this._clock.getTicksAtTime(t)-this._loopStart)/(this._loopEnd-this._loopStart)}return 0}get ticks(){return this._clock.ticks}set ticks(t){if(this._clock.ticks!==t){const e=this.now();if("started"===this.state){const n=this._clock.getTicksAtTime(e),i=e+this._clock.frequency.getDurationOfTicks(Math.ceil(n)-n,e);this.emit("stop",i),this._clock.setTicksAtTime(t,i),this.emit("start",i,this._clock.getSecondsAtTime(i))}else this._clock.setTicksAtTime(t,e)}}getTicksAtTime(t){return Math.round(this._clock.getTicksAtTime(t))}getSecondsAtTime(t){return this._clock.getSecondsAtTime(t)}get PPQ(){return this._clock.frequency.multiplier}set PPQ(t){this._clock.frequency.multiplier=t}nextSubdivision(t){if(t=this.toTicks(t),"started"!==this.state)return 0;{const e=this.now(),n=t-this.getTicksAtTime(e)%t;return this._clock.nextTickTime(n,e)}}syncSignal(t,e){if(!e){const n=this.now();if(0!==t.getValueAtTime(n)){const i=1/(60/this.bpm.getValueAtTime(n)/this.PPQ);e=t.getValueAtTime(n)/i}else e=0}const n=new Pt(e);return this.bpm.connect(n),n.connect(t._param),this._syncedSignals.push({initial:t.value,ratio:n,signal:t}),t.value=0,this}unsyncSignal(t){for(let e=this._syncedSignals.length-1;e>=0;e--){const n=this._syncedSignals[e];n.signal===t&&(n.ratio.dispose(),n.signal.value=n.initial,this._syncedSignals.splice(e,1))}return this}dispose(){return super.dispose(),this._clock.dispose(),nt(this,"bpm"),this._timeline.dispose(),this._repeatedEvents.dispose(),this}}J.mixin(re),Q(t=>{t.transport=new re({context:t})}),$(t=>{t.transport.dispose()});class se extends Rt{constructor(t){super(t),this.input=void 0,this._state=new Dt("stopped"),this._synced=!1,this._scheduled=[],this._syncedStart=it,this._syncedStop=it,this._state.memory=100,this._state.increasing=!0,this._volume=this.output=new Kt({context:this.context,mute:t.mute,volume:t.volume}),this.volume=this._volume.volume,et(this,"volume"),this.onstop=t.onstop}static getDefaults(){return Object.assign(Rt.getDefaults(),{mute:!1,onstop:it,volume:0})}get state(){return this._synced?"started"===this.context.transport.state?this._state.getValueAtTime(this.context.transport.seconds):"stopped":this._state.getValueAtTime(this.now())}get mute(){return this._volume.mute}set mute(t){this._volume.mute=t}_clampToCurrentTime(t){return this._synced?t:Math.max(t,this.context.currentTime)}start(t,e,n){let i=p(t)&&this._synced?this.context.transport.seconds:this.toSeconds(t);if(i=this._clampToCurrentTime(i),this._synced||"started"!==this._state.getValueAtTime(i))if(this.log("start",i),this._state.setStateAtTime("started",i),this._synced){const t=this._state.get(i);t&&(t.offset=this.toSeconds(V(e,0)),t.duration=n?this.toSeconds(n):void 0);const r=this.context.transport.schedule(t=>{this._start(t,e,n)},i);this._scheduled.push(r),"started"===this.context.transport.state&&this.context.transport.getSecondsAtTime(this.immediate())>i&&this._syncedStart(this.now(),this.context.transport.seconds)}else u(this.context),this._start(i,e,n);else o(B(i,this._state.get(i).time),"Start time must be strictly greater than previous start time"),this._state.cancel(i),this._state.setStateAtTime("started",i),this.log("restart",i),this.restart(i,e,n);return this}stop(t){let e=p(t)&&this._synced?this.context.transport.seconds:this.toSeconds(t);if(e=this._clampToCurrentTime(e),"started"===this._state.getValueAtTime(e)||d(this._state.getNextState("started",e))){if(this.log("stop",e),this._synced){const t=this.context.transport.schedule(this._stop.bind(this),e);this._scheduled.push(t)}else this._stop(e);this._state.cancel(e),this._state.setStateAtTime("stopped",e)}return this}restart(t,e,n){return t=this.toSeconds(t),"started"===this._state.getValueAtTime(t)&&(this._state.cancel(t),this._restart(t,e,n)),this}sync(){return this._synced||(this._synced=!0,this._syncedStart=(t,e)=>{if(e>0){const n=this._state.get(e);if(n&&"started"===n.state&&n.time!==e){const i=e-this.toSeconds(n.time);let r;n.duration&&(r=this.toSeconds(n.duration)-i),this._start(t,this.toSeconds(n.offset)+i,r)}}},this._syncedStop=t=>{const e=this.context.transport.getSecondsAtTime(Math.max(t-this.sampleTime,0));"started"===this._state.getValueAtTime(e)&&this._stop(t)},this.context.transport.on("start",this._syncedStart),this.context.transport.on("loopStart",this._syncedStart),this.context.transport.on("stop",this._syncedStop),this.context.transport.on("pause",this._syncedStop),this.context.transport.on("loopEnd",this._syncedStop)),this}unsync(){return this._synced&&(this.context.transport.off("stop",this._syncedStop),this.context.transport.off("pause",this._syncedStop),this.context.transport.off("loopEnd",this._syncedStop),this.context.transport.off("start",this._syncedStart),this.context.transport.off("loopStart",this._syncedStart)),this._synced=!1,this._scheduled.forEach(t=>this.context.transport.clear(t)),this._scheduled=[],this._state.cancel(0),this._stop(0),this}dispose(){return super.dispose(),this.onstop=it,this.unsync(),this._volume.dispose(),this._state.dispose(),this}}class oe extends qt{constructor(){super(F(oe.getDefaults(),arguments,["url","onload"])),this.name="ToneBufferSource",this._source=this.context.createBufferSource(),this._internalChannels=[this._source],this._sourceStarted=!1,this._sourceStopped=!1;const t=F(oe.getDefaults(),arguments,["url","onload"]);jt(this._source,this._gainNode),this._source.onended=()=>this._stopSource(),this.playbackRate=new Ct({context:this.context,param:this._source.playbackRate,units:"positive",value:t.playbackRate}),this.loop=t.loop,this.loopStart=t.loopStart,this.loopEnd=t.loopEnd,this._buffer=new rt(t.url,t.onload,t.onerror),this._internalChannels.push(this._source)}static getDefaults(){return Object.assign(qt.getDefaults(),{url:new rt,loop:!1,loopEnd:0,loopStart:0,onload:it,onerror:it,playbackRate:1})}get fadeIn(){return this._fadeIn}set fadeIn(t){this._fadeIn=t}get fadeOut(){return this._fadeOut}set fadeOut(t){this._fadeOut=t}get curve(){return this._curve}set curve(t){this._curve=t}start(t,e,n,i=1){o(this.buffer.loaded,"buffer is either not set or not loaded");const r=this.toSeconds(t);this._startGain(r,i),e=this.loop?V(e,this.loopStart):V(e,0);let s=Math.max(this.toSeconds(e),0);if(this.loop){const t=this.toSeconds(this.loopEnd)||this.buffer.duration,e=this.toSeconds(this.loopStart),n=t-e;W(s,t)&&(s=(s-e)%n+e),U(s,this.buffer.duration)&&(s=0)}if(this._source.buffer=this.buffer.get(),this._source.loopEnd=this.toSeconds(this.loopEnd)||this.buffer.duration,G(s,this.buffer.duration)&&(this._sourceStarted=!0,this._source.start(r,s)),d(n)){let t=this.toSeconds(n);t=Math.max(t,0),this.stop(r+t)}return this}_stopSource(t){if(!this._sourceStopped&&this._sourceStarted){this._sourceStopped=!0;try{this._source.stop(this.toSeconds(t))}catch(t){console.error("ToneBufferSource _stopSource error",t)}this._onended()}}get loopStart(){return this._source.loopStart}set loopStart(t){this._source.loopStart=this.toSeconds(t)}get loopEnd(){return this._source.loopEnd}set loopEnd(t){this._source.loopEnd=this.toSeconds(t)}get buffer(){return this._buffer}set buffer(t){this._buffer.set(t)}get loop(){return this._source.loop}set loop(t){this._source.loop=t,this._sourceStarted&&this.cancelStop()}dispose(){return super.dispose(),this._source.onended=null,this._source.disconnect(),this._buffer.dispose(),this.playbackRate.dispose(),this}}class ae extends se{constructor(){super(F(ae.getDefaults(),arguments,["type"])),this.name="Noise",this._source=null;const t=F(ae.getDefaults(),arguments,["type"]);this._playbackRate=t.playbackRate,this.type=t.type,this._fadeIn=t.fadeIn,this._fadeOut=t.fadeOut}static getDefaults(){return Object.assign(se.getDefaults(),{fadeIn:0,fadeOut:0,playbackRate:1,type:"white"})}get type(){return this._type}set type(t){if(o(t in ce,"Noise: invalid type: "+t),this._type!==t&&(this._type=t,"started"===this.state)){const t=this.now();this._stop(t),this._start(t)}}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t,this._source&&(this._source.playbackRate.value=t)}_start(t){const e=ce[this._type];this._source=new oe({url:e,context:this.context,fadeIn:this._fadeIn,fadeOut:this._fadeOut,loop:!0,onended:()=>this.onstop(this),playbackRate:this._playbackRate}).connect(this.output),this._source.start(this.toSeconds(t),Math.random()*(e.duration-.001))}_stop(t){this._source&&(this._source.stop(this.toSeconds(t)),this._source=null)}get fadeIn(){return this._fadeIn}set fadeIn(t){this._fadeIn=t,this._source&&(this._source.fadeIn=this._fadeIn)}get fadeOut(){return this._fadeOut}set fadeOut(t){this._fadeOut=t,this._source&&(this._source.fadeOut=this._fadeOut)}_restart(t){this._stop(t),this._start(t)}dispose(){return super.dispose(),this._source&&this._source.disconnect(),this}}const ue={brown:null,pink:null,white:null},ce={get brown(){if(!ue.brown){const t=[];for(let e=0;e<2;e++){const n=new Float32Array(220500);t[e]=n;let i=0;for(let t=0;t<220500;t++){const e=2*Math.random()-1;n[t]=(i+.02*e)/1.02,i=n[t],n[t]*=3.5}}ue.brown=(new rt).fromArray(t)}return ue.brown},get pink(){if(!ue.pink){const t=[];for(let e=0;e<2;e++){const n=new Float32Array(220500);let i,r,s,o,a,u,c;t[e]=n,i=r=s=o=a=u=c=0;for(let t=0;t<220500;t++){const e=2*Math.random()-1;i=.99886*i+.0555179*e,r=.99332*r+.0750759*e,s=.969*s+.153852*e,o=.8665*o+.3104856*e,a=.55*a+.5329522*e,u=-.7616*u-.016898*e,n[t]=i+r+s+o+a+u+c+.5362*e,n[t]*=.11,c=.115926*e}}ue.pink=(new rt).fromArray(t)}return ue.pink},get white(){if(!ue.white){const t=[];for(let e=0;e<2;e++){const n=new Float32Array(220500);t[e]=n;for(let t=0;t<220500;t++)n[t]=2*Math.random()-1}ue.white=(new rt).fromArray(t)}return ue.white}};class le extends Rt{constructor(){super(F(le.getDefaults(),arguments,["volume"])),this.name="UserMedia";const t=F(le.getDefaults(),arguments,["volume"]);this._volume=this.output=new Kt({context:this.context,volume:t.volume}),this.volume=this._volume.volume,et(this,"volume"),this.mute=t.mute}static getDefaults(){return Object.assign(Rt.getDefaults(),{mute:!1,volume:0})}open(t){return D(this,void 0,void 0,(function*(){o(le.supported,"UserMedia is not supported"),"started"===this.state&&this.close();const e=yield le.enumerateDevices();_(t)?this._device=e[t]:(this._device=e.find(e=>e.label===t||e.deviceId===t),!this._device&&e.length>0&&(this._device=e[0]),o(d(this._device),"No matching device "+t));const n={audio:{echoCancellation:!1,sampleRate:this.context.sampleRate,noiseSuppression:!1,mozNoiseSuppression:!1}};this._device&&(n.audio.deviceId=this._device.deviceId);const i=yield navigator.mediaDevices.getUserMedia(n);if(!this._stream){this._stream=i;const t=this.context.createMediaStreamSource(i);jt(t,this.output),this._mediaStream=t}return this}))}close(){return this._stream&&this._mediaStream&&(this._stream.getAudioTracks().forEach(t=>{t.stop()}),this._stream=void 0,this._mediaStream.disconnect(),this._mediaStream=void 0),this._device=void 0,this}static enumerateDevices(){return D(this,void 0,void 0,(function*(){return(yield navigator.mediaDevices.enumerateDevices()).filter(t=>"audioinput"===t.kind)}))}get state(){return this._stream&&this._stream.active?"started":"stopped"}get deviceId(){return this._device?this._device.deviceId:void 0}get groupId(){return this._device?this._device.groupId:void 0}get label(){return this._device?this._device.label:void 0}get mute(){return this._volume.mute}set mute(t){this._volume.mute=t}dispose(){return super.dispose(),this.close(),this._volume.dispose(),this.volume.dispose(),this}static get supported(){return d(navigator.mediaDevices)&&d(navigator.mediaDevices.getUserMedia)}}function he(t,e){return D(this,void 0,void 0,(function*(){const n=e/t.context.sampleRate,i=new st(1,n,t.context.sampleRate);new t.constructor(Object.assign(t.get(),{frequency:2/n,detune:0,context:i})).toDestination().start(0);return(yield i.render()).getChannelData(0)}))}class fe extends qt{constructor(){super(F(fe.getDefaults(),arguments,["frequency","type"])),this.name="ToneOscillatorNode",this._oscillator=this.context.createOscillator(),this._internalChannels=[this._oscillator];const t=F(fe.getDefaults(),arguments,["frequency","type"]);jt(this._oscillator,this._gainNode),this.type=t.type,this.frequency=new Ct({context:this.context,param:this._oscillator.frequency,units:"frequency",value:t.frequency}),this.detune=new Ct({context:this.context,param:this._oscillator.detune,units:"cents",value:t.detune}),et(this,["frequency","detune"])}static getDefaults(){return Object.assign(qt.getDefaults(),{detune:0,frequency:440,type:"sine"})}start(t){const e=this.toSeconds(t);return this.log("start",e),this._startGain(e),this._oscillator.start(e),this}_stopSource(t){try{this._oscillator.stop(t)}catch(t){console.warn("ToneOscillatorNode: _oscillator already stopped")}}setPeriodicWave(t){return this._oscillator.setPeriodicWave(t),this}get type(){return this._oscillator.type}set type(t){this._oscillator.type=t}dispose(){return super.dispose(),"started"===this.state&&this.stop(),this._oscillator.disconnect(),this.frequency.dispose(),this.detune.dispose(),this}}class pe extends se{constructor(){super(F(pe.getDefaults(),arguments,["frequency","type"])),this.name="Oscillator",this._oscillator=null;const t=F(pe.getDefaults(),arguments,["frequency","type"]);this.frequency=new Ft({context:this.context,units:"frequency",value:t.frequency}),et(this,"frequency"),this.detune=new Ft({context:this.context,units:"cents",value:t.detune}),et(this,"detune"),this._partials=t.partials,this._partialCount=t.partialCount,this._type=t.type,t.partialCount&&"custom"!==t.type&&(this._type=this.baseType+t.partialCount.toString()),this.phase=t.phase}static getDefaults(){return Object.assign(se.getDefaults(),{detune:0,frequency:440,partialCount:0,partials:[],phase:0,type:"sine"})}_start(t){const e=this.toSeconds(t),n=new fe({context:this.context,onended:()=>this.onstop(this)});this._oscillator=n,this._wave?this._oscillator.setPeriodicWave(this._wave):this._oscillator.type=this._type,this._oscillator.connect(this.output),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.start(e)}_stop(t){const e=this.toSeconds(t);this._oscillator&&this._oscillator.stop(e)}_restart(t){const e=this.toSeconds(t);return this.log("restart",e),this._oscillator&&this._oscillator.cancelStop(),this._state.cancel(e),this}syncFrequency(){return this.context.transport.syncSignal(this.frequency),this}unsyncFrequency(){return this.context.transport.unsyncSignal(this.frequency),this}_getCachedPeriodicWave(){if("custom"===this._type){return pe._periodicWaveCache.find(t=>{return t.phase===this._phase&&(e=t.partials,n=this._partials,e.length===n.length&&e.every((t,e)=>n[e]===t));var e,n})}{const t=pe._periodicWaveCache.find(t=>t.type===this._type&&t.phase===this._phase);return this._partialCount=t?t.partialCount:this._partialCount,t}}get type(){return this._type}set type(t){this._type=t;const e=-1!==["sine","square","sawtooth","triangle"].indexOf(t);if(0===this._phase&&e)this._wave=void 0,this._partialCount=0,null!==this._oscillator&&(this._oscillator.type=t);else{const e=this._getCachedPeriodicWave();if(d(e)){const{partials:t,wave:n}=e;this._wave=n,this._partials=t,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave)}else{const[e,n]=this._getRealImaginary(t,this._phase),i=this.context.createPeriodicWave(e,n);this._wave=i,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave),pe._periodicWaveCache.push({imag:n,partialCount:this._partialCount,partials:this._partials,phase:this._phase,real:e,type:this._type,wave:this._wave}),pe._periodicWaveCache.length>100&&pe._periodicWaveCache.shift()}}}get baseType(){return this._type.replace(this.partialCount.toString(),"")}set baseType(t){this.partialCount&&"custom"!==this._type&&"custom"!==t?this.type=t+this.partialCount:this.type=t}get partialCount(){return this._partialCount}set partialCount(t){a(t,0);let e=this._type;const n=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(this._type);if(n&&(e=n[1]),"custom"!==this._type)this.type=0===t?e:e+t.toString();else{const e=new Float32Array(t);this._partials.forEach((t,n)=>e[n]=t),this._partials=Array.from(e),this.type=this._type}}_getRealImaginary(t,e){let n=2048;const i=new Float32Array(n),r=new Float32Array(n);let s=1;if("custom"===t){if(s=this._partials.length+1,this._partialCount=this._partials.length,n=s,0===this._partials.length)return[i,r]}else{const e=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(t);e?(s=parseInt(e[2],10)+1,this._partialCount=parseInt(e[2],10),t=e[1],s=Math.max(s,2),n=s):this._partialCount=0,this._partials=[]}for(let o=1;o<n;++o){const n=2/(o*Math.PI);let a;switch(t){case"sine":a=o<=s?1:0,this._partials[o-1]=a;break;case"square":a=1&o?2*n:0,this._partials[o-1]=a;break;case"sawtooth":a=n*(1&o?1:-1),this._partials[o-1]=a;break;case"triangle":a=1&o?n*n*2*(o-1>>1&1?-1:1):0,this._partials[o-1]=a;break;case"custom":a=this._partials[o-1];break;default:throw new TypeError("Oscillator: invalid type: "+t)}0!==a?(i[o]=-a*Math.sin(e*o),r[o]=a*Math.cos(e*o)):(i[o]=0,r[o]=0)}return[i,r]}_inverseFFT(t,e,n){let i=0;const r=t.length;for(let s=0;s<r;s++)i+=t[s]*Math.cos(s*n)+e[s]*Math.sin(s*n);return i}getInitialValue(){const[t,e]=this._getRealImaginary(this._type,0);let n=0;const i=2*Math.PI;for(let r=0;r<32;r++)n=Math.max(this._inverseFFT(t,e,r/32*i),n);return Y(-this._inverseFFT(t,e,this._phase)/n,-1,1)}get partials(){return this._partials.slice(0,this.partialCount)}set partials(t){this._partials=t,this._partialCount=this._partials.length,t.length&&(this.type="custom")}get phase(){return this._phase*(180/Math.PI)}set phase(t){this._phase=t*Math.PI/180,this.type=this._type}asArray(t=1024){return D(this,void 0,void 0,(function*(){return he(this,t)}))}dispose(){return super.dispose(),null!==this._oscillator&&this._oscillator.dispose(),this._wave=void 0,this.frequency.dispose(),this.detune.dispose(),this}}pe._periodicWaveCache=[];class de extends Rt{constructor(){super(Object.assign(F(de.getDefaults(),arguments,["context"])))}connect(t,e=0,n=0){return Vt(this,t,e,n),this}}class me extends de{constructor(){super(Object.assign(F(me.getDefaults(),arguments,["mapping","length"]))),this.name="WaveShaper",this._shaper=this.context.createWaveShaper(),this.input=this._shaper,this.output=this._shaper;const t=F(me.getDefaults(),arguments,["mapping","length"]);y(t.mapping)||t.mapping instanceof Float32Array?this.curve=Float32Array.from(t.mapping):m(t.mapping)&&this.setMap(t.mapping,t.length)}static getDefaults(){return Object.assign(Ft.getDefaults(),{length:1024})}setMap(t,e=1024){const n=new Float32Array(e);for(let i=0,r=e;i<r;i++){const e=i/(r-1)*2-1;n[i]=t(e,i)}return this.curve=n,this}get curve(){return this._shaper.curve}set curve(t){this._shaper.curve=t}get oversample(){return this._shaper.oversample}set oversample(t){o(["none","2x","4x"].some(e=>e.includes(t)),"oversampling must be either 'none', '2x', or '4x'"),this._shaper.oversample=t}dispose(){return super.dispose(),this._shaper.disconnect(),this}}class _e extends de{constructor(){super(...arguments),this.name="AudioToGain",this._norm=new me({context:this.context,mapping:t=>(t+1)/2}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class ge extends Ft{constructor(){super(Object.assign(F(ge.getDefaults(),arguments,["value"]))),this.name="Multiply",this.override=!1;const t=F(ge.getDefaults(),arguments,["value"]);this._mult=this.input=this.output=new Pt({context:this.context,minValue:t.minValue,maxValue:t.maxValue}),this.factor=this._param=this._mult.gain,this.factor.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(Ft.getDefaults(),{value:0})}dispose(){return super.dispose(),this._mult.dispose(),this}}class ve extends se{constructor(){super(F(ve.getDefaults(),arguments,["frequency","type","modulationType"])),this.name="AMOscillator",this._modulationScale=new _e({context:this.context}),this._modulationNode=new Pt({context:this.context});const t=F(ve.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new pe({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase,type:t.type}),this.frequency=this._carrier.frequency,this.detune=this._carrier.detune,this._modulator=new pe({context:this.context,phase:t.phase,type:t.modulationType}),this.harmonicity=new ge({context:this.context,units:"positive",value:t.harmonicity}),this.frequency.chain(this.harmonicity,this._modulator.frequency),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output),et(this,["frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(pe.getDefaults(),{harmonicity:1,modulationType:"square"})}_start(t){this._modulator.start(t),this._carrier.start(t)}_stop(t){this._modulator.stop(t),this._carrier.stop(t)}_restart(t){this._modulator.restart(t),this._carrier.restart(t)}get type(){return this._carrier.type}set type(t){this._carrier.type=t}get baseType(){return this._carrier.baseType}set baseType(t){this._carrier.baseType=t}get partialCount(){return this._carrier.partialCount}set partialCount(t){this._carrier.partialCount=t}get modulationType(){return this._modulator.type}set modulationType(t){this._modulator.type=t}get phase(){return this._carrier.phase}set phase(t){this._carrier.phase=t,this._modulator.phase=t}get partials(){return this._carrier.partials}set partials(t){this._carrier.partials=t}asArray(t=1024){return D(this,void 0,void 0,(function*(){return he(this,t)}))}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this._modulationScale.dispose(),this}}class ye extends se{constructor(){super(F(ye.getDefaults(),arguments,["frequency","type","modulationType"])),this.name="FMOscillator",this._modulationNode=new Pt({context:this.context,gain:0});const t=F(ye.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new pe({context:this.context,detune:t.detune,frequency:0,onstop:()=>this.onstop(this),phase:t.phase,type:t.type}),this.detune=this._carrier.detune,this.frequency=new Ft({context:this.context,units:"frequency",value:t.frequency}),this._modulator=new pe({context:this.context,phase:t.phase,type:t.modulationType}),this.harmonicity=new ge({context:this.context,units:"positive",value:t.harmonicity}),this.modulationIndex=new ge({context:this.context,units:"positive",value:t.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output),this.detune.connect(this._modulator.detune),et(this,["modulationIndex","frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(pe.getDefaults(),{harmonicity:1,modulationIndex:2,modulationType:"square"})}_start(t){this._modulator.start(t),this._carrier.start(t)}_stop(t){this._modulator.stop(t),this._carrier.stop(t)}_restart(t){return this._modulator.restart(t),this._carrier.restart(t),this}get type(){return this._carrier.type}set type(t){this._carrier.type=t}get baseType(){return this._carrier.baseType}set baseType(t){this._carrier.baseType=t}get partialCount(){return this._carrier.partialCount}set partialCount(t){this._carrier.partialCount=t}get modulationType(){return this._modulator.type}set modulationType(t){this._modulator.type=t}get phase(){return this._carrier.phase}set phase(t){this._carrier.phase=t,this._modulator.phase=t}get partials(){return this._carrier.partials}set partials(t){this._carrier.partials=t}asArray(t=1024){return D(this,void 0,void 0,(function*(){return he(this,t)}))}dispose(){return super.dispose(),this.frequency.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this.modulationIndex.dispose(),this}}class be extends se{constructor(){super(F(be.getDefaults(),arguments,["frequency","width"])),this.name="PulseOscillator",this._widthGate=new Pt({context:this.context,gain:0}),this._thresh=new me({context:this.context,mapping:t=>t<=0?-1:1});const t=F(be.getDefaults(),arguments,["frequency","width"]);this.width=new Ft({context:this.context,units:"audioRange",value:t.width}),this._triangle=new pe({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase,type:"triangle"}),this.frequency=this._triangle.frequency,this.detune=this._triangle.detune,this._triangle.chain(this._thresh,this.output),this.width.chain(this._widthGate,this._thresh),et(this,["width","frequency","detune"])}static getDefaults(){return Object.assign(se.getDefaults(),{detune:0,frequency:440,phase:0,type:"pulse",width:.2})}_start(t){t=this.toSeconds(t),this._triangle.start(t),this._widthGate.gain.setValueAtTime(1,t)}_stop(t){t=this.toSeconds(t),this._triangle.stop(t),this._widthGate.gain.cancelScheduledValues(t),this._widthGate.gain.setValueAtTime(0,t)}_restart(t){this._triangle.restart(t),this._widthGate.gain.cancelScheduledValues(t),this._widthGate.gain.setValueAtTime(1,t)}get phase(){return this._triangle.phase}set phase(t){this._triangle.phase=t}get type(){return"pulse"}get baseType(){return"pulse"}get partials(){return[]}get partialCount(){return 0}set carrierType(t){this._triangle.type=t}asArray(t=1024){return D(this,void 0,void 0,(function*(){return he(this,t)}))}dispose(){return super.dispose(),this._triangle.dispose(),this.width.dispose(),this._widthGate.dispose(),this._thresh.dispose(),this}}class xe extends se{constructor(){super(F(xe.getDefaults(),arguments,["frequency","type","spread"])),this.name="FatOscillator",this._oscillators=[];const t=F(xe.getDefaults(),arguments,["frequency","type","spread"]);this.frequency=new Ft({context:this.context,units:"frequency",value:t.frequency}),this.detune=new Ft({context:this.context,units:"cents",value:t.detune}),this._spread=t.spread,this._type=t.type,this._phase=t.phase,this._partials=t.partials,this._partialCount=t.partialCount,this.count=t.count,et(this,["frequency","detune"])}static getDefaults(){return Object.assign(pe.getDefaults(),{count:3,spread:20,type:"sawtooth"})}_start(t){t=this.toSeconds(t),this._forEach(e=>e.start(t))}_stop(t){t=this.toSeconds(t),this._forEach(e=>e.stop(t))}_restart(t){this._forEach(e=>e.restart(t))}_forEach(t){for(let e=0;e<this._oscillators.length;e++)t(this._oscillators[e],e)}get type(){return this._type}set type(t){this._type=t,this._forEach(e=>e.type=t)}get spread(){return this._spread}set spread(t){if(this._spread=t,this._oscillators.length>1){const e=-t/2,n=t/(this._oscillators.length-1);this._forEach((t,i)=>t.detune.value=e+n*i)}}get count(){return this._oscillators.length}set count(t){if(a(t,1),this._oscillators.length!==t){this._forEach(t=>t.dispose()),this._oscillators=[];for(let e=0;e<t;e++){const n=new pe({context:this.context,volume:-6-1.1*t,type:this._type,phase:this._phase+e/t*360,partialCount:this._partialCount,onstop:0===e?()=>this.onstop(this):it});"custom"===this.type&&(n.partials=this._partials),this.frequency.connect(n.frequency),this.detune.connect(n.detune),n.detune.overridden=!1,n.connect(this.output),this._oscillators[e]=n}this.spread=this._spread,"started"===this.state&&this._forEach(t=>t.start())}}get phase(){return this._phase}set phase(t){this._phase=t,this._forEach((t,e)=>t.phase=this._phase+e/this.count*360)}get baseType(){return this._oscillators[0].baseType}set baseType(t){this._forEach(e=>e.baseType=t),this._type=this._oscillators[0].type}get partials(){return this._oscillators[0].partials}set partials(t){this._partials=t,this._partialCount=this._partials.length,t.length&&(this._type="custom",this._forEach(e=>e.partials=t))}get partialCount(){return this._oscillators[0].partialCount}set partialCount(t){this._partialCount=t,this._forEach(e=>e.partialCount=t),this._type=this._oscillators[0].type}asArray(t=1024){return D(this,void 0,void 0,(function*(){return he(this,t)}))}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this._forEach(t=>t.dispose()),this}}class we extends se{constructor(){super(F(we.getDefaults(),arguments,["frequency","modulationFrequency"])),this.name="PWMOscillator",this.sourceType="pwm",this._scale=new ge({context:this.context,value:2});const t=F(we.getDefaults(),arguments,["frequency","modulationFrequency"]);this._pulse=new be({context:this.context,frequency:t.modulationFrequency}),this._pulse.carrierType="sine",this.modulationFrequency=this._pulse.frequency,this._modulator=new pe({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase}),this.frequency=this._modulator.frequency,this.detune=this._modulator.detune,this._modulator.chain(this._scale,this._pulse.width),this._pulse.connect(this.output),et(this,["modulationFrequency","frequency","detune"])}static getDefaults(){return Object.assign(se.getDefaults(),{detune:0,frequency:440,modulationFrequency:.4,phase:0,type:"pwm"})}_start(t){t=this.toSeconds(t),this._modulator.start(t),this._pulse.start(t)}_stop(t){t=this.toSeconds(t),this._modulator.stop(t),this._pulse.stop(t)}_restart(t){this._modulator.restart(t),this._pulse.restart(t)}get type(){return"pwm"}get baseType(){return"pwm"}get partials(){return[]}get partialCount(){return 0}get phase(){return this._modulator.phase}set phase(t){this._modulator.phase=t}asArray(t=1024){return D(this,void 0,void 0,(function*(){return he(this,t)}))}dispose(){return super.dispose(),this._pulse.dispose(),this._scale.dispose(),this._modulator.dispose(),this}}const Oe={am:ve,fat:xe,fm:ye,oscillator:pe,pulse:be,pwm:we};class ke extends se{constructor(){super(F(ke.getDefaults(),arguments,["frequency","type"])),this.name="OmniOscillator";const t=F(ke.getDefaults(),arguments,["frequency","type"]);this.frequency=new Ft({context:this.context,units:"frequency",value:t.frequency}),this.detune=new Ft({context:this.context,units:"cents",value:t.detune}),et(this,["frequency","detune"]),this.set(t)}static getDefaults(){return Object.assign(pe.getDefaults(),ye.getDefaults(),ve.getDefaults(),xe.getDefaults(),be.getDefaults(),we.getDefaults())}_start(t){this._oscillator.start(t)}_stop(t){this._oscillator.stop(t)}_restart(t){return this._oscillator.restart(t),this}get type(){let t="";return["am","fm","fat"].some(t=>this._sourceType===t)&&(t=this._sourceType),t+this._oscillator.type}set type(t){"fm"===t.substr(0,2)?(this._createNewOscillator("fm"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(2)):"am"===t.substr(0,2)?(this._createNewOscillator("am"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(2)):"fat"===t.substr(0,3)?(this._createNewOscillator("fat"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(3)):"pwm"===t?(this._createNewOscillator("pwm"),this._oscillator=this._oscillator):"pulse"===t?this._createNewOscillator("pulse"):(this._createNewOscillator("oscillator"),this._oscillator=this._oscillator,this._oscillator.type=t)}get partials(){return this._oscillator.partials}set partials(t){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||(this._oscillator.partials=t)}get partialCount(){return this._oscillator.partialCount}set partialCount(t){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||(this._oscillator.partialCount=t)}set(t){return Reflect.has(t,"type")&&t.type&&(this.type=t.type),super.set(t),this}_createNewOscillator(t){if(t!==this._sourceType){this._sourceType=t;const e=Oe[t],n=this.now();if(this._oscillator){const t=this._oscillator;t.stop(n),this.context.setTimeout(()=>t.dispose(),this.blockTime)}this._oscillator=new e({context:this.context}),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.connect(this.output),this._oscillator.onstop=()=>this.onstop(this),"started"===this.state&&this._oscillator.start(n)}}get phase(){return this._oscillator.phase}set phase(t){this._oscillator.phase=t}get sourceType(){return this._sourceType}set sourceType(t){let e="sine";"pwm"!==this._oscillator.type&&"pulse"!==this._oscillator.type&&(e=this._oscillator.type),"fm"===t?this.type="fm"+e:"am"===t?this.type="am"+e:"fat"===t?this.type="fat"+e:"oscillator"===t?this.type=e:"pulse"===t?this.type="pulse":"pwm"===t&&(this.type="pwm")}_getOscType(t,e){return t instanceof Oe[e]}get baseType(){return this._oscillator.baseType}set baseType(t){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||"pulse"===t||"pwm"===t||(this._oscillator.baseType=t)}get width(){return this._getOscType(this._oscillator,"pulse")?this._oscillator.width:void 0}get count(){return this._getOscType(this._oscillator,"fat")?this._oscillator.count:void 0}set count(t){this._getOscType(this._oscillator,"fat")&&_(t)&&(this._oscillator.count=t)}get spread(){return this._getOscType(this._oscillator,"fat")?this._oscillator.spread:void 0}set spread(t){this._getOscType(this._oscillator,"fat")&&_(t)&&(this._oscillator.spread=t)}get modulationType(){return this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am")?this._oscillator.modulationType:void 0}set modulationType(t){(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))&&b(t)&&(this._oscillator.modulationType=t)}get modulationIndex(){return this._getOscType(this._oscillator,"fm")?this._oscillator.modulationIndex:void 0}get harmonicity(){return this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am")?this._oscillator.harmonicity:void 0}get modulationFrequency(){return this._getOscType(this._oscillator,"pwm")?this._oscillator.modulationFrequency:void 0}asArray(t=1024){return D(this,void 0,void 0,(function*(){return he(this,t)}))}dispose(){return super.dispose(),this.detune.dispose(),this.frequency.dispose(),this._oscillator.dispose(),this}}class Se extends Ft{constructor(){super(Object.assign(F(Se.getDefaults(),arguments,["value"]))),this.override=!1,this.name="Add",this._sum=new Pt({context:this.context}),this.input=this._sum,this.output=this._sum,this.addend=this._param,Et(this._constantSource,this._sum)}static getDefaults(){return Object.assign(Ft.getDefaults(),{value:0})}dispose(){return super.dispose(),this._sum.dispose(),this}}class Te extends de{constructor(){super(Object.assign(F(Te.getDefaults(),arguments,["min","max"]))),this.name="Scale";const t=F(Te.getDefaults(),arguments,["min","max"]);this._mult=this.input=new ge({context:this.context,value:t.max-t.min}),this._add=this.output=new Se({context:this.context,value:t.min}),this._min=t.min,this._max=t.max,this.input.connect(this.output)}static getDefaults(){return Object.assign(de.getDefaults(),{max:1,min:0})}get min(){return this._min}set min(t){this._min=t,this._setRange()}get max(){return this._max}set max(t){this._max=t,this._setRange()}_setRange(){this._add.value=this._min,this._mult.value=this._max-this._min}dispose(){return super.dispose(),this._add.dispose(),this._mult.dispose(),this}}class Ae extends de{constructor(){super(Object.assign(F(Ae.getDefaults(),arguments))),this.name="Zero",this._gain=new Pt({context:this.context}),this.output=this._gain,this.input=void 0,jt(this.context.getConstant(0),this._gain)}dispose(){return super.dispose(),Mt(this.context.getConstant(0),this._gain),this}}class De extends Rt{constructor(){super(F(De.getDefaults(),arguments,["frequency","min","max"])),this.name="LFO",this._stoppedValue=0,this._units="number",this.convert=!0,this._fromType=Ct.prototype._fromType,this._toType=Ct.prototype._toType,this._is=Ct.prototype._is,this._clampValue=Ct.prototype._clampValue;const t=F(De.getDefaults(),arguments,["frequency","min","max"]);this._oscillator=new pe({context:this.context,frequency:t.frequency,type:t.type}),this.frequency=this._oscillator.frequency,this._amplitudeGain=new Pt({context:this.context,gain:t.amplitude,units:"normalRange"}),this.amplitude=this._amplitudeGain.gain,this._stoppedSignal=new Ft({context:this.context,units:"audioRange",value:0}),this._zeros=new Ae({context:this.context}),this._a2g=new _e({context:this.context}),this._scaler=this.output=new Te({context:this.context,max:t.max,min:t.min}),this.units=t.units,this.min=t.min,this.max=t.max,this._oscillator.chain(this._amplitudeGain,this._a2g,this._scaler),this._zeros.connect(this._a2g),this._stoppedSignal.connect(this._a2g),et(this,["amplitude","frequency"]),this.phase=t.phase}static getDefaults(){return Object.assign(Rt.getDefaults(),{amplitude:1,frequency:"4n",max:1,min:0,phase:0,type:"sine",units:"number"})}start(t){return t=this.toSeconds(t),this._stoppedSignal.setValueAtTime(0,t),this._oscillator.start(t),this}stop(t){return t=this.toSeconds(t),this._stoppedSignal.setValueAtTime(this._stoppedValue,t),this._oscillator.stop(t),this}sync(){return this._oscillator.sync(),this._oscillator.syncFrequency(),this}unsync(){return this._oscillator.unsync(),this._oscillator.unsyncFrequency(),this}get min(){return this._toType(this._scaler.min)}set min(t){t=this._fromType(t),this._scaler.min=t}get max(){return this._toType(this._scaler.max)}set max(t){t=this._fromType(t),this._scaler.max=t}get type(){return this._oscillator.type}set type(t){this._oscillator.type=t,this._stoppedValue=this._oscillator.getInitialValue(),this._stoppedSignal.value=this._stoppedValue}get phase(){return this._oscillator.phase}set phase(t){this._oscillator.phase=t,this._stoppedValue=this._oscillator.getInitialValue(),this._stoppedSignal.value=this._stoppedValue}get units(){return this._units}set units(t){const e=this.min,n=this.max;this._units=t,this.min=e,this.max=n}get state(){return this._oscillator.state}connect(t,e,n){return(t instanceof Ct||t instanceof Ft)&&(this.convert=t.convert,this.units=t.units),Vt(this,t,e,n),this}dispose(){return super.dispose(),this._oscillator.dispose(),this._stoppedSignal.dispose(),this._zeros.dispose(),this._scaler.dispose(),this._a2g.dispose(),this._amplitudeGain.dispose(),this.amplitude.dispose(),this}}function Ce(t,e=1/0){const n=new WeakMap;return function(i,r){Reflect.defineProperty(i,r,{configurable:!0,enumerable:!0,get:function(){return n.get(this)},set:function(i){a(i,t,e),n.set(this,i)}})}}function Re(t,e=1/0){const n=new WeakMap;return function(i,r){Reflect.defineProperty(i,r,{configurable:!0,enumerable:!0,get:function(){return n.get(this)},set:function(i){a(this.toSeconds(i),t,e),n.set(this,i)}})}}class Ee extends se{constructor(){super(F(Ee.getDefaults(),arguments,["url","onload"])),this.name="Player",this._activeSources=new Set;const t=F(Ee.getDefaults(),arguments,["url","onload"]);this._buffer=new rt({onload:this._onload.bind(this,t.onload),onerror:t.onerror,reverse:t.reverse,url:t.url}),this.autostart=t.autostart,this._loop=t.loop,this._loopStart=t.loopStart,this._loopEnd=t.loopEnd,this._playbackRate=t.playbackRate,this.fadeIn=t.fadeIn,this.fadeOut=t.fadeOut}static getDefaults(){return Object.assign(se.getDefaults(),{autostart:!1,fadeIn:0,fadeOut:0,loop:!1,loopEnd:0,loopStart:0,onload:it,onerror:it,playbackRate:1,reverse:!1})}load(t){return D(this,void 0,void 0,(function*(){return yield this._buffer.load(t),this._onload(),this}))}_onload(t=it){t(),this.autostart&&this.start()}_onSourceEnd(t){this.onstop(this),this._activeSources.delete(t),0!==this._activeSources.size||this._synced||"started"!==this._state.getValueAtTime(this.now())||(this._state.cancel(this.now()),this._state.setStateAtTime("stopped",this.now()))}start(t,e,n){return super.start(t,e,n),this}_start(t,e,n){e=this._loop?V(e,this._loopStart):V(e,0);const i=this.toSeconds(e),r=n;n=V(n,Math.max(this._buffer.duration-i,0));let s=this.toSeconds(n);s/=this._playbackRate,t=this.toSeconds(t);const o=new oe({url:this._buffer,context:this.context,fadeIn:this.fadeIn,fadeOut:this.fadeOut,loop:this._loop,loopEnd:this._loopEnd,loopStart:this._loopStart,onended:this._onSourceEnd.bind(this),playbackRate:this._playbackRate}).connect(this.output);this._loop||this._synced||(this._state.cancel(t+s),this._state.setStateAtTime("stopped",t+s,{implicitEnd:!0})),this._activeSources.add(o),this._loop&&p(r)?o.start(t,i):o.start(t,i,s-this.toSeconds(this.fadeOut))}_stop(t){const e=this.toSeconds(t);this._activeSources.forEach(t=>t.stop(e))}restart(t,e,n){return super.restart(t,e,n),this}_restart(t,e,n){this._stop(t),this._start(t,e,n)}seek(t,e){const n=this.toSeconds(e);if("started"===this._state.getValueAtTime(n)){const e=this.toSeconds(t);this._stop(n),this._start(n,e)}return this}setLoopPoints(t,e){return this.loopStart=t,this.loopEnd=e,this}get loopStart(){return this._loopStart}set loopStart(t){this._loopStart=t,this.buffer.loaded&&a(this.toSeconds(t),0,this.buffer.duration),this._activeSources.forEach(e=>{e.loopStart=t})}get loopEnd(){return this._loopEnd}set loopEnd(t){this._loopEnd=t,this.buffer.loaded&&a(this.toSeconds(t),0,this.buffer.duration),this._activeSources.forEach(e=>{e.loopEnd=t})}get buffer(){return this._buffer}set buffer(t){this._buffer.set(t)}get loop(){return this._loop}set loop(t){if(this._loop!==t&&(this._loop=t,this._activeSources.forEach(e=>{e.loop=t}),t)){const t=this._state.getNextState("stopped",this.now());t&&this._state.cancel(t.time)}}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t;const e=this.now(),n=this._state.getNextState("stopped",e);n&&n.implicitEnd&&(this._state.cancel(n.time),this._activeSources.forEach(t=>t.cancelStop())),this._activeSources.forEach(n=>{n.playbackRate.setValueAtTime(t,e)})}get reverse(){return this._buffer.reverse}set reverse(t){this._buffer.reverse=t}get loaded(){return this._buffer.loaded}dispose(){return super.dispose(),this._activeSources.forEach(t=>t.dispose()),this._activeSources.clear(),this._buffer.dispose(),this}}A([Re(0)],Ee.prototype,"fadeIn",void 0),A([Re(0)],Ee.prototype,"fadeOut",void 0);class je extends Rt{constructor(){super(F(je.getDefaults(),arguments,["urls","onload"],"urls")),this.name="Players",this.input=void 0,this._players=new Map;const t=F(je.getDefaults(),arguments,["urls","onload"],"urls");this._volume=this.output=new Kt({context:this.context,volume:t.volume}),this.volume=this._volume.volume,et(this,"volume"),this._buffers=new Ut({urls:t.urls,onload:t.onload,baseUrl:t.baseUrl,onerror:t.onerror}),this.mute=t.mute,this._fadeIn=t.fadeIn,this._fadeOut=t.fadeOut}static getDefaults(){return Object.assign(se.getDefaults(),{baseUrl:"",fadeIn:0,fadeOut:0,mute:!1,onload:it,onerror:it,urls:{},volume:0})}get mute(){return this._volume.mute}set mute(t){this._volume.mute=t}get fadeIn(){return this._fadeIn}set fadeIn(t){this._fadeIn=t,this._players.forEach(e=>{e.fadeIn=t})}get fadeOut(){return this._fadeOut}set fadeOut(t){this._fadeOut=t,this._players.forEach(e=>{e.fadeOut=t})}get state(){return Array.from(this._players).some(([t,e])=>"started"===e.state)?"started":"stopped"}has(t){return this._buffers.has(t)}player(t){if(o(this.has(t),`No Player with the name ${t} exists on this object`),!this._players.has(t)){const e=new Ee({context:this.context,fadeIn:this._fadeIn,fadeOut:this._fadeOut,url:this._buffers.get(t)}).connect(this.output);this._players.set(t,e)}return this._players.get(t)}get loaded(){return this._buffers.loaded}add(t,e,n){return o(!this._buffers.has(t),"A buffer with that name already exists on this object"),this._buffers.add(t,e,n),this}stopAll(t){return this._players.forEach(e=>e.stop(t)),this}dispose(){return super.dispose(),this._volume.dispose(),this.volume.dispose(),this._players.forEach(t=>t.dispose()),this._buffers.dispose(),this}}class Me extends se{constructor(){super(F(Me.getDefaults(),arguments,["url","onload"])),this.name="GrainPlayer",this._loopStart=0,this._loopEnd=0,this._activeSources=[];const t=F(Me.getDefaults(),arguments,["url","onload"]);this.buffer=new rt({onload:t.onload,onerror:t.onerror,reverse:t.reverse,url:t.url}),this._clock=new Bt({context:this.context,callback:this._tick.bind(this),frequency:1/t.grainSize}),this._playbackRate=t.playbackRate,this._grainSize=t.grainSize,this._overlap=t.overlap,this.detune=t.detune,this.overlap=t.overlap,this.loop=t.loop,this.playbackRate=t.playbackRate,this.grainSize=t.grainSize,this.loopStart=t.loopStart,this.loopEnd=t.loopEnd,this.reverse=t.reverse,this._clock.on("stop",this._onstop.bind(this))}static getDefaults(){return Object.assign(se.getDefaults(),{onload:it,onerror:it,overlap:.1,grainSize:.2,playbackRate:1,detune:0,loop:!1,loopStart:0,loopEnd:0,reverse:!1})}_start(t,e,n){e=V(e,0),e=this.toSeconds(e),t=this.toSeconds(t);const i=1/this._clock.frequency.getValueAtTime(t);this._clock.start(t,e/i),n&&this.stop(t+this.toSeconds(n))}restart(t,e,n){return super.restart(t,e,n),this}_restart(t,e,n){this._stop(t),this._start(t,e,n)}_stop(t){this._clock.stop(t)}_onstop(t){this._activeSources.forEach(e=>{e.fadeOut=0,e.stop(t)}),this.onstop(this)}_tick(t){const e=this._clock.getTicksAtTime(t),n=e*this._grainSize;if(this.log("offset",n),!this.loop&&n>this.buffer.duration)return void this.stop(t);const i=n<this._overlap?0:this._overlap,r=new oe({context:this.context,url:this.buffer,fadeIn:i,fadeOut:this._overlap,loop:this.loop,loopStart:this._loopStart,loopEnd:this._loopEnd,playbackRate:pt(this.detune/100)}).connect(this.output);r.start(t,this._grainSize*e),r.stop(t+this._grainSize/this.playbackRate),this._activeSources.push(r),r.onended=()=>{const t=this._activeSources.indexOf(r);-1!==t&&this._activeSources.splice(t,1)}}get playbackRate(){return this._playbackRate}set playbackRate(t){a(t,.001),this._playbackRate=t,this.grainSize=this._grainSize}get loopStart(){return this._loopStart}set loopStart(t){this.buffer.loaded&&a(this.toSeconds(t),0,this.buffer.duration),this._loopStart=this.toSeconds(t)}get loopEnd(){return this._loopEnd}set loopEnd(t){this.buffer.loaded&&a(this.toSeconds(t),0,this.buffer.duration),this._loopEnd=this.toSeconds(t)}get reverse(){return this.buffer.reverse}set reverse(t){this.buffer.reverse=t}get grainSize(){return this._grainSize}set grainSize(t){this._grainSize=this.toSeconds(t),this._clock.frequency.setValueAtTime(this._playbackRate/this._grainSize,this.now())}get overlap(){return this._overlap}set overlap(t){const e=this.toSeconds(t);a(e,0),this._overlap=e}get loaded(){return this.buffer.loaded}dispose(){return super.dispose(),this.buffer.dispose(),this._clock.dispose(),this._activeSources.forEach(t=>t.dispose()),this}}class Pe extends de{constructor(){super(...arguments),this.name="Abs",this._abs=new me({context:this.context,mapping:t=>Math.abs(t)<.001?0:Math.abs(t)}),this.input=this._abs,this.output=this._abs}dispose(){return super.dispose(),this._abs.dispose(),this}}class qe extends de{constructor(){super(...arguments),this.name="GainToAudio",this._norm=new me({context:this.context,mapping:t=>2*Math.abs(t)-1}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class Ie extends de{constructor(){super(...arguments),this.name="Negate",this._multiply=new ge({context:this.context,value:-1}),this.input=this._multiply,this.output=this._multiply}dispose(){return super.dispose(),this._multiply.dispose(),this}}class Fe extends Ft{constructor(){super(Object.assign(F(Fe.getDefaults(),arguments,["value"]))),this.override=!1,this.name="Subtract",this._sum=new Pt({context:this.context}),this.input=this._sum,this.output=this._sum,this._neg=new Ie({context:this.context}),this.subtrahend=this._param,Et(this._constantSource,this._neg,this._sum)}static getDefaults(){return Object.assign(Ft.getDefaults(),{value:0})}dispose(){return super.dispose(),this._neg.dispose(),this._sum.dispose(),this}}class Ve extends de{constructor(){super(Object.assign(F(Ve.getDefaults(),arguments))),this.name="GreaterThanZero",this._thresh=this.output=new me({context:this.context,length:127,mapping:t=>t<=0?0:1}),this._scale=this.input=new ge({context:this.context,value:1e4}),this._scale.connect(this._thresh)}dispose(){return super.dispose(),this._scale.dispose(),this._thresh.dispose(),this}}class Ne extends Ft{constructor(){super(Object.assign(F(Ne.getDefaults(),arguments,["value"]))),this.name="GreaterThan",this.override=!1;const t=F(Ne.getDefaults(),arguments,["value"]);this._subtract=this.input=new Fe({context:this.context,value:t.value}),this._gtz=this.output=new Ve({context:this.context}),this.comparator=this._param=this._subtract.subtrahend,et(this,"comparator"),this._subtract.connect(this._gtz)}static getDefaults(){return Object.assign(Ft.getDefaults(),{value:0})}dispose(){return super.dispose(),this._gtz.dispose(),this._subtract.dispose(),this.comparator.dispose(),this}}class Le extends de{constructor(){super(Object.assign(F(Le.getDefaults(),arguments,["value"]))),this.name="Pow";const t=F(Le.getDefaults(),arguments,["value"]);this._exponentScaler=this.input=this.output=new me({context:this.context,mapping:this._expFunc(t.value),length:8192}),this._exponent=t.value}static getDefaults(){return Object.assign(de.getDefaults(),{value:1})}_expFunc(t){return e=>Math.pow(Math.abs(e),t)}get value(){return this._exponent}set value(t){this._exponent=t,this._exponentScaler.setMap(this._expFunc(this._exponent))}dispose(){return super.dispose(),this._exponentScaler.dispose(),this}}class ze extends Te{constructor(){super(Object.assign(F(ze.getDefaults(),arguments,["min","max","exponent"]))),this.name="ScaleExp";const t=F(ze.getDefaults(),arguments,["min","max","exponent"]);this.input=this._exp=new Le({context:this.context,value:t.exponent}),this._exp.connect(this._mult)}static getDefaults(){return Object.assign(Te.getDefaults(),{exponent:1})}get exponent(){return this._exp.value}set exponent(t){this._exp.value=t}dispose(){return super.dispose(),this._exp.dispose(),this}}class Be extends Ft{constructor(){super(F(Ft.getDefaults(),arguments,["value","units"])),this.name="SyncedSignal",this.override=!1;const t=F(Ft.getDefaults(),arguments,["value","units"]);this._lastVal=t.value,this._synced=this.context.transport.scheduleRepeat(this._onTick.bind(this),"1i"),this._syncedCallback=this._anchorValue.bind(this),this.context.transport.on("start",this._syncedCallback),this.context.transport.on("pause",this._syncedCallback),this.context.transport.on("stop",this._syncedCallback),this._constantSource.disconnect(),this._constantSource.stop(0),this._constantSource=this.output=new It({context:this.context,offset:t.value,units:t.units}).start(0),this.setValueAtTime(t.value,0)}_onTick(t){const e=super.getValueAtTime(this.context.transport.seconds);this._lastVal!==e&&(this._lastVal=e,this._constantSource.offset.setValueAtTime(e,t))}_anchorValue(t){const e=super.getValueAtTime(this.context.transport.seconds);this._lastVal=e,this._constantSource.offset.cancelAndHoldAtTime(t),this._constantSource.offset.setValueAtTime(e,t)}getValueAtTime(t){const e=new St(this.context,t).toSeconds();return super.getValueAtTime(e)}setValueAtTime(t,e){const n=new St(this.context,e).toSeconds();return super.setValueAtTime(t,n),this}linearRampToValueAtTime(t,e){const n=new St(this.context,e).toSeconds();return super.linearRampToValueAtTime(t,n),this}exponentialRampToValueAtTime(t,e){const n=new St(this.context,e).toSeconds();return super.exponentialRampToValueAtTime(t,n),this}setTargetAtTime(t,e,n){const i=new St(this.context,e).toSeconds();return super.setTargetAtTime(t,i,n),this}cancelScheduledValues(t){const e=new St(this.context,t).toSeconds();return super.cancelScheduledValues(e),this}setValueCurveAtTime(t,e,n,i){const r=new St(this.context,e).toSeconds();return n=this.toSeconds(n),super.setValueCurveAtTime(t,r,n,i),this}cancelAndHoldAtTime(t){const e=new St(this.context,t).toSeconds();return super.cancelAndHoldAtTime(e),this}setRampPoint(t){const e=new St(this.context,t).toSeconds();return super.setRampPoint(e),this}exponentialRampTo(t,e,n){const i=new St(this.context,n).toSeconds();return super.exponentialRampTo(t,e,i),this}linearRampTo(t,e,n){const i=new St(this.context,n).toSeconds();return super.linearRampTo(t,e,i),this}targetRampTo(t,e,n){const i=new St(this.context,n).toSeconds();return super.targetRampTo(t,e,i),this}dispose(){return super.dispose(),this.context.transport.clear(this._synced),this.context.transport.off("start",this._syncedCallback),this.context.transport.off("pause",this._syncedCallback),this.context.transport.off("stop",this._syncedCallback),this._constantSource.dispose(),this}}class We extends Rt{constructor(){super(F(We.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="Envelope",this._sig=new Ft({context:this.context,value:0}),this.output=this._sig,this.input=void 0;const t=F(We.getDefaults(),arguments,["attack","decay","sustain","release"]);this.attack=t.attack,this.decay=t.decay,this.sustain=t.sustain,this.release=t.release,this.attackCurve=t.attackCurve,this.releaseCurve=t.releaseCurve,this.decayCurve=t.decayCurve}static getDefaults(){return Object.assign(Rt.getDefaults(),{attack:.01,attackCurve:"linear",decay:.1,decayCurve:"exponential",release:1,releaseCurve:"exponential",sustain:.5})}get value(){return this.getValueAtTime(this.now())}_getCurve(t,e){if(b(t))return t;{let n;for(n in Ge)if(Ge[n][e]===t)return n;return t}}_setCurve(t,e,n){if(b(n)&&Reflect.has(Ge,n)){const i=Ge[n];g(i)?"_decayCurve"!==t&&(this[t]=i[e]):this[t]=i}else{if(!y(n)||"_decayCurve"===t)throw new Error("Envelope: invalid curve: "+n);this[t]=n}}get attackCurve(){return this._getCurve(this._attackCurve,"In")}set attackCurve(t){this._setCurve("_attackCurve","In",t)}get releaseCurve(){return this._getCurve(this._releaseCurve,"Out")}set releaseCurve(t){this._setCurve("_releaseCurve","Out",t)}get decayCurve(){return this._decayCurve}set decayCurve(t){o(["linear","exponential"].some(e=>e===t),"Invalid envelope curve: "+t),this._decayCurve=t}triggerAttack(t,e=1){this.log("triggerAttack",t,e),t=this.toSeconds(t);let n=this.toSeconds(this.attack);const i=this.toSeconds(this.decay),r=this.getValueAtTime(t);if(r>0){n=(1-r)/(1/n)}if(n<this.sampleTime)this._sig.cancelScheduledValues(t),this._sig.setValueAtTime(e,t);else if("linear"===this._attackCurve)this._sig.linearRampTo(e,n,t);else if("exponential"===this._attackCurve)this._sig.targetRampTo(e,n,t);else{this._sig.cancelAndHoldAtTime(t);let i=this._attackCurve;for(let t=1;t<i.length;t++)if(i[t-1]<=r&&r<=i[t]){i=this._attackCurve.slice(t),i[0]=r;break}this._sig.setValueCurveAtTime(i,t,n,e)}if(i&&this.sustain<1){const r=e*this.sustain,s=t+n;this.log("decay",s),"linear"===this._decayCurve?this._sig.linearRampToValueAtTime(r,i+s):this._sig.exponentialApproachValueAtTime(r,s,i)}return this}triggerRelease(t){this.log("triggerRelease",t),t=this.toSeconds(t);const e=this.getValueAtTime(t);if(e>0){const n=this.toSeconds(this.release);n<this.sampleTime?this._sig.setValueAtTime(0,t):"linear"===this._releaseCurve?this._sig.linearRampTo(0,n,t):"exponential"===this._releaseCurve?this._sig.targetRampTo(0,n,t):(o(y(this._releaseCurve),"releaseCurve must be either 'linear', 'exponential' or an array"),this._sig.cancelAndHoldAtTime(t),this._sig.setValueCurveAtTime(this._releaseCurve,t,n,e))}return this}getValueAtTime(t){return this._sig.getValueAtTime(t)}triggerAttackRelease(t,e,n=1){return e=this.toSeconds(e),this.triggerAttack(e,n),this.triggerRelease(e+this.toSeconds(t)),this}cancel(t){return this._sig.cancelScheduledValues(this.toSeconds(t)),this}connect(t,e=0,n=0){return Vt(this,t,e,n),this}asArray(t=1024){return D(this,void 0,void 0,(function*(){const e=t/this.context.sampleRate,n=new st(1,e,this.context.sampleRate),i=this.toSeconds(this.attack)+this.toSeconds(this.decay),r=i+this.toSeconds(this.release),s=.1*r,o=r+s,a=new this.constructor(Object.assign(this.get(),{attack:e*this.toSeconds(this.attack)/o,decay:e*this.toSeconds(this.decay)/o,release:e*this.toSeconds(this.release)/o,context:n}));a._sig.toDestination(),a.triggerAttackRelease(e*(i+s)/o,0);return(yield n.render()).getChannelData(0)}))}dispose(){return super.dispose(),this._sig.dispose(),this}}A([Re(0)],We.prototype,"attack",void 0),A([Re(0)],We.prototype,"decay",void 0),A([Ce(0,1)],We.prototype,"sustain",void 0),A([Re(0)],We.prototype,"release",void 0);const Ge=(()=>{let t,e;const n=[];for(t=0;t<128;t++)n[t]=Math.sin(t/127*(Math.PI/2));const i=[];for(t=0;t<127;t++){e=t/127;const n=Math.sin(e*(2*Math.PI)*6.4-Math.PI/2)+1;i[t]=n/10+.83*e}i[127]=1;const r=[];for(t=0;t<128;t++)r[t]=Math.ceil(t/127*5)/5;const s=[];for(t=0;t<128;t++)e=t/127,s[t]=.5*(1-Math.cos(Math.PI*e));const o=[];for(t=0;t<128;t++){e=t/127;const n=4*Math.pow(e,3)+.2,i=Math.cos(n*Math.PI*2*e);o[t]=Math.abs(i*(1-e))}function a(t){const e=new Array(t.length);for(let n=0;n<t.length;n++)e[n]=1-t[n];return e}return{bounce:{In:a(o),Out:o},cosine:{In:n,Out:(u=n,u.slice(0).reverse())},exponential:"exponential",linear:"linear",ripple:{In:i,Out:a(i)},sine:{In:s,Out:a(s)},step:{In:r,Out:a(r)}};var u})();class Ue extends Rt{constructor(){super(F(Ue.getDefaults(),arguments)),this._scheduledEvents=[],this._synced=!1,this._original_triggerAttack=this.triggerAttack,this._original_triggerRelease=this.triggerRelease;const t=F(Ue.getDefaults(),arguments);this._volume=this.output=new Kt({context:this.context,volume:t.volume}),this.volume=this._volume.volume,et(this,"volume")}static getDefaults(){return Object.assign(Rt.getDefaults(),{volume:0})}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",0)),this}_syncState(){let t=!1;return this._synced||(this._synced=!0,t=!0),t}_syncMethod(t,e){const n=this["_original_"+t]=this[t];this[t]=(...t)=>{const i=t[e],r=this.context.transport.schedule(i=>{t[e]=i,n.apply(this,t)},i);this._scheduledEvents.push(r)}}unsync(){return this._scheduledEvents.forEach(t=>this.context.transport.clear(t)),this._scheduledEvents=[],this._synced&&(this._synced=!1,this.triggerAttack=this._original_triggerAttack,this.triggerRelease=this._original_triggerRelease),this}triggerAttackRelease(t,e,n,i){const r=this.toSeconds(n),s=this.toSeconds(e);return this.triggerAttack(t,r,i),this.triggerRelease(r+s),this}dispose(){return super.dispose(),this._volume.dispose(),this.unsync(),this._scheduledEvents=[],this}}class Ye extends Ue{constructor(){super(F(Ye.getDefaults(),arguments));const t=F(Ye.getDefaults(),arguments);this.portamento=t.portamento,this.onsilence=t.onsilence}static getDefaults(){return Object.assign(Ue.getDefaults(),{detune:0,onsilence:it,portamento:0})}triggerAttack(t,e,n=1){this.log("triggerAttack",t,e,n);const i=this.toSeconds(e);return this._triggerEnvelopeAttack(i,n),this.setNote(t,i),this}triggerRelease(t){this.log("triggerRelease",t);const e=this.toSeconds(t);return this._triggerEnvelopeRelease(e),this}setNote(t,e){const n=this.toSeconds(e),i=t instanceof xt?t.toFrequency():t;if(this.portamento>0&&this.getLevelAtTime(n)>.05){const t=this.toSeconds(this.portamento);this.frequency.exponentialRampTo(i,t,n)}else this.frequency.setValueAtTime(i,n);return this}}A([Re(0)],Ye.prototype,"portamento",void 0);class Ze extends We{constructor(){super(F(Ze.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="AmplitudeEnvelope",this._gainNode=new Pt({context:this.context,gain:0}),this.output=this._gainNode,this.input=this._gainNode,this._sig.connect(this._gainNode.gain),this.output=this._gainNode,this.input=this._gainNode}dispose(){return super.dispose(),this._gainNode.dispose(),this}}class Xe extends Ye{constructor(){super(F(Xe.getDefaults(),arguments)),this.name="Synth";const t=F(Xe.getDefaults(),arguments);this.oscillator=new ke(Object.assign({context:this.context,detune:t.detune,onstop:()=>this.onsilence(this)},t.oscillator)),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.envelope=new Ze(Object.assign({context:this.context},t.envelope)),this.oscillator.chain(this.envelope,this.output),et(this,["oscillator","frequency","detune","envelope"])}static getDefaults(){return Object.assign(Ye.getDefaults(),{envelope:Object.assign(N(We.getDefaults(),Object.keys(Rt.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.3}),oscillator:Object.assign(N(ke.getDefaults(),[...Object.keys(se.getDefaults()),"frequency","detune"]),{type:"triangle"})})}_triggerEnvelopeAttack(t,e){if(this.envelope.triggerAttack(t,e),this.oscillator.start(t),0===this.envelope.sustain){const e=this.toSeconds(this.envelope.attack),n=this.toSeconds(this.envelope.decay);this.oscillator.stop(t+e+n)}}_triggerEnvelopeRelease(t){this.envelope.triggerRelease(t),this.oscillator.stop(t+this.toSeconds(this.envelope.release))}getLevelAtTime(t){return t=this.toSeconds(t),this.envelope.getValueAtTime(t)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this}}class Qe extends Ye{constructor(){super(F(Qe.getDefaults(),arguments)),this.name="ModulationSynth";const t=F(Qe.getDefaults(),arguments);this._carrier=new Xe({context:this.context,oscillator:t.oscillator,envelope:t.envelope,onsilence:()=>this.onsilence(this),volume:-10}),this._modulator=new Xe({context:this.context,oscillator:t.modulation,envelope:t.modulationEnvelope,volume:-10}),this.oscillator=this._carrier.oscillator,this.envelope=this._carrier.envelope,this.modulation=this._modulator.oscillator,this.modulationEnvelope=this._modulator.envelope,this.frequency=new Ft({context:this.context,units:"frequency"}),this.detune=new Ft({context:this.context,value:t.detune,units:"cents"}),this.harmonicity=new ge({context:this.context,value:t.harmonicity,minValue:0}),this._modulationNode=new Pt({context:this.context,gain:0}),et(this,["frequency","harmonicity","oscillator","envelope","modulation","modulationEnvelope","detune"])}static getDefaults(){return Object.assign(Ye.getDefaults(),{harmonicity:3,oscillator:Object.assign(N(ke.getDefaults(),[...Object.keys(se.getDefaults()),"frequency","detune"]),{type:"sine"}),envelope:Object.assign(N(We.getDefaults(),Object.keys(Rt.getDefaults())),{attack:.01,decay:.01,sustain:1,release:.5}),modulation:Object.assign(N(ke.getDefaults(),[...Object.keys(se.getDefaults()),"frequency","detune"]),{type:"square"}),modulationEnvelope:Object.assign(N(We.getDefaults(),Object.keys(Rt.getDefaults())),{attack:.5,decay:0,sustain:1,release:.5})})}_triggerEnvelopeAttack(t,e){this._carrier._triggerEnvelopeAttack(t,e),this._modulator._triggerEnvelopeAttack(t,e)}_triggerEnvelopeRelease(t){return this._carrier._triggerEnvelopeRelease(t),this._modulator._triggerEnvelopeRelease(t),this}getLevelAtTime(t){return t=this.toSeconds(t),this.envelope.getValueAtTime(t)}dispose(){return super.dispose(),this._carrier.dispose(),this._modulator.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._modulationNode.dispose(),this}}class He extends Qe{constructor(){super(F(He.getDefaults(),arguments)),this.name="AMSynth",this._modulationScale=new _e({context:this.context}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.detune.fan(this._carrier.detune,this._modulator.detune),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output)}dispose(){return super.dispose(),this._modulationScale.dispose(),this}}class $e extends Rt{constructor(){super(F($e.getDefaults(),arguments,["frequency","type"])),this.name="BiquadFilter";const t=F($e.getDefaults(),arguments,["frequency","type"]);this._filter=this.context.createBiquadFilter(),this.input=this.output=this._filter,this.Q=new Ct({context:this.context,units:"number",value:t.Q,param:this._filter.Q}),this.frequency=new Ct({context:this.context,units:"frequency",value:t.frequency,param:this._filter.frequency}),this.detune=new Ct({context:this.context,units:"cents",value:t.detune,param:this._filter.detune}),this.gain=new Ct({context:this.context,units:"gain",value:t.gain,param:this._filter.gain}),this.type=t.type}static getDefaults(){return Object.assign(Rt.getDefaults(),{Q:1,type:"lowpass",frequency:350,detune:0,gain:0})}get type(){return this._filter.type}set type(t){o(-1!==["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"].indexOf(t),"Invalid filter type: "+t),this._filter.type=t}getFrequencyResponse(t=128){const e=new Float32Array(t);for(let n=0;n<t;n++){const i=19980*Math.pow(n/t,2)+20;e[n]=i}const n=new Float32Array(t),i=new Float32Array(t),r=this.context.createBiquadFilter();return r.type=this.type,r.Q.value=this.Q.value,r.frequency.value=this.frequency.value,r.gain.value=this.gain.value,r.getFrequencyResponse(e,n,i),n}dispose(){return super.dispose(),this._filter.disconnect(),this.Q.dispose(),this.frequency.dispose(),this.gain.dispose(),this.detune.dispose(),this}}class Je extends Rt{constructor(){super(F(Je.getDefaults(),arguments,["frequency","type","rolloff"])),this.name="Filter",this.input=new Pt({context:this.context}),this.output=new Pt({context:this.context}),this._filters=[];const t=F(Je.getDefaults(),arguments,["frequency","type","rolloff"]);this._filters=[],this.Q=new Ft({context:this.context,units:"positive",value:t.Q}),this.frequency=new Ft({context:this.context,units:"frequency",value:t.frequency}),this.detune=new Ft({context:this.context,units:"cents",value:t.detune}),this.gain=new Ft({context:this.context,units:"decibels",value:t.gain}),this._type=t.type,this.rolloff=t.rolloff,et(this,["detune","frequency","gain","Q"])}static getDefaults(){return Object.assign(Rt.getDefaults(),{Q:1,detune:0,frequency:350,gain:0,rolloff:-12,type:"lowpass"})}get type(){return this._type}set type(t){o(-1!==["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"].indexOf(t),"Invalid filter type: "+t),this._type=t,this._filters.forEach(e=>e.type=t)}get rolloff(){return this._rolloff}set rolloff(t){const e=_(t)?t:parseInt(t,10),n=[-12,-24,-48,-96];let i=n.indexOf(e);o(-1!==i,"rolloff can only be "+n.join(", ")),i+=1,this._rolloff=e,this.input.disconnect(),this._filters.forEach(t=>t.disconnect()),this._filters=new Array(i);for(let t=0;t<i;t++){const e=new $e({context:this.context});e.type=this._type,this.frequency.connect(e.frequency),this.detune.connect(e.detune),this.Q.connect(e.Q),this.gain.connect(e.gain),this._filters[t]=e}this._internalChannels=this._filters,Et(this.input,...this._internalChannels,this.output)}getFrequencyResponse(t=128){const e=new $e({frequency:this.frequency.value,gain:this.gain.value,Q:this.Q.value,type:this._type,detune:this.detune.value}),n=new Float32Array(t).map(()=>1);return this._filters.forEach(()=>{e.getFrequencyResponse(t).forEach((t,e)=>n[e]*=t)}),e.dispose(),n}dispose(){return super.dispose(),this._filters.forEach(t=>{t.dispose()}),nt(this,["detune","frequency","gain","Q"]),this.frequency.dispose(),this.Q.dispose(),this.detune.dispose(),this.gain.dispose(),this}}class Ke extends We{constructor(){super(F(Ke.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="FrequencyEnvelope";const t=F(Ke.getDefaults(),arguments,["attack","decay","sustain","release"]);this._octaves=t.octaves,this._baseFrequency=this.toFrequency(t.baseFrequency),this._exponent=this.input=new Le({context:this.context,value:t.exponent}),this._scale=this.output=new Te({context:this.context,min:this._baseFrequency,max:this._baseFrequency*Math.pow(2,this._octaves)}),this._sig.chain(this._exponent,this._scale)}static getDefaults(){return Object.assign(We.getDefaults(),{baseFrequency:200,exponent:1,octaves:4})}get baseFrequency(){return this._baseFrequency}set baseFrequency(t){const e=this.toFrequency(t);a(e,0),this._baseFrequency=e,this._scale.min=this._baseFrequency,this.octaves=this._octaves}get octaves(){return this._octaves}set octaves(t){this._octaves=t,this._scale.max=this._baseFrequency*Math.pow(2,t)}get exponent(){return this._exponent.value}set exponent(t){this._exponent.value=t}dispose(){return super.dispose(),this._exponent.dispose(),this._scale.dispose(),this}}class tn extends Ye{constructor(){super(F(tn.getDefaults(),arguments)),this.name="MonoSynth";const t=F(tn.getDefaults(),arguments);this.oscillator=new ke(Object.assign(t.oscillator,{context:this.context,detune:t.detune,onstop:()=>this.onsilence(this)})),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.filter=new Je(Object.assign(t.filter,{context:this.context})),this.filterEnvelope=new Ke(Object.assign(t.filterEnvelope,{context:this.context})),this.envelope=new Ze(Object.assign(t.envelope,{context:this.context})),this.oscillator.chain(this.filter,this.envelope,this.output),this.filterEnvelope.connect(this.filter.frequency),et(this,["oscillator","frequency","detune","filter","filterEnvelope","envelope"])}static getDefaults(){return Object.assign(Ye.getDefaults(),{envelope:Object.assign(N(We.getDefaults(),Object.keys(Rt.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.9}),filter:Object.assign(N(Je.getDefaults(),Object.keys(Rt.getDefaults())),{Q:1,rolloff:-12,type:"lowpass"}),filterEnvelope:Object.assign(N(Ke.getDefaults(),Object.keys(Rt.getDefaults())),{attack:.6,baseFrequency:200,decay:.2,exponent:2,octaves:3,release:2,sustain:.5}),oscillator:Object.assign(N(ke.getDefaults(),Object.keys(se.getDefaults())),{type:"sawtooth"})})}_triggerEnvelopeAttack(t,e=1){if(this.envelope.triggerAttack(t,e),this.filterEnvelope.triggerAttack(t),this.oscillator.start(t),0===this.envelope.sustain){const e=this.toSeconds(this.envelope.attack),n=this.toSeconds(this.envelope.decay);this.oscillator.stop(t+e+n)}}_triggerEnvelopeRelease(t){this.envelope.triggerRelease(t),this.filterEnvelope.triggerRelease(t),this.oscillator.stop(t+this.toSeconds(this.envelope.release))}getLevelAtTime(t){return t=this.toSeconds(t),this.envelope.getValueAtTime(t)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this.filterEnvelope.dispose(),this.filter.dispose(),this}}class en extends Ye{constructor(){super(F(en.getDefaults(),arguments)),this.name="DuoSynth";const t=F(en.getDefaults(),arguments);this.voice0=new tn(Object.assign(t.voice0,{context:this.context,onsilence:()=>this.onsilence(this)})),this.voice1=new tn(Object.assign(t.voice1,{context:this.context})),this.harmonicity=new ge({context:this.context,units:"positive",value:t.harmonicity}),this._vibrato=new De({frequency:t.vibratoRate,context:this.context,min:-50,max:50}),this._vibrato.start(),this.vibratoRate=this._vibrato.frequency,this._vibratoGain=new Pt({context:this.context,units:"normalRange",gain:t.vibratoAmount}),this.vibratoAmount=this._vibratoGain.gain,this.frequency=new Ft({context:this.context,units:"frequency",value:440}),this.detune=new Ft({context:this.context,units:"cents",value:t.detune}),this.frequency.connect(this.voice0.frequency),this.frequency.chain(this.harmonicity,this.voice1.frequency),this._vibrato.connect(this._vibratoGain),this._vibratoGain.fan(this.voice0.detune,this.voice1.detune),this.detune.fan(this.voice0.detune,this.voice1.detune),this.voice0.connect(this.output),this.voice1.connect(this.output),et(this,["voice0","voice1","frequency","vibratoAmount","vibratoRate"])}getLevelAtTime(t){return t=this.toSeconds(t),this.voice0.envelope.getValueAtTime(t)+this.voice1.envelope.getValueAtTime(t)}static getDefaults(){return I(Ye.getDefaults(),{vibratoAmount:.5,vibratoRate:5,harmonicity:1.5,voice0:I(N(tn.getDefaults(),Object.keys(Ye.getDefaults())),{filterEnvelope:{attack:.01,decay:0,sustain:1,release:.5},envelope:{attack:.01,decay:0,sustain:1,release:.5}}),voice1:I(N(tn.getDefaults(),Object.keys(Ye.getDefaults())),{filterEnvelope:{attack:.01,decay:0,sustain:1,release:.5},envelope:{attack:.01,decay:0,sustain:1,release:.5}})})}_triggerEnvelopeAttack(t,e){this.voice0._triggerEnvelopeAttack(t,e),this.voice1._triggerEnvelopeAttack(t,e)}_triggerEnvelopeRelease(t){return this.voice0._triggerEnvelopeRelease(t),this.voice1._triggerEnvelopeRelease(t),this}dispose(){return super.dispose(),this.voice0.dispose(),this.voice1.dispose(),this.frequency.dispose(),this.detune.dispose(),this._vibrato.dispose(),this.vibratoRate.dispose(),this._vibratoGain.dispose(),this.harmonicity.dispose(),this}}class nn extends Qe{constructor(){super(F(nn.getDefaults(),arguments)),this.name="FMSynth";const t=F(nn.getDefaults(),arguments);this.modulationIndex=new ge({context:this.context,value:t.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this.detune.fan(this._carrier.detune,this._modulator.detune),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output)}static getDefaults(){return Object.assign(Qe.getDefaults(),{modulationIndex:10})}dispose(){return super.dispose(),this.modulationIndex.dispose(),this}}const rn=[1,1.483,1.932,2.546,2.63,3.897];class sn extends Ye{constructor(){super(F(sn.getDefaults(),arguments)),this.name="MetalSynth",this._oscillators=[],this._freqMultipliers=[];const t=F(sn.getDefaults(),arguments);this.detune=new Ft({context:this.context,units:"cents",value:t.detune}),this.frequency=new Ft({context:this.context,units:"frequency"}),this._amplitude=new Pt({context:this.context,gain:0}).connect(this.output),this._highpass=new Je({Q:0,context:this.context,type:"highpass"}).connect(this._amplitude);for(let e=0;e<rn.length;e++){const n=new ye({context:this.context,harmonicity:t.harmonicity,modulationIndex:t.modulationIndex,modulationType:"square",onstop:0===e?()=>this.onsilence(this):it,type:"square"});n.connect(this._highpass),this._oscillators[e]=n;const i=new ge({context:this.context,value:rn[e]});this._freqMultipliers[e]=i,this.frequency.chain(i,n.frequency),this.detune.connect(n.detune)}this._filterFreqScaler=new Te({context:this.context,max:7e3,min:this.toFrequency(t.resonance)}),this.envelope=new We({attack:t.envelope.attack,attackCurve:"linear",context:this.context,decay:t.envelope.decay,release:t.envelope.release,sustain:0}),this.envelope.chain(this._filterFreqScaler,this._highpass.frequency),this.envelope.connect(this._amplitude.gain),this._octaves=t.octaves,this.octaves=t.octaves}static getDefaults(){return I(Ye.getDefaults(),{envelope:Object.assign(N(We.getDefaults(),Object.keys(Rt.getDefaults())),{attack:.001,decay:1.4,release:.2}),harmonicity:5.1,modulationIndex:32,octaves:1.5,resonance:4e3})}_triggerEnvelopeAttack(t,e=1){return this.envelope.triggerAttack(t,e),this._oscillators.forEach(e=>e.start(t)),0===this.envelope.sustain&&this._oscillators.forEach(e=>{e.stop(t+this.toSeconds(this.envelope.attack)+this.toSeconds(this.envelope.decay))}),this}_triggerEnvelopeRelease(t){return this.envelope.triggerRelease(t),this._oscillators.forEach(e=>e.stop(t+this.toSeconds(this.envelope.release))),this}getLevelAtTime(t){return t=this.toSeconds(t),this.envelope.getValueAtTime(t)}get modulationIndex(){return this._oscillators[0].modulationIndex.value}set modulationIndex(t){this._oscillators.forEach(e=>e.modulationIndex.value=t)}get harmonicity(){return this._oscillators[0].harmonicity.value}set harmonicity(t){this._oscillators.forEach(e=>e.harmonicity.value=t)}get resonance(){return this._filterFreqScaler.min}set resonance(t){this._filterFreqScaler.min=this.toFrequency(t),this.octaves=this._octaves}get octaves(){return this._octaves}set octaves(t){this._octaves=t,this._filterFreqScaler.max=this._filterFreqScaler.min*Math.pow(2,t)}dispose(){return super.dispose(),this._oscillators.forEach(t=>t.dispose()),this._freqMultipliers.forEach(t=>t.dispose()),this.frequency.dispose(),this.detune.dispose(),this._filterFreqScaler.dispose(),this._amplitude.dispose(),this.envelope.dispose(),this._highpass.dispose(),this}}class on extends Xe{constructor(){super(F(on.getDefaults(),arguments)),this.name="MembraneSynth",this.portamento=0;const t=F(on.getDefaults(),arguments);this.pitchDecay=t.pitchDecay,this.octaves=t.octaves,et(this,["oscillator","envelope"])}static getDefaults(){return I(Ye.getDefaults(),Xe.getDefaults(),{envelope:{attack:.001,attackCurve:"exponential",decay:.4,release:1.4,sustain:.01},octaves:10,oscillator:{type:"sine"},pitchDecay:.05})}setNote(t,e){const n=this.toSeconds(e),i=this.toFrequency(t instanceof xt?t.toFrequency():t),r=i*this.octaves;return this.oscillator.frequency.setValueAtTime(r,n),this.oscillator.frequency.exponentialRampToValueAtTime(i,n+this.toSeconds(this.pitchDecay)),this}dispose(){return super.dispose(),this}}A([Ce(0)],on.prototype,"octaves",void 0),A([Re(0)],on.prototype,"pitchDecay",void 0);class an extends Ue{constructor(){super(F(an.getDefaults(),arguments)),this.name="NoiseSynth";const t=F(an.getDefaults(),arguments);this.noise=new ae(Object.assign({context:this.context},t.noise)),this.envelope=new Ze(Object.assign({context:this.context},t.envelope)),this.noise.chain(this.envelope,this.output)}static getDefaults(){return Object.assign(Ue.getDefaults(),{envelope:Object.assign(N(We.getDefaults(),Object.keys(Rt.getDefaults())),{decay:.1,sustain:0}),noise:Object.assign(N(ae.getDefaults(),Object.keys(se.getDefaults())),{type:"white"})})}triggerAttack(t,e=1){return t=this.toSeconds(t),this.envelope.triggerAttack(t,e),this.noise.start(t),0===this.envelope.sustain&&this.noise.stop(t+this.toSeconds(this.envelope.attack)+this.toSeconds(this.envelope.decay)),this}triggerRelease(t){return t=this.toSeconds(t),this.envelope.triggerRelease(t),this.noise.stop(t+this.toSeconds(this.envelope.release)),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",0),this._syncMethod("triggerRelease",0)),this}triggerAttackRelease(t,e,n=1){return e=this.toSeconds(e),t=this.toSeconds(t),this.triggerAttack(e,n),this.triggerRelease(e+t),this}dispose(){return super.dispose(),this.noise.dispose(),this.envelope.dispose(),this}}const un=new Set;function cn(t){un.add(t)}function ln(t,e){const n=`registerProcessor("${t}", ${e})`;un.add(n)}class hn extends Rt{constructor(t){super(t),this.name="ToneAudioWorklet",this.workletOptions={},this.onprocessorerror=it;const e=URL.createObjectURL(new Blob([Array.from(un).join("\n")],{type:"text/javascript"})),n=this._audioWorkletName();this._dummyGain=this.context.createGain(),this._dummyParam=this._dummyGain.gain;this.context.addAudioWorkletModule(e,n).then(()=>{this.disposed||(this._worklet=this.context.createAudioWorkletNode(n,this.workletOptions),this._worklet.onprocessorerror=this.onprocessorerror.bind(this),this.onReady(this._worklet))}).catch(t=>{console.error(t)})}dispose(){return super.dispose(),this._dummyGain.disconnect(),this._worklet&&(this._worklet.port.postMessage("dispose"),this._worklet.disconnect()),this}}cn('\n\t/**\n\t * The base AudioWorkletProcessor for use in Tone.js. Works with the [[ToneAudioWorklet]]. \n\t */\n\tclass ToneAudioWorkletProcessor extends AudioWorkletProcessor {\n\n\t\tconstructor(options) {\n\t\t\t\n\t\t\tsuper(options);\n\t\t\t/**\n\t\t\t * If the processor was disposed or not. Keep alive until it\'s disposed.\n\t\t\t */\n\t\t\tthis.disposed = false;\n\t\t   \t/** \n\t\t\t * The number of samples in the processing block\n\t\t\t */\n\t\t\tthis.blockSize = 128;\n\t\t\t/**\n\t\t\t * the sample rate\n\t\t\t */\n\t\t\tthis.sampleRate = sampleRate;\n\n\t\t\tthis.port.onmessage = (event) => {\n\t\t\t\t// when it receives a dispose \n\t\t\t\tif (event.data === "dispose") {\n\t\t\t\t\tthis.disposed = true;\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t}\n');cn("\n\t/**\n\t * Abstract class for a single input/output processor. \n\t * has a 'generate' function which processes one sample at a time\n\t */\n\tclass SingleIOProcessor extends ToneAudioWorkletProcessor {\n\n\t\tconstructor(options) {\n\t\t\tsuper(Object.assign(options, {\n\t\t\t\tnumberOfInputs: 1,\n\t\t\t\tnumberOfOutputs: 1\n\t\t\t}));\n\t\t\t/**\n\t\t\t * Holds the name of the parameter and a single value of that\n\t\t\t * parameter at the current sample\n\t\t\t * @type { [name: string]: number }\n\t\t\t */\n\t\t\tthis.params = {}\n\t\t}\n\n\t\t/**\n\t\t * Generate an output sample from the input sample and parameters\n\t\t * @abstract\n\t\t * @param input number\n\t\t * @param channel number\n\t\t * @param parameters { [name: string]: number }\n\t\t * @returns number\n\t\t */\n\t\tgenerate(){}\n\n\t\t/**\n\t\t * Update the private params object with the \n\t\t * values of the parameters at the given index\n\t\t * @param parameters { [name: string]: Float32Array },\n\t\t * @param index number\n\t\t */\n\t\tupdateParams(parameters, index) {\n\t\t\tfor (const paramName in parameters) {\n\t\t\t\tconst param = parameters[paramName];\n\t\t\t\tif (param.length > 1) {\n\t\t\t\t\tthis.params[paramName] = parameters[paramName][index];\n\t\t\t\t} else {\n\t\t\t\t\tthis.params[paramName] = parameters[paramName][0];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Process a single frame of the audio\n\t\t * @param inputs Float32Array[][]\n\t\t * @param outputs Float32Array[][]\n\t\t */\n\t\tprocess(inputs, outputs, parameters) {\n\t\t\tconst input = inputs[0];\n\t\t\tconst output = outputs[0];\n\t\t\t// get the parameter values\n\t\t\tconst channelCount = Math.max(input && input.length || 0, output.length);\n\t\t\tfor (let sample = 0; sample < this.blockSize; sample++) {\n\t\t\t\tthis.updateParams(parameters, sample);\n\t\t\t\tfor (let channel = 0; channel < channelCount; channel++) {\n\t\t\t\t\tconst inputSample = input && input.length ? input[channel][sample] : 0;\n\t\t\t\t\toutput[channel][sample] = this.generate(inputSample, channel, this.params);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn !this.disposed;\n\t\t}\n\t};\n");cn("\n\t/**\n\t * A multichannel buffer for use within an AudioWorkletProcessor as a delay line\n\t */\n\tclass DelayLine {\n\t\t\n\t\tconstructor(size, channels) {\n\t\t\tthis.buffer = [];\n\t\t\tthis.writeHead = []\n\t\t\tthis.size = size;\n\n\t\t\t// create the empty channels\n\t\t\tfor (let i = 0; i < channels; i++) {\n\t\t\t\tthis.buffer[i] = new Float32Array(this.size);\n\t\t\t\tthis.writeHead[i] = 0;\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Push a value onto the end\n\t\t * @param channel number\n\t\t * @param value number\n\t\t */\n\t\tpush(channel, value) {\n\t\t\tthis.writeHead[channel] += 1;\n\t\t\tif (this.writeHead[channel] > this.size) {\n\t\t\t\tthis.writeHead[channel] = 0;\n\t\t\t}\n\t\t\tthis.buffer[channel][this.writeHead[channel]] = value;\n\t\t}\n\n\t\t/**\n\t\t * Get the recorded value of the channel given the delay\n\t\t * @param channel number\n\t\t * @param delay number delay samples\n\t\t */\n\t\tget(channel, delay) {\n\t\t\tlet readHead = this.writeHead[channel] - Math.floor(delay);\n\t\t\tif (readHead < 0) {\n\t\t\t\treadHead += this.size;\n\t\t\t}\n\t\t\treturn this.buffer[channel][readHead];\n\t\t}\n\t}\n");ln("feedback-comb-filter",'\n\tclass FeedbackCombFilterWorklet extends SingleIOProcessor {\n\n\t\tconstructor(options) {\n\t\t\tsuper(options);\n\t\t\tthis.delayLine = new DelayLine(this.sampleRate, options.channelCount || 2);\n\t\t}\n\n\t\tstatic get parameterDescriptors() {\n\t\t\treturn [{\n\t\t\t\tname: "delayTime",\n\t\t\t\tdefaultValue: 0.1,\n\t\t\t\tminValue: 0,\n\t\t\t\tmaxValue: 1,\n\t\t\t\tautomationRate: "k-rate"\n\t\t\t}, {\n\t\t\t\tname: "feedback",\n\t\t\t\tdefaultValue: 0.5,\n\t\t\t\tminValue: 0,\n\t\t\t\tmaxValue: 0.9999,\n\t\t\t\tautomationRate: "k-rate"\n\t\t\t}];\n\t\t}\n\n\t\tgenerate(input, channel, parameters) {\n\t\t\tconst delayedSample = this.delayLine.get(channel, parameters.delayTime * this.sampleRate);\n\t\t\tthis.delayLine.push(channel, input + delayedSample * parameters.feedback);\n\t\t\treturn delayedSample;\n\t\t}\n\t}\n');class fn extends hn{constructor(){super(F(fn.getDefaults(),arguments,["delayTime","resonance"])),this.name="FeedbackCombFilter";const t=F(fn.getDefaults(),arguments,["delayTime","resonance"]);this.input=new Pt({context:this.context}),this.output=new Pt({context:this.context}),this.delayTime=new Ct({context:this.context,value:t.delayTime,units:"time",minValue:0,maxValue:1,param:this._dummyParam,swappable:!0}),this.resonance=new Ct({context:this.context,value:t.resonance,units:"normalRange",param:this._dummyParam,swappable:!0}),et(this,["resonance","delayTime"])}_audioWorkletName(){return"feedback-comb-filter"}static getDefaults(){return Object.assign(Rt.getDefaults(),{delayTime:.1,resonance:.5})}onReady(t){Et(this.input,t,this.output);const e=t.parameters.get("delayTime");this.delayTime.setParam(e);const n=t.parameters.get("feedback");this.resonance.setParam(n)}dispose(){return super.dispose(),this.input.dispose(),this.output.dispose(),this.delayTime.dispose(),this.resonance.dispose(),this}}class pn extends Rt{constructor(){super(F(pn.getDefaults(),arguments,["frequency","type"])),this.name="OnePoleFilter";const t=F(pn.getDefaults(),arguments,["frequency","type"]);this._frequency=t.frequency,this._type=t.type,this.input=new Pt({context:this.context}),this.output=new Pt({context:this.context}),this._createFilter()}static getDefaults(){return Object.assign(Rt.getDefaults(),{frequency:880,type:"lowpass"})}_createFilter(){const t=this._filter,e=this.toFrequency(this._frequency),n=1/(2*Math.PI*e);if("lowpass"===this._type){const t=1/(n*this.context.sampleRate),e=t-1;this._filter=this.context.createIIRFilter([t,0],[1,e])}else{const t=1/(n*this.context.sampleRate)-1;this._filter=this.context.createIIRFilter([1,-1],[1,t])}this.input.chain(this._filter,this.output),t&&this.context.setTimeout(()=>{this.disposed||(this.input.disconnect(t),t.disconnect())},this.blockTime)}get frequency(){return this._frequency}set frequency(t){this._frequency=t,this._createFilter()}get type(){return this._type}set type(t){this._type=t,this._createFilter()}getFrequencyResponse(t=128){const e=new Float32Array(t);for(let n=0;n<t;n++){const i=19980*Math.pow(n/t,2)+20;e[n]=i}const n=new Float32Array(t),i=new Float32Array(t);return this._filter.getFrequencyResponse(e,n,i),n}dispose(){return super.dispose(),this.input.dispose(),this.output.dispose(),this._filter.disconnect(),this}}class dn extends Rt{constructor(){super(F(dn.getDefaults(),arguments,["delayTime","resonance","dampening"])),this.name="LowpassCombFilter";const t=F(dn.getDefaults(),arguments,["delayTime","resonance","dampening"]);this._combFilter=this.output=new fn({context:this.context,delayTime:t.delayTime,resonance:t.resonance}),this.delayTime=this._combFilter.delayTime,this.resonance=this._combFilter.resonance,this._lowpass=this.input=new pn({context:this.context,frequency:t.dampening,type:"lowpass"}),this._lowpass.connect(this._combFilter)}static getDefaults(){return Object.assign(Rt.getDefaults(),{dampening:3e3,delayTime:.1,resonance:.5})}get dampening(){return this._lowpass.frequency}set dampening(t){this._lowpass.frequency=t}dispose(){return super.dispose(),this._combFilter.dispose(),this._lowpass.dispose(),this}}class mn extends Ue{constructor(){super(F(mn.getDefaults(),arguments)),this.name="PluckSynth";const t=F(mn.getDefaults(),arguments);this._noise=new ae({context:this.context,type:"pink"}),this.attackNoise=t.attackNoise,this._lfcf=new dn({context:this.context,dampening:t.dampening,resonance:t.resonance}),this.resonance=t.resonance,this.release=t.release,this._noise.connect(this._lfcf),this._lfcf.connect(this.output)}static getDefaults(){return I(Ue.getDefaults(),{attackNoise:1,dampening:4e3,resonance:.7,release:1})}get dampening(){return this._lfcf.dampening}set dampening(t){this._lfcf.dampening=t}triggerAttack(t,e){const n=this.toFrequency(t);e=this.toSeconds(e);const i=1/n;return this._lfcf.delayTime.setValueAtTime(i,e),this._noise.start(e),this._noise.stop(e+i*this.attackNoise),this._lfcf.resonance.cancelScheduledValues(e),this._lfcf.resonance.setValueAtTime(this.resonance,e),this}triggerRelease(t){return this._lfcf.resonance.linearRampTo(0,this.release,t),this}dispose(){return super.dispose(),this._noise.dispose(),this._lfcf.dispose(),this}}class _n extends Ue{constructor(){super(F(_n.getDefaults(),arguments,["voice","options"])),this.name="PolySynth",this._availableVoices=[],this._activeVoices=[],this._voices=[],this._gcTimeout=-1,this._averageActiveVoices=0;const t=F(_n.getDefaults(),arguments,["voice","options"]);o(!_(t.voice),"DEPRECATED: The polyphony count is no longer the first argument.");const e=t.voice.getDefaults();this.options=Object.assign(e,t.options),this.voice=t.voice,this.maxPolyphony=t.maxPolyphony,this._dummyVoice=this._getNextAvailableVoice();const n=this._voices.indexOf(this._dummyVoice);this._voices.splice(n,1),this._gcTimeout=this.context.setInterval(this._collectGarbage.bind(this),1)}static getDefaults(){return Object.assign(Ue.getDefaults(),{maxPolyphony:32,options:{},voice:Xe})}get activeVoices(){return this._activeVoices.length}_makeVoiceAvailable(t){this._availableVoices.push(t);const e=this._activeVoices.findIndex(e=>e.voice===t);this._activeVoices.splice(e,1)}_getNextAvailableVoice(){if(this._availableVoices.length)return this._availableVoices.shift();if(this._voices.length<this.maxPolyphony){const t=new this.voice(Object.assign(this.options,{context:this.context,onsilence:this._makeVoiceAvailable.bind(this)}));return t.connect(this.output),this._voices.push(t),t}f("Max polyphony exceeded. Note dropped.")}_collectGarbage(){if(this._averageActiveVoices=Math.max(.95*this._averageActiveVoices,this.activeVoices),this._availableVoices.length&&this._voices.length>Math.ceil(this._averageActiveVoices+1)){const t=this._availableVoices.shift(),e=this._voices.indexOf(t);this._voices.splice(e,1),this.context.isOffline||t.dispose()}}_triggerAttack(t,e,n){t.forEach(t=>{const i=new Yt(this.context,t).toMidi(),r=this._getNextAvailableVoice();r&&(r.triggerAttack(t,e,n),this._activeVoices.push({midi:i,voice:r,released:!1}),this.log("triggerAttack",t,e))})}_triggerRelease(t,e){t.forEach(t=>{const n=new Yt(this.context,t).toMidi(),i=this._activeVoices.find(({midi:t,released:e})=>t===n&&!e);i&&(i.voice.triggerRelease(e),i.released=!0,this.log("triggerRelease",t,e))})}_scheduleEvent(t,e,n,i){o(!this.disposed,"Synth was already disposed"),n<=this.now()?"attack"===t?this._triggerAttack(e,n,i):this._triggerRelease(e,n):this.context.setTimeout(()=>{this._scheduleEvent(t,e,n,i)},n-this.now())}triggerAttack(t,e,n){Array.isArray(t)||(t=[t]);const i=this.toSeconds(e);return this._scheduleEvent("attack",t,i,n),this}triggerRelease(t,e){Array.isArray(t)||(t=[t]);const n=this.toSeconds(e);return this._scheduleEvent("release",t,n),this}triggerAttackRelease(t,e,n,i){const r=this.toSeconds(n);if(this.triggerAttack(t,r,i),y(e)){o(y(t),"If the duration is an array, the notes must also be an array"),t=t;for(let n=0;n<t.length;n++){const i=e[Math.min(n,e.length-1)],s=this.toSeconds(i);o(s>0,"The duration must be greater than 0"),this.triggerRelease(t[n],r+s)}}else{const n=this.toSeconds(e);o(n>0,"The duration must be greater than 0"),this.triggerRelease(t,r+n)}return this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}set(t){const e=N(t,["onsilence","context"]);return this.options=I(this.options,e),this._voices.forEach(t=>t.set(e)),this._dummyVoice.set(e),this}get(){return this._dummyVoice.get()}releaseAll(t){const e=this.toSeconds(t);return this._activeVoices.forEach(({voice:t})=>{t.triggerRelease(e)}),this}dispose(){return super.dispose(),this._dummyVoice.dispose(),this._voices.forEach(t=>t.dispose()),this._activeVoices=[],this._availableVoices=[],this.context.clearInterval(this._gcTimeout),this}}class gn extends Ue{constructor(){super(F(gn.getDefaults(),arguments,["urls","onload","baseUrl"],"urls")),this.name="Sampler",this._activeSources=new Map;const t=F(gn.getDefaults(),arguments,["urls","onload","baseUrl"],"urls"),e={};Object.keys(t.urls).forEach(n=>{const i=parseInt(n,10);if(o(x(n)||_(i)&&isFinite(i),"url key is neither a note or midi pitch: "+n),x(n)){const i=new xt(this.context,n).toMidi();e[i]=t.urls[n]}else _(i)&&isFinite(i)&&(e[i]=t.urls[i])}),this._buffers=new Ut({urls:e,onload:t.onload,baseUrl:t.baseUrl,onerror:t.onerror}),this.attack=t.attack,this.release=t.release,this.curve=t.curve,this._buffers.loaded&&Promise.resolve().then(t.onload)}static getDefaults(){return Object.assign(Ue.getDefaults(),{attack:0,baseUrl:"",curve:"exponential",onload:it,onerror:it,release:.1,urls:{}})}_findClosest(t){let e=0;for(;e<96;){if(this._buffers.has(t+e))return-e;if(this._buffers.has(t-e))return e;e++}throw new Error("No available buffers for note: "+t)}triggerAttack(t,e,n=1){return this.log("triggerAttack",t,e,n),Array.isArray(t)||(t=[t]),t.forEach(t=>{const i=_t(new xt(this.context,t).toFrequency()),r=Math.round(i),s=i-r,o=this._findClosest(r),a=r-o,u=this._buffers.get(a),c=pt(o+s),l=new oe({url:u,context:this.context,curve:this.curve,fadeIn:this.attack,fadeOut:this.release,playbackRate:c}).connect(this.output);l.start(e,0,u.duration/c,n),y(this._activeSources.get(r))||this._activeSources.set(r,[]),this._activeSources.get(r).push(l),l.onended=()=>{if(this._activeSources&&this._activeSources.has(r)){const t=this._activeSources.get(r),e=t.indexOf(l);-1!==e&&t.splice(e,1)}}}),this}triggerRelease(t,e){return this.log("triggerRelease",t,e),Array.isArray(t)||(t=[t]),t.forEach(t=>{const n=new xt(this.context,t).toMidi();if(this._activeSources.has(n)&&this._activeSources.get(n).length){const t=this._activeSources.get(n);e=this.toSeconds(e),t.forEach(t=>{t.stop(e)}),this._activeSources.set(n,[])}}),this}releaseAll(t){const e=this.toSeconds(t);return this._activeSources.forEach(t=>{for(;t.length;){t.shift().stop(e)}}),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}triggerAttackRelease(t,e,n,i=1){const r=this.toSeconds(n);return this.triggerAttack(t,r,i),y(e)?(o(y(t),"notes must be an array when duration is array"),t.forEach((t,n)=>{const i=e[Math.min(n,e.length-1)];this.triggerRelease(t,r+this.toSeconds(i))})):this.triggerRelease(t,r+this.toSeconds(e)),this}add(t,e,n){if(o(x(t)||isFinite(t),"note must be a pitch or midi: "+t),x(t)){const i=new xt(this.context,t).toMidi();this._buffers.add(i,e,n)}else this._buffers.add(t,e,n);return this}get loaded(){return this._buffers.loaded}dispose(){return super.dispose(),this._buffers.dispose(),this._activeSources.forEach(t=>{t.forEach(t=>t.dispose())}),this._activeSources.clear(),this}}A([Re(0)],gn.prototype,"attack",void 0),A([Re(0)],gn.prototype,"release",void 0);class vn extends At{constructor(){super(F(vn.getDefaults(),arguments,["callback","value"])),this.name="ToneEvent",this._state=new Dt("stopped"),this._startOffset=0;const t=F(vn.getDefaults(),arguments,["callback","value"]);this._loop=t.loop,this.callback=t.callback,this.value=t.value,this._loopStart=this.toTicks(t.loopStart),this._loopEnd=this.toTicks(t.loopEnd),this._playbackRate=t.playbackRate,this._probability=t.probability,this._humanize=t.humanize,this.mute=t.mute,this._playbackRate=t.playbackRate,this._state.increasing=!0,this._rescheduleEvents()}static getDefaults(){return Object.assign(At.getDefaults(),{callback:it,humanize:!1,loop:!1,loopEnd:"1m",loopStart:0,mute:!1,playbackRate:1,probability:1,value:null})}_rescheduleEvents(t=-1){this._state.forEachFrom(t,t=>{let e;if("started"===t.state){-1!==t.id&&this.context.transport.clear(t.id);const n=t.time+Math.round(this.startOffset/this._playbackRate);if(!0===this._loop||_(this._loop)&&this._loop>1){e=1/0,_(this._loop)&&(e=this._loop*this._getLoopDuration());const i=this._state.getAfter(n);null!==i&&(e=Math.min(e,i.time-n)),e!==1/0&&(this._state.setStateAtTime("stopped",n+e+1,{id:-1}),e=new Xt(this.context,e));const r=new Xt(this.context,this._getLoopDuration());t.id=this.context.transport.scheduleRepeat(this._tick.bind(this),r,new Xt(this.context,n),e)}else t.id=this.context.transport.schedule(this._tick.bind(this),new Xt(this.context,n))}})}get state(){return this._state.getValueAtTime(this.context.transport.ticks)}get startOffset(){return this._startOffset}set startOffset(t){this._startOffset=t}get probability(){return this._probability}set probability(t){this._probability=t}get humanize(){return this._humanize}set humanize(t){this._humanize=t}start(t){const e=this.toTicks(t);return"stopped"===this._state.getValueAtTime(e)&&(this._state.add({id:-1,state:"started",time:e}),this._rescheduleEvents(e)),this}stop(t){this.cancel(t);const e=this.toTicks(t);if("started"===this._state.getValueAtTime(e)){this._state.setStateAtTime("stopped",e,{id:-1});const t=this._state.getBefore(e);let n=e;null!==t&&(n=t.time),this._rescheduleEvents(n)}return this}cancel(t){t=V(t,-1/0);const e=this.toTicks(t);return this._state.forEachFrom(e,t=>{this.context.transport.clear(t.id)}),this._state.cancel(e),this}_tick(t){const e=this.context.transport.getTicksAtTime(t);if(!this.mute&&"started"===this._state.getValueAtTime(e)){if(this.probability<1&&Math.random()>this.probability)return;if(this.humanize){let e=.02;v(this.humanize)||(e=this.toSeconds(this.humanize)),t+=(2*Math.random()-1)*e}this.callback(t,this.value)}}_getLoopDuration(){return Math.round((this._loopEnd-this._loopStart)/this._playbackRate)}get loop(){return this._loop}set loop(t){this._loop=t,this._rescheduleEvents()}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t,this._rescheduleEvents()}get loopEnd(){return new Xt(this.context,this._loopEnd).toSeconds()}set loopEnd(t){this._loopEnd=this.toTicks(t),this._loop&&this._rescheduleEvents()}get loopStart(){return new Xt(this.context,this._loopStart).toSeconds()}set loopStart(t){this._loopStart=this.toTicks(t),this._loop&&this._rescheduleEvents()}get progress(){if(this._loop){const t=this.context.transport.ticks,e=this._state.get(t);if(null!==e&&"started"===e.state){const n=this._getLoopDuration();return(t-e.time)%n/n}return 0}return 0}dispose(){return super.dispose(),this.cancel(),this._state.dispose(),this}}class yn extends At{constructor(){super(F(yn.getDefaults(),arguments,["callback","interval"])),this.name="Loop";const t=F(yn.getDefaults(),arguments,["callback","interval"]);this._event=new vn({context:this.context,callback:this._tick.bind(this),loop:!0,loopEnd:t.interval,playbackRate:t.playbackRate,probability:t.probability}),this.callback=t.callback,this.iterations=t.iterations}static getDefaults(){return Object.assign(At.getDefaults(),{interval:"4n",callback:it,playbackRate:1,iterations:1/0,probability:1,mute:!1,humanize:!1})}start(t){return this._event.start(t),this}stop(t){return this._event.stop(t),this}cancel(t){return this._event.cancel(t),this}_tick(t){this.callback(t)}get state(){return this._event.state}get progress(){return this._event.progress}get interval(){return this._event.loopEnd}set interval(t){this._event.loopEnd=t}get playbackRate(){return this._event.playbackRate}set playbackRate(t){this._event.playbackRate=t}get humanize(){return this._event.humanize}set humanize(t){this._event.humanize=t}get probability(){return this._event.probability}set probability(t){this._event.probability=t}get mute(){return this._event.mute}set mute(t){this._event.mute=t}get iterations(){return!0===this._event.loop?1/0:this._event.loop}set iterations(t){this._event.loop=t===1/0||t}dispose(){return super.dispose(),this._event.dispose(),this}}class bn extends vn{constructor(){super(F(bn.getDefaults(),arguments,["callback","events"])),this.name="Part",this._state=new Dt("stopped"),this._events=new Set;const t=F(bn.getDefaults(),arguments,["callback","events"]);this._state.increasing=!0,t.events.forEach(t=>{y(t)?this.add(t[0],t[1]):this.add(t)})}static getDefaults(){return Object.assign(vn.getDefaults(),{events:[]})}start(t,e){const n=this.toTicks(t);if("started"!==this._state.getValueAtTime(n)){e=V(e,this._loop?this._loopStart:0),e=this._loop?V(e,this._loopStart):V(e,0);const t=this.toTicks(e);this._state.add({id:-1,offset:t,state:"started",time:n}),this._forEach(e=>{this._startNote(e,n,t)})}return this}_startNote(t,e,n){e-=n,this._loop?t.startOffset>=this._loopStart&&t.startOffset<this._loopEnd?(t.startOffset<n&&(e+=this._getLoopDuration()),t.start(new Xt(this.context,e))):t.startOffset<this._loopStart&&t.startOffset>=n&&(t.loop=!1,t.start(new Xt(this.context,e))):t.startOffset>=n&&t.start(new Xt(this.context,e))}get startOffset(){return this._startOffset}set startOffset(t){this._startOffset=t,this._forEach(t=>{t.startOffset+=this._startOffset})}stop(t){const e=this.toTicks(t);return this._state.cancel(e),this._state.setStateAtTime("stopped",e),this._forEach(e=>{e.stop(t)}),this}at(t,e){const n=new St(this.context,t).toTicks(),i=new Xt(this.context,1).toSeconds(),r=this._events.values();let s=r.next();for(;!s.done;){const t=s.value;if(Math.abs(n-t.startOffset)<i)return d(e)&&(t.value=e),t;s=r.next()}return d(e)?(this.add(t,e),this.at(t)):null}add(t,e){t instanceof Object&&Reflect.has(t,"time")&&(t=(e=t).time);const n=this.toTicks(t);let i;return e instanceof vn?(i=e,i.callback=this._tick.bind(this)):i=new vn({callback:this._tick.bind(this),context:this.context,value:e}),i.startOffset=n,i.set({humanize:this.humanize,loop:this.loop,loopEnd:this.loopEnd,loopStart:this.loopStart,playbackRate:this.playbackRate,probability:this.probability}),this._events.add(i),this._restartEvent(i),this}_restartEvent(t){this._state.forEach(e=>{"started"===e.state?this._startNote(t,e.time,e.offset):t.stop(new Xt(this.context,e.time))})}remove(t,e){return g(t)&&t.hasOwnProperty("time")&&(t=(e=t).time),t=this.toTicks(t),this._events.forEach(n=>{n.startOffset===t&&(p(e)||d(e)&&n.value===e)&&(this._events.delete(n),n.dispose())}),this}clear(){return this._forEach(t=>t.dispose()),this._events.clear(),this}cancel(t){return this._forEach(e=>e.cancel(t)),this._state.cancel(this.toTicks(t)),this}_forEach(t){return this._events&&this._events.forEach(e=>{e instanceof bn?e._forEach(t):t(e)}),this}_setAll(t,e){this._forEach(n=>{n[t]=e})}_tick(t,e){this.mute||this.callback(t,e)}_testLoopBoundries(t){this._loop&&(t.startOffset<this._loopStart||t.startOffset>=this._loopEnd)?t.cancel(0):"stopped"===t.state&&this._restartEvent(t)}get probability(){return this._probability}set probability(t){this._probability=t,this._setAll("probability",t)}get humanize(){return this._humanize}set humanize(t){this._humanize=t,this._setAll("humanize",t)}get loop(){return this._loop}set loop(t){this._loop=t,this._forEach(e=>{e.loopStart=this.loopStart,e.loopEnd=this.loopEnd,e.loop=t,this._testLoopBoundries(e)})}get loopEnd(){return new Xt(this.context,this._loopEnd).toSeconds()}set loopEnd(t){this._loopEnd=this.toTicks(t),this._loop&&this._forEach(e=>{e.loopEnd=t,this._testLoopBoundries(e)})}get loopStart(){return new Xt(this.context,this._loopStart).toSeconds()}set loopStart(t){this._loopStart=this.toTicks(t),this._loop&&this._forEach(t=>{t.loopStart=this.loopStart,this._testLoopBoundries(t)})}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t,this._setAll("playbackRate",t)}get length(){return this._events.size}dispose(){return super.dispose(),this.clear(),this}}function*xn(t){let e=0;for(;e<t.length;)e=kn(e,t),yield t[e],e++}function*wn(t){let e=t.length-1;for(;e>=0;)e=kn(e,t),yield t[e],e--}function*On(t,e){for(;;)yield*e(t)}function kn(t,e){return Y(t,0,e.length-1)}function*Sn(t,e){let n=e?0:t.length-1;for(;;)n=kn(n,t),yield t[n],e?(n++,n>=t.length-1&&(e=!1)):(n--,n<=0&&(e=!0))}function*Tn(t){let e=0,n=0;for(;e<t.length;)e=kn(e,t),yield t[e],n++,e+=n%2?2:-1}function*An(t){let e=t.length-1,n=0;for(;e>=0;)e=kn(e,t),yield t[e],n++,e+=n%2?-2:1}function*Dn(t){const e=[];for(let n=0;n<t.length;n++)e.push(n);for(;e.length>0;){const n=kn(e.splice(Math.floor(e.length*Math.random()),1)[0],t);yield t[n]}}function*Cn(t,e="up",n=0){switch(o(t.length>0,"The array must have more than one value in it"),e){case"up":yield*On(t,xn);case"down":yield*On(t,wn);case"upDown":yield*Sn(t,!0);case"downUp":yield*Sn(t,!1);case"alternateUp":yield*On(t,Tn);case"alternateDown":yield*On(t,An);case"random":yield*function*(t){for(;;){const e=Math.floor(Math.random()*t.length);yield t[e]}}(t);case"randomOnce":yield*On(t,Dn);case"randomWalk":yield*function*(t){let e=Math.floor(Math.random()*t.length);for(;;)0===e?e++:e===t.length-1||Math.random()<.5?e--:e++,yield t[e]}(t)}}class Rn extends yn{constructor(){super(F(Rn.getDefaults(),arguments,["callback","values","pattern"])),this.name="Pattern";const t=F(Rn.getDefaults(),arguments,["callback","values","pattern"]);this.callback=t.callback,this._values=t.values,this._pattern=Cn(t.values,t.pattern),this._type=t.pattern}static getDefaults(){return Object.assign(yn.getDefaults(),{pattern:"up",values:[],callback:it})}_tick(t){const e=this._pattern.next();this._value=e.value,this.callback(t,this._value)}get values(){return this._values}set values(t){this._values=t,this.pattern=this._type}get value(){return this._value}get pattern(){return this._type}set pattern(t){this._type=t,this._pattern=Cn(this._values,this._type)}}class En extends vn{constructor(){super(F(En.getDefaults(),arguments,["callback","events","subdivision"])),this.name="Sequence",this._part=new bn({callback:this._seqCallback.bind(this),context:this.context}),this._events=[],this._eventsArray=[];const t=F(En.getDefaults(),arguments,["callback","events","subdivision"]);this._subdivision=this.toTicks(t.subdivision),this.events=t.events,this.loop=t.loop,this.loopStart=t.loopStart,this.loopEnd=t.loopEnd,this.playbackRate=t.playbackRate,this.probability=t.probability,this.humanize=t.humanize,this.mute=t.mute,this.playbackRate=t.playbackRate}static getDefaults(){return Object.assign(N(vn.getDefaults(),["value"]),{events:[],loop:!0,loopEnd:0,loopStart:0,subdivision:"8n"})}_seqCallback(t,e){null!==e&&this.callback(t,e)}get events(){return this._events}set events(t){this.clear(),this._eventsArray=t,this._events=this._createSequence(this._eventsArray),this._eventsUpdated()}start(t,e){return this._part.start(t,e?this._indexTime(e):e),this}stop(t){return this._part.stop(t),this}get subdivision(){return new Xt(this.context,this._subdivision).toSeconds()}_createSequence(t){return new Proxy(t,{get:(t,e)=>t[e],set:(t,e,n)=>(b(e)&&isFinite(parseInt(e,10))&&y(n)?t[e]=this._createSequence(n):t[e]=n,this._eventsUpdated(),!0)})}_eventsUpdated(){this._part.clear(),this._rescheduleSequence(this._eventsArray,this._subdivision,this.startOffset),this.loopEnd=this.loopEnd}_rescheduleSequence(t,e,n){t.forEach((t,i)=>{const r=i*e+n;if(y(t))this._rescheduleSequence(t,e/t.length,r);else{const e=new Xt(this.context,r,"i").toSeconds();this._part.add(e,t)}})}_indexTime(t){return new Xt(this.context,t*this._subdivision+this.startOffset).toSeconds()}clear(){return this._part.clear(),this}dispose(){return super.dispose(),this._part.dispose(),this}get loop(){return this._part.loop}set loop(t){this._part.loop=t}get loopStart(){return this._loopStart}set loopStart(t){this._loopStart=t,this._part.loopStart=this._indexTime(t)}get loopEnd(){return this._loopEnd}set loopEnd(t){this._loopEnd=t,this._part.loopEnd=0===t?this._indexTime(this._eventsArray.length):this._indexTime(t)}get startOffset(){return this._part.startOffset}set startOffset(t){this._part.startOffset=t}get playbackRate(){return this._part.playbackRate}set playbackRate(t){this._part.playbackRate=t}get probability(){return this._part.probability}set probability(t){this._part.probability=t}get progress(){return this._part.progress}get humanize(){return this._part.humanize}set humanize(t){this._part.humanize=t}get length(){return this._part.length}}class jn extends Rt{constructor(){super(Object.assign(F(jn.getDefaults(),arguments,["fade"]))),this.name="CrossFade",this._panner=this.context.createStereoPanner(),this._split=this.context.createChannelSplitter(2),this._g2a=new qe({context:this.context}),this.a=new Pt({context:this.context,gain:0}),this.b=new Pt({context:this.context,gain:0}),this.output=new Pt({context:this.context}),this._internalChannels=[this.a,this.b];const t=F(jn.getDefaults(),arguments,["fade"]);this.fade=new Ft({context:this.context,units:"normalRange",value:t.fade}),et(this,"fade"),this.context.getConstant(1).connect(this._panner),this._panner.connect(this._split),this._panner.channelCount=1,this._panner.channelCountMode="explicit",jt(this._split,this.a.gain,0),jt(this._split,this.b.gain,1),this.fade.chain(this._g2a,this._panner.pan),this.a.connect(this.output),this.b.connect(this.output)}static getDefaults(){return Object.assign(Rt.getDefaults(),{fade:.5})}dispose(){return super.dispose(),this.a.dispose(),this.b.dispose(),this.output.dispose(),this.fade.dispose(),this._g2a.dispose(),this._panner.disconnect(),this._split.disconnect(),this}}class Mn extends Rt{constructor(t){super(t),this.name="Effect",this._dryWet=new jn({context:this.context}),this.wet=this._dryWet.fade,this.effectSend=new Pt({context:this.context}),this.effectReturn=new Pt({context:this.context}),this.input=new Pt({context:this.context}),this.output=this._dryWet,this.input.fan(this._dryWet.a,this.effectSend),this.effectReturn.connect(this._dryWet.b),this.wet.setValueAtTime(t.wet,0),this._internalChannels=[this.effectReturn,this.effectSend],et(this,"wet")}static getDefaults(){return Object.assign(Rt.getDefaults(),{wet:1})}connectEffect(t){return this._internalChannels.push(t),this.effectSend.chain(t,this.effectReturn),this}dispose(){return super.dispose(),this._dryWet.dispose(),this.effectSend.dispose(),this.effectReturn.dispose(),this.wet.dispose(),this}}class Pn extends Mn{constructor(t){super(t),this.name="LFOEffect",this._lfo=new De({context:this.context,frequency:t.frequency,amplitude:t.depth}),this.depth=this._lfo.amplitude,this.frequency=this._lfo.frequency,this.type=t.type,et(this,["frequency","depth"])}static getDefaults(){return Object.assign(Mn.getDefaults(),{frequency:1,type:"sine",depth:1})}start(t){return this._lfo.start(t),this}stop(t){return this._lfo.stop(t),this}sync(){return this._lfo.sync(),this}unsync(){return this._lfo.unsync(),this}get type(){return this._lfo.type}set type(t){this._lfo.type=t}dispose(){return super.dispose(),this._lfo.dispose(),this.frequency.dispose(),this.depth.dispose(),this}}class qn extends Pn{constructor(){super(F(qn.getDefaults(),arguments,["frequency","baseFrequency","octaves"])),this.name="AutoFilter";const t=F(qn.getDefaults(),arguments,["frequency","baseFrequency","octaves"]);this.filter=new Je(Object.assign(t.filter,{context:this.context})),this.connectEffect(this.filter),this._lfo.connect(this.filter.frequency),this.octaves=t.octaves,this.baseFrequency=t.baseFrequency}static getDefaults(){return Object.assign(Pn.getDefaults(),{baseFrequency:200,octaves:2.6,filter:{type:"lowpass",rolloff:-12,Q:1}})}get baseFrequency(){return this._lfo.min}set baseFrequency(t){this._lfo.min=this.toFrequency(t),this.octaves=this._octaves}get octaves(){return this._octaves}set octaves(t){this._octaves=t,this._lfo.max=this._lfo.min*Math.pow(2,t)}dispose(){return super.dispose(),this.filter.dispose(),this}}class In extends Rt{constructor(){super(Object.assign(F(In.getDefaults(),arguments,["pan"]))),this.name="Panner",this._panner=this.context.createStereoPanner(),this.input=this._panner,this.output=this._panner;const t=F(In.getDefaults(),arguments,["pan"]);this.pan=new Ct({context:this.context,param:this._panner.pan,value:t.pan,minValue:-1,maxValue:1}),this._panner.channelCount=t.channelCount,this._panner.channelCountMode="explicit",et(this,"pan")}static getDefaults(){return Object.assign(Rt.getDefaults(),{pan:0,channelCount:1})}dispose(){return super.dispose(),this._panner.disconnect(),this.pan.dispose(),this}}class Fn extends Pn{constructor(){super(F(Fn.getDefaults(),arguments,["frequency"])),this.name="AutoPanner";const t=F(Fn.getDefaults(),arguments,["frequency"]);this._panner=new In({context:this.context,channelCount:t.channelCount}),this.connectEffect(this._panner),this._lfo.connect(this._panner.pan),this._lfo.min=-1,this._lfo.max=1}static getDefaults(){return Object.assign(Pn.getDefaults(),{channelCount:1})}dispose(){return super.dispose(),this._panner.dispose(),this}}class Vn extends Rt{constructor(){super(F(Vn.getDefaults(),arguments,["smoothing"])),this.name="Follower";const t=F(Vn.getDefaults(),arguments,["smoothing"]);this._abs=this.input=new Pe({context:this.context}),this._lowpass=this.output=new pn({context:this.context,frequency:1/this.toSeconds(t.smoothing),type:"lowpass"}),this._abs.connect(this._lowpass),this._smoothing=t.smoothing}static getDefaults(){return Object.assign(Rt.getDefaults(),{smoothing:.05})}get smoothing(){return this._smoothing}set smoothing(t){this._smoothing=t,this._lowpass.frequency=1/this.toSeconds(this.smoothing)}dispose(){return super.dispose(),this._abs.dispose(),this._lowpass.dispose(),this}}class Nn extends Mn{constructor(){super(F(Nn.getDefaults(),arguments,["baseFrequency","octaves","sensitivity"])),this.name="AutoWah";const t=F(Nn.getDefaults(),arguments,["baseFrequency","octaves","sensitivity"]);this._follower=new Vn({context:this.context,smoothing:t.follower}),this._sweepRange=new ze({context:this.context,min:0,max:1,exponent:.5}),this._baseFrequency=this.toFrequency(t.baseFrequency),this._octaves=t.octaves,this._inputBoost=new Pt({context:this.context}),this._bandpass=new Je({context:this.context,rolloff:-48,frequency:0,Q:t.Q}),this._peaking=new Je({context:this.context,type:"peaking"}),this._peaking.gain.value=t.gain,this.gain=this._peaking.gain,this.Q=this._bandpass.Q,this.effectSend.chain(this._inputBoost,this._follower,this._sweepRange),this._sweepRange.connect(this._bandpass.frequency),this._sweepRange.connect(this._peaking.frequency),this.effectSend.chain(this._bandpass,this._peaking,this.effectReturn),this._setSweepRange(),this.sensitivity=t.sensitivity,et(this,["gain","Q"])}static getDefaults(){return Object.assign(Mn.getDefaults(),{baseFrequency:100,octaves:6,sensitivity:0,Q:2,gain:2,follower:.2})}get octaves(){return this._octaves}set octaves(t){this._octaves=t,this._setSweepRange()}get follower(){return this._follower.smoothing}set follower(t){this._follower.smoothing=t}get baseFrequency(){return this._baseFrequency}set baseFrequency(t){this._baseFrequency=this.toFrequency(t),this._setSweepRange()}get sensitivity(){return ft(1/this._inputBoost.gain.value)}set sensitivity(t){this._inputBoost.gain.value=1/ht(t)}_setSweepRange(){this._sweepRange.min=this._baseFrequency,this._sweepRange.max=Math.min(this._baseFrequency*Math.pow(2,this._octaves),this.context.sampleRate/2)}dispose(){return super.dispose(),this._follower.dispose(),this._sweepRange.dispose(),this._bandpass.dispose(),this._peaking.dispose(),this._inputBoost.dispose(),this}}ln("bit-crusher","\n\tclass BitCrusherWorklet extends SingleIOProcessor {\n\n\t\tstatic get parameterDescriptors() {\n\t\t\treturn [{\n\t\t\t\tname: \"bits\",\n\t\t\t\tdefaultValue: 12,\n\t\t\t\tminValue: 1,\n\t\t\t\tmaxValue: 16,\n\t\t\t\tautomationRate: 'k-rate'\n\t\t\t}];\n\t\t}\n\n\t\tgenerate(input, _channel, parameters) {\n\t\t\tconst step = Math.pow(0.5, parameters.bits - 1);\n\t\t\tconst val = step * Math.floor(input / step + 0.5);\n\t\t\treturn val;\n\t\t}\n\t}\n");class Ln extends Mn{constructor(){super(F(Ln.getDefaults(),arguments,["bits"])),this.name="BitCrusher";const t=F(Ln.getDefaults(),arguments,["bits"]);this._bitCrusherWorklet=new zn({context:this.context,bits:t.bits}),this.connectEffect(this._bitCrusherWorklet),this.bits=this._bitCrusherWorklet.bits}static getDefaults(){return Object.assign(Mn.getDefaults(),{bits:4})}dispose(){return super.dispose(),this._bitCrusherWorklet.dispose(),this}}class zn extends hn{constructor(){super(F(zn.getDefaults(),arguments)),this.name="BitCrusherWorklet";const t=F(zn.getDefaults(),arguments);this.input=new Pt({context:this.context}),this.output=new Pt({context:this.context}),this.bits=new Ct({context:this.context,value:t.bits,units:"positive",minValue:1,maxValue:16,param:this._dummyParam,swappable:!0})}static getDefaults(){return Object.assign(hn.getDefaults(),{bits:12})}_audioWorkletName(){return"bit-crusher"}onReady(t){Et(this.input,t,this.output);const e=t.parameters.get("bits");this.bits.setParam(e)}dispose(){return super.dispose(),this.input.dispose(),this.output.dispose(),this.bits.dispose(),this}}class Bn extends Mn{constructor(){super(F(Bn.getDefaults(),arguments,["order"])),this.name="Chebyshev";const t=F(Bn.getDefaults(),arguments,["order"]);this._shaper=new me({context:this.context,length:4096}),this._order=t.order,this.connectEffect(this._shaper),this.order=t.order,this.oversample=t.oversample}static getDefaults(){return Object.assign(Mn.getDefaults(),{order:1,oversample:"none"})}_getCoefficient(t,e,n){return n.has(e)||(0===e?n.set(e,0):1===e?n.set(e,t):n.set(e,2*t*this._getCoefficient(t,e-1,n)-this._getCoefficient(t,e-2,n))),n.get(e)}get order(){return this._order}set order(t){this._order=t,this._shaper.setMap(e=>this._getCoefficient(e,t,new Map))}get oversample(){return this._shaper.oversample}set oversample(t){this._shaper.oversample=t}dispose(){return super.dispose(),this._shaper.dispose(),this}}class Wn extends Rt{constructor(){super(F(Wn.getDefaults(),arguments,["channels"])),this.name="Split";const t=F(Wn.getDefaults(),arguments,["channels"]);this._splitter=this.input=this.output=this.context.createChannelSplitter(t.channels),this._internalChannels=[this._splitter]}static getDefaults(){return Object.assign(Rt.getDefaults(),{channels:2})}dispose(){return super.dispose(),this._splitter.disconnect(),this}}class Gn extends Rt{constructor(){super(F(Gn.getDefaults(),arguments,["channels"])),this.name="Merge";const t=F(Gn.getDefaults(),arguments,["channels"]);this._merger=this.output=this.input=this.context.createChannelMerger(t.channels)}static getDefaults(){return Object.assign(Rt.getDefaults(),{channels:2})}dispose(){return super.dispose(),this._merger.disconnect(),this}}class Un extends Rt{constructor(t){super(t),this.name="StereoEffect",this.input=new Pt({context:this.context}),this.input.channelCount=2,this.input.channelCountMode="explicit",this._dryWet=this.output=new jn({context:this.context,fade:t.wet}),this.wet=this._dryWet.fade,this._split=new Wn({context:this.context,channels:2}),this._merge=new Gn({context:this.context,channels:2}),this.input.connect(this._split),this.input.connect(this._dryWet.a),this._merge.connect(this._dryWet.b),et(this,["wet"])}connectEffectLeft(...t){this._split.connect(t[0],0,0),Et(...t),jt(t[t.length-1],this._merge,0,0)}connectEffectRight(...t){this._split.connect(t[0],1,0),Et(...t),jt(t[t.length-1],this._merge,0,1)}static getDefaults(){return Object.assign(Rt.getDefaults(),{wet:1})}dispose(){return super.dispose(),this._dryWet.dispose(),this._split.dispose(),this._merge.dispose(),this}}class Yn extends Un{constructor(t){super(t),this.feedback=new Ft({context:this.context,value:t.feedback,units:"normalRange"}),this._feedbackL=new Pt({context:this.context}),this._feedbackR=new Pt({context:this.context}),this._feedbackSplit=new Wn({context:this.context,channels:2}),this._feedbackMerge=new Gn({context:this.context,channels:2}),this._merge.connect(this._feedbackSplit),this._feedbackMerge.connect(this._split),this._feedbackSplit.connect(this._feedbackL,0,0),this._feedbackL.connect(this._feedbackMerge,0,0),this._feedbackSplit.connect(this._feedbackR,1,0),this._feedbackR.connect(this._feedbackMerge,0,1),this.feedback.fan(this._feedbackL.gain,this._feedbackR.gain),et(this,["feedback"])}static getDefaults(){return Object.assign(Un.getDefaults(),{feedback:.5})}dispose(){return super.dispose(),this.feedback.dispose(),this._feedbackL.dispose(),this._feedbackR.dispose(),this._feedbackSplit.dispose(),this._feedbackMerge.dispose(),this}}class Zn extends Yn{constructor(){super(F(Zn.getDefaults(),arguments,["frequency","delayTime","depth"])),this.name="Chorus";const t=F(Zn.getDefaults(),arguments,["frequency","delayTime","depth"]);this._depth=t.depth,this._delayTime=t.delayTime/1e3,this._lfoL=new De({context:this.context,frequency:t.frequency,min:0,max:1}),this._lfoR=new De({context:this.context,frequency:t.frequency,min:0,max:1,phase:180}),this._delayNodeL=new Wt({context:this.context}),this._delayNodeR=new Wt({context:this.context}),this.frequency=this._lfoL.frequency,et(this,["frequency"]),this._lfoL.frequency.connect(this._lfoR.frequency),this.connectEffectLeft(this._delayNodeL),this.connectEffectRight(this._delayNodeR),this._lfoL.connect(this._delayNodeL.delayTime),this._lfoR.connect(this._delayNodeR.delayTime),this.depth=this._depth,this.type=t.type,this.spread=t.spread}static getDefaults(){return Object.assign(Yn.getDefaults(),{frequency:1.5,delayTime:3.5,depth:.7,type:"sine",spread:180,feedback:0,wet:.5})}get depth(){return this._depth}set depth(t){this._depth=t;const e=this._delayTime*t;this._lfoL.min=Math.max(this._delayTime-e,0),this._lfoL.max=this._delayTime+e,this._lfoR.min=Math.max(this._delayTime-e,0),this._lfoR.max=this._delayTime+e}get delayTime(){return 1e3*this._delayTime}set delayTime(t){this._delayTime=t/1e3,this.depth=this._depth}get type(){return this._lfoL.type}set type(t){this._lfoL.type=t,this._lfoR.type=t}get spread(){return this._lfoR.phase-this._lfoL.phase}set spread(t){this._lfoL.phase=90-t/2,this._lfoR.phase=t/2+90}start(t){return this._lfoL.start(t),this._lfoR.start(t),this}stop(t){return this._lfoL.stop(t),this._lfoR.stop(t),this}sync(){return this._lfoL.sync(),this._lfoR.sync(),this}unsync(){return this._lfoL.unsync(),this._lfoR.unsync(),this}dispose(){return super.dispose(),this._lfoL.dispose(),this._lfoR.dispose(),this._delayNodeL.dispose(),this._delayNodeR.dispose(),this.frequency.dispose(),this}}class Xn extends Mn{constructor(){super(F(Xn.getDefaults(),arguments,["distortion"])),this.name="Distortion";const t=F(Xn.getDefaults(),arguments,["distortion"]);this._shaper=new me({context:this.context,length:4096}),this._distortion=t.distortion,this.connectEffect(this._shaper),this.distortion=t.distortion,this.oversample=t.oversample}static getDefaults(){return Object.assign(Mn.getDefaults(),{distortion:.4,oversample:"none"})}get distortion(){return this._distortion}set distortion(t){this._distortion=t;const e=100*t,n=Math.PI/180;this._shaper.setMap(t=>Math.abs(t)<.001?0:(3+e)*t*20*n/(Math.PI+e*Math.abs(t)))}get oversample(){return this._shaper.oversample}set oversample(t){this._shaper.oversample=t}dispose(){return super.dispose(),this._shaper.dispose(),this}}class Qn extends Mn{constructor(t){super(t),this.name="FeedbackEffect",this._feedbackGain=new Pt({context:this.context,gain:t.feedback,units:"normalRange"}),this.feedback=this._feedbackGain.gain,et(this,"feedback"),this.effectReturn.chain(this._feedbackGain,this.effectSend)}static getDefaults(){return Object.assign(Mn.getDefaults(),{feedback:.125})}dispose(){return super.dispose(),this._feedbackGain.dispose(),this.feedback.dispose(),this}}class Hn extends Qn{constructor(){super(F(Hn.getDefaults(),arguments,["delayTime","feedback"])),this.name="FeedbackDelay";const t=F(Hn.getDefaults(),arguments,["delayTime","feedback"]);this._delayNode=new Wt({context:this.context,delayTime:t.delayTime,maxDelay:t.maxDelay}),this.delayTime=this._delayNode.delayTime,this.connectEffect(this._delayNode),et(this,"delayTime")}static getDefaults(){return Object.assign(Qn.getDefaults(),{delayTime:.25,maxDelay:1})}dispose(){return super.dispose(),this._delayNode.dispose(),this.delayTime.dispose(),this}}class $n extends Rt{constructor(t){super(t),this.name="PhaseShiftAllpass",this.input=new Pt({context:this.context}),this.output=new Pt({context:this.context}),this.offset90=new Pt({context:this.context});this._bank0=this._createAllPassFilterBank([.6923878,.9360654322959,.988229522686,.9987488452737]),this._bank1=this._createAllPassFilterBank([.4021921162426,.856171088242,.9722909545651,.9952884791278]),this._oneSampleDelay=this.context.createIIRFilter([0,1],[1,0]),Et(this.input,...this._bank0,this._oneSampleDelay,this.output),Et(this.input,...this._bank1,this.offset90)}_createAllPassFilterBank(t){return t.map(t=>{const e=[[t*t,0,-1],[1,0,-t*t]];return this.context.createIIRFilter(e[0],e[1])})}dispose(){return super.dispose(),this.input.dispose(),this.output.dispose(),this.offset90.dispose(),this._bank0.forEach(t=>t.disconnect()),this._bank1.forEach(t=>t.disconnect()),this._oneSampleDelay.disconnect(),this}}class Jn extends Mn{constructor(){super(F(Jn.getDefaults(),arguments,["frequency"])),this.name="FrequencyShifter";const t=F(Jn.getDefaults(),arguments,["frequency"]);this.frequency=new Ft({context:this.context,units:"frequency",value:t.frequency,minValue:-this.context.sampleRate/2,maxValue:this.context.sampleRate/2}),this._sine=new fe({context:this.context,type:"sine"}),this._cosine=new pe({context:this.context,phase:-90,type:"sine"}),this._sineMultiply=new ge({context:this.context}),this._cosineMultiply=new ge({context:this.context}),this._negate=new Ie({context:this.context}),this._add=new Se({context:this.context}),this._phaseShifter=new $n({context:this.context}),this.effectSend.connect(this._phaseShifter),this.frequency.fan(this._sine.frequency,this._cosine.frequency),this._phaseShifter.offset90.connect(this._cosineMultiply),this._cosine.connect(this._cosineMultiply.factor),this._phaseShifter.connect(this._sineMultiply),this._sine.connect(this._sineMultiply.factor),this._sineMultiply.connect(this._negate),this._cosineMultiply.connect(this._add),this._negate.connect(this._add.addend),this._add.connect(this.effectReturn);const e=this.immediate();this._sine.start(e),this._cosine.start(e)}static getDefaults(){return Object.assign(Mn.getDefaults(),{frequency:0})}dispose(){return super.dispose(),this.frequency.dispose(),this._add.dispose(),this._cosine.dispose(),this._cosineMultiply.dispose(),this._negate.dispose(),this._phaseShifter.dispose(),this._sine.dispose(),this._sineMultiply.dispose(),this}}const Kn=[1557/44100,1617/44100,1491/44100,1422/44100,1277/44100,1356/44100,1188/44100,1116/44100],ti=[225,556,441,341];class ei extends Un{constructor(){super(F(ei.getDefaults(),arguments,["roomSize","dampening"])),this.name="Freeverb",this._combFilters=[],this._allpassFiltersL=[],this._allpassFiltersR=[];const t=F(ei.getDefaults(),arguments,["roomSize","dampening"]);this.roomSize=new Ft({context:this.context,value:t.roomSize,units:"normalRange"}),this._allpassFiltersL=ti.map(t=>{const e=this.context.createBiquadFilter();return e.type="allpass",e.frequency.value=t,e}),this._allpassFiltersR=ti.map(t=>{const e=this.context.createBiquadFilter();return e.type="allpass",e.frequency.value=t,e}),this._combFilters=Kn.map((e,n)=>{const i=new dn({context:this.context,dampening:t.dampening,delayTime:e});return n<Kn.length/2?this.connectEffectLeft(i,...this._allpassFiltersL):this.connectEffectRight(i,...this._allpassFiltersR),this.roomSize.connect(i.resonance),i}),et(this,["roomSize"])}static getDefaults(){return Object.assign(Un.getDefaults(),{roomSize:.7,dampening:3e3})}get dampening(){return this._combFilters[0].dampening}set dampening(t){this._combFilters.forEach(e=>e.dampening=t)}dispose(){return super.dispose(),this._allpassFiltersL.forEach(t=>t.disconnect()),this._allpassFiltersR.forEach(t=>t.disconnect()),this._combFilters.forEach(t=>t.dispose()),this.roomSize.dispose(),this}}const ni=[.06748,.06404,.08212,.09004],ii=[.773,.802,.753,.733],ri=[347,113,37];class si extends Un{constructor(){super(F(si.getDefaults(),arguments,["roomSize"])),this.name="JCReverb",this._allpassFilters=[],this._feedbackCombFilters=[];const t=F(si.getDefaults(),arguments,["roomSize"]);this.roomSize=new Ft({context:this.context,value:t.roomSize,units:"normalRange"}),this._scaleRoomSize=new Te({context:this.context,min:-.733,max:.197}),this._allpassFilters=ri.map(t=>{const e=this.context.createBiquadFilter();return e.type="allpass",e.frequency.value=t,e}),this._feedbackCombFilters=ni.map((t,e)=>{const n=new fn({context:this.context,delayTime:t});return this._scaleRoomSize.connect(n.resonance),n.resonance.value=ii[e],e<ni.length/2?this.connectEffectLeft(...this._allpassFilters,n):this.connectEffectRight(...this._allpassFilters,n),n}),this.roomSize.connect(this._scaleRoomSize),et(this,["roomSize"])}static getDefaults(){return Object.assign(Un.getDefaults(),{roomSize:.5})}dispose(){return super.dispose(),this._allpassFilters.forEach(t=>t.disconnect()),this._feedbackCombFilters.forEach(t=>t.dispose()),this.roomSize.dispose(),this._scaleRoomSize.dispose(),this}}class oi extends Yn{constructor(t){super(t),this._feedbackL.disconnect(),this._feedbackL.connect(this._feedbackMerge,0,1),this._feedbackR.disconnect(),this._feedbackR.connect(this._feedbackMerge,0,0),et(this,["feedback"])}}class ai extends oi{constructor(){super(F(ai.getDefaults(),arguments,["delayTime","feedback"])),this.name="PingPongDelay";const t=F(ai.getDefaults(),arguments,["delayTime","feedback"]);this._leftDelay=new Wt({context:this.context,maxDelay:t.maxDelay}),this._rightDelay=new Wt({context:this.context,maxDelay:t.maxDelay}),this._rightPreDelay=new Wt({context:this.context,maxDelay:t.maxDelay}),this.delayTime=new Ft({context:this.context,units:"time",value:t.delayTime}),this.connectEffectLeft(this._leftDelay),this.connectEffectRight(this._rightPreDelay,this._rightDelay),this.delayTime.fan(this._leftDelay.delayTime,this._rightDelay.delayTime,this._rightPreDelay.delayTime),this._feedbackL.disconnect(),this._feedbackL.connect(this._rightDelay),et(this,["delayTime"])}static getDefaults(){return Object.assign(oi.getDefaults(),{delayTime:.25,maxDelay:1})}dispose(){return super.dispose(),this._leftDelay.dispose(),this._rightDelay.dispose(),this._rightPreDelay.dispose(),this.delayTime.dispose(),this}}class ui extends Qn{constructor(){super(F(ui.getDefaults(),arguments,["pitch"])),this.name="PitchShift";const t=F(ui.getDefaults(),arguments,["pitch"]);this._frequency=new Ft({context:this.context}),this._delayA=new Wt({maxDelay:1,context:this.context}),this._lfoA=new De({context:this.context,min:0,max:.1,type:"sawtooth"}).connect(this._delayA.delayTime),this._delayB=new Wt({maxDelay:1,context:this.context}),this._lfoB=new De({context:this.context,min:0,max:.1,type:"sawtooth",phase:180}).connect(this._delayB.delayTime),this._crossFade=new jn({context:this.context}),this._crossFadeLFO=new De({context:this.context,min:0,max:1,type:"triangle",phase:90}).connect(this._crossFade.fade),this._feedbackDelay=new Wt({delayTime:t.delayTime,context:this.context}),this.delayTime=this._feedbackDelay.delayTime,et(this,"delayTime"),this._pitch=t.pitch,this._windowSize=t.windowSize,this._delayA.connect(this._crossFade.a),this._delayB.connect(this._crossFade.b),this._frequency.fan(this._lfoA.frequency,this._lfoB.frequency,this._crossFadeLFO.frequency),this.effectSend.fan(this._delayA,this._delayB),this._crossFade.chain(this._feedbackDelay,this.effectReturn);const e=this.now();this._lfoA.start(e),this._lfoB.start(e),this._crossFadeLFO.start(e),this.windowSize=this._windowSize}static getDefaults(){return Object.assign(Qn.getDefaults(),{pitch:0,windowSize:.1,delayTime:0,feedback:0})}get pitch(){return this._pitch}set pitch(t){this._pitch=t;let e=0;t<0?(this._lfoA.min=0,this._lfoA.max=this._windowSize,this._lfoB.min=0,this._lfoB.max=this._windowSize,e=pt(t-1)+1):(this._lfoA.min=this._windowSize,this._lfoA.max=0,this._lfoB.min=this._windowSize,this._lfoB.max=0,e=pt(t)-1),this._frequency.value=e*(1.2/this._windowSize)}get windowSize(){return this._windowSize}set windowSize(t){this._windowSize=this.toSeconds(t),this.pitch=this._pitch}dispose(){return super.dispose(),this._frequency.dispose(),this._delayA.dispose(),this._delayB.dispose(),this._lfoA.dispose(),this._lfoB.dispose(),this._crossFade.dispose(),this._crossFadeLFO.dispose(),this._feedbackDelay.dispose(),this}}class ci extends Un{constructor(){super(F(ci.getDefaults(),arguments,["frequency","octaves","baseFrequency"])),this.name="Phaser";const t=F(ci.getDefaults(),arguments,["frequency","octaves","baseFrequency"]);this._lfoL=new De({context:this.context,frequency:t.frequency,min:0,max:1}),this._lfoR=new De({context:this.context,frequency:t.frequency,min:0,max:1,phase:180}),this._baseFrequency=this.toFrequency(t.baseFrequency),this._octaves=t.octaves,this.Q=new Ft({context:this.context,value:t.Q,units:"positive"}),this._filtersL=this._makeFilters(t.stages,this._lfoL),this._filtersR=this._makeFilters(t.stages,this._lfoR),this.frequency=this._lfoL.frequency,this.frequency.value=t.frequency,this.connectEffectLeft(...this._filtersL),this.connectEffectRight(...this._filtersR),this._lfoL.frequency.connect(this._lfoR.frequency),this.baseFrequency=t.baseFrequency,this.octaves=t.octaves,this._lfoL.start(),this._lfoR.start(),et(this,["frequency","Q"])}static getDefaults(){return Object.assign(Un.getDefaults(),{frequency:.5,octaves:3,stages:10,Q:10,baseFrequency:350})}_makeFilters(t,e){const n=[];for(let i=0;i<t;i++){const t=this.context.createBiquadFilter();t.type="allpass",this.Q.connect(t.Q),e.connect(t.frequency),n.push(t)}return n}get octaves(){return this._octaves}set octaves(t){this._octaves=t;const e=this._baseFrequency*Math.pow(2,t);this._lfoL.max=e,this._lfoR.max=e}get baseFrequency(){return this._baseFrequency}set baseFrequency(t){this._baseFrequency=this.toFrequency(t),this._lfoL.min=this._baseFrequency,this._lfoR.min=this._baseFrequency,this.octaves=this._octaves}dispose(){return super.dispose(),this.Q.dispose(),this._lfoL.dispose(),this._lfoR.dispose(),this._filtersL.forEach(t=>t.disconnect()),this._filtersR.forEach(t=>t.disconnect()),this.frequency.dispose(),this}}class li extends Mn{constructor(){super(F(li.getDefaults(),arguments,["decay"])),this.name="Reverb",this._convolver=this.context.createConvolver(),this.ready=Promise.resolve();const t=F(li.getDefaults(),arguments,["decay"]);this._decay=t.decay,this._preDelay=t.preDelay,this.generate(),this.connectEffect(this._convolver)}static getDefaults(){return Object.assign(Mn.getDefaults(),{decay:1.5,preDelay:.01})}get decay(){return this._decay}set decay(t){a(t=this.toSeconds(t),.001),this._decay=t,this.generate()}get preDelay(){return this._preDelay}set preDelay(t){a(t=this.toSeconds(t),0),this._preDelay=t,this.generate()}generate(){return D(this,void 0,void 0,(function*(){const t=this.ready,e=new st(2,this._decay+this._preDelay,this.context.sampleRate),n=new ae({context:e}),i=new ae({context:e}),r=new Gn({context:e});n.connect(r,0,0),i.connect(r,0,1);const s=new Pt({context:e}).toDestination();r.connect(s),n.start(0),i.start(0),s.gain.setValueAtTime(0,0),s.gain.setValueAtTime(1,this._preDelay),s.gain.exponentialApproachValueAtTime(0,this._preDelay,this.decay);const o=e.render();return this.ready=o.then(it),yield t,this._convolver.buffer=(yield o).get(),this}))}dispose(){return super.dispose(),this._convolver.disconnect(),this}}class hi extends Rt{constructor(){super(F(hi.getDefaults(),arguments)),this.name="MidSideSplit",this._split=this.input=new Wn({channels:2,context:this.context}),this._midAdd=new Se({context:this.context}),this.mid=new ge({context:this.context,value:Math.SQRT1_2}),this._sideSubtract=new Fe({context:this.context}),this.side=new ge({context:this.context,value:Math.SQRT1_2}),this._split.connect(this._midAdd,0),this._split.connect(this._midAdd.addend,1),this._split.connect(this._sideSubtract,0),this._split.connect(this._sideSubtract.subtrahend,1),this._midAdd.connect(this.mid),this._sideSubtract.connect(this.side)}dispose(){return super.dispose(),this.mid.dispose(),this.side.dispose(),this._midAdd.dispose(),this._sideSubtract.dispose(),this._split.dispose(),this}}class fi extends Rt{constructor(){super(F(fi.getDefaults(),arguments)),this.name="MidSideMerge",this.mid=new Pt({context:this.context}),this.side=new Pt({context:this.context}),this._left=new Se({context:this.context}),this._leftMult=new ge({context:this.context,value:Math.SQRT1_2}),this._right=new Fe({context:this.context}),this._rightMult=new ge({context:this.context,value:Math.SQRT1_2}),this._merge=this.output=new Gn({context:this.context}),this.mid.fan(this._left),this.side.connect(this._left.addend),this.mid.connect(this._right),this.side.connect(this._right.subtrahend),this._left.connect(this._leftMult),this._right.connect(this._rightMult),this._leftMult.connect(this._merge,0,0),this._rightMult.connect(this._merge,0,1)}dispose(){return super.dispose(),this.mid.dispose(),this.side.dispose(),this._leftMult.dispose(),this._rightMult.dispose(),this._left.dispose(),this._right.dispose(),this}}class pi extends Mn{constructor(t){super(t),this.name="MidSideEffect",this._midSideMerge=new fi({context:this.context}),this._midSideSplit=new hi({context:this.context}),this._midSend=this._midSideSplit.mid,this._sideSend=this._midSideSplit.side,this._midReturn=this._midSideMerge.mid,this._sideReturn=this._midSideMerge.side,this.effectSend.connect(this._midSideSplit),this._midSideMerge.connect(this.effectReturn)}connectEffectMid(...t){this._midSend.chain(...t,this._midReturn)}connectEffectSide(...t){this._sideSend.chain(...t,this._sideReturn)}dispose(){return super.dispose(),this._midSideSplit.dispose(),this._midSideMerge.dispose(),this._midSend.dispose(),this._sideSend.dispose(),this._midReturn.dispose(),this._sideReturn.dispose(),this}}class di extends pi{constructor(){super(F(di.getDefaults(),arguments,["width"])),this.name="StereoWidener";const t=F(di.getDefaults(),arguments,["width"]);this.width=new Ft({context:this.context,value:t.width,units:"normalRange"}),et(this,["width"]),this._twoTimesWidthMid=new ge({context:this.context,value:2}),this._twoTimesWidthSide=new ge({context:this.context,value:2}),this._midMult=new ge({context:this.context}),this._twoTimesWidthMid.connect(this._midMult.factor),this.connectEffectMid(this._midMult),this._oneMinusWidth=new Fe({context:this.context}),this._oneMinusWidth.connect(this._twoTimesWidthMid),jt(this.context.getConstant(1),this._oneMinusWidth),this.width.connect(this._oneMinusWidth.subtrahend),this._sideMult=new ge({context:this.context}),this.width.connect(this._twoTimesWidthSide),this._twoTimesWidthSide.connect(this._sideMult.factor),this.connectEffectSide(this._sideMult)}static getDefaults(){return Object.assign(pi.getDefaults(),{width:.5})}dispose(){return super.dispose(),this.width.dispose(),this._midMult.dispose(),this._sideMult.dispose(),this._twoTimesWidthMid.dispose(),this._twoTimesWidthSide.dispose(),this._oneMinusWidth.dispose(),this}}class mi extends Un{constructor(){super(F(mi.getDefaults(),arguments,["frequency","depth"])),this.name="Tremolo";const t=F(mi.getDefaults(),arguments,["frequency","depth"]);this._lfoL=new De({context:this.context,type:t.type,min:1,max:0}),this._lfoR=new De({context:this.context,type:t.type,min:1,max:0}),this._amplitudeL=new Pt({context:this.context}),this._amplitudeR=new Pt({context:this.context}),this.frequency=new Ft({context:this.context,value:t.frequency,units:"frequency"}),this.depth=new Ft({context:this.context,value:t.depth,units:"normalRange"}),et(this,["frequency","depth"]),this.connectEffectLeft(this._amplitudeL),this.connectEffectRight(this._amplitudeR),this._lfoL.connect(this._amplitudeL.gain),this._lfoR.connect(this._amplitudeR.gain),this.frequency.fan(this._lfoL.frequency,this._lfoR.frequency),this.depth.fan(this._lfoR.amplitude,this._lfoL.amplitude),this.spread=t.spread}static getDefaults(){return Object.assign(Un.getDefaults(),{frequency:10,type:"sine",depth:.5,spread:180})}start(t){return this._lfoL.start(t),this._lfoR.start(t),this}stop(t){return this._lfoL.stop(t),this._lfoR.stop(t),this}sync(){return this._lfoL.sync(),this._lfoR.sync(),this.context.transport.syncSignal(this.frequency),this}unsync(){return this._lfoL.unsync(),this._lfoR.unsync(),this.context.transport.unsyncSignal(this.frequency),this}get type(){return this._lfoL.type}set type(t){this._lfoL.type=t,this._lfoR.type=t}get spread(){return this._lfoR.phase-this._lfoL.phase}set spread(t){this._lfoL.phase=90-t/2,this._lfoR.phase=t/2+90}dispose(){return super.dispose(),this._lfoL.dispose(),this._lfoR.dispose(),this._amplitudeL.dispose(),this._amplitudeR.dispose(),this.frequency.dispose(),this.depth.dispose(),this}}class _i extends Mn{constructor(){super(F(_i.getDefaults(),arguments,["frequency","depth"])),this.name="Vibrato";const t=F(_i.getDefaults(),arguments,["frequency","depth"]);this._delayNode=new Wt({context:this.context,delayTime:0,maxDelay:t.maxDelay}),this._lfo=new De({context:this.context,type:t.type,min:0,max:t.maxDelay,frequency:t.frequency,phase:-90}).start().connect(this._delayNode.delayTime),this.frequency=this._lfo.frequency,this.depth=this._lfo.amplitude,this.depth.value=t.depth,et(this,["frequency","depth"]),this.effectSend.chain(this._delayNode,this.effectReturn)}static getDefaults(){return Object.assign(Mn.getDefaults(),{maxDelay:.005,frequency:5,depth:.1,type:"sine"})}get type(){return this._lfo.type}set type(t){this._lfo.type=t}dispose(){return super.dispose(),this._delayNode.dispose(),this._lfo.dispose(),this.frequency.dispose(),this.depth.dispose(),this}}class gi extends Rt{constructor(){super(F(gi.getDefaults(),arguments,["type","size"])),this.name="Analyser",this._analysers=[],this._buffers=[];const t=F(gi.getDefaults(),arguments,["type","size"]);this.input=this.output=this._gain=new Pt({context:this.context}),this._split=new Wn({context:this.context,channels:t.channels}),this.input.connect(this._split),a(t.channels,1);for(let e=0;e<t.channels;e++)this._analysers[e]=this.context.createAnalyser(),this._split.connect(this._analysers[e],e,0);this.size=t.size,this.type=t.type}static getDefaults(){return Object.assign(Rt.getDefaults(),{size:1024,smoothing:.8,type:"fft",channels:1})}getValue(){return this._analysers.forEach((t,e)=>{const n=this._buffers[e];"fft"===this._type?t.getFloatFrequencyData(n):"waveform"===this._type&&t.getFloatTimeDomainData(n)}),1===this.channels?this._buffers[0]:this._buffers}get size(){return this._analysers[0].frequencyBinCount}set size(t){this._analysers.forEach((e,n)=>{e.fftSize=2*t,this._buffers[n]=new Float32Array(t)})}get channels(){return this._analysers.length}get type(){return this._type}set type(t){o("waveform"===t||"fft"===t,"Analyser: invalid type: "+t),this._type=t}get smoothing(){return this._analysers[0].smoothingTimeConstant}set smoothing(t){this._analysers.forEach(e=>e.smoothingTimeConstant=t)}dispose(){return super.dispose(),this._analysers.forEach(t=>t.disconnect()),this._split.dispose(),this._gain.dispose(),this}}class vi extends Rt{constructor(){super(F(vi.getDefaults(),arguments)),this.name="MeterBase",this.input=this.output=this._analyser=new gi({context:this.context,size:256,type:"waveform"})}dispose(){return super.dispose(),this._analyser.dispose(),this}}class yi extends vi{constructor(){super(F(yi.getDefaults(),arguments,["smoothing"])),this.name="Meter",this._rms=0;const t=F(yi.getDefaults(),arguments,["smoothing"]);this.input=this.output=this._analyser=new gi({context:this.context,size:256,type:"waveform",channels:t.channels}),this.smoothing=t.smoothing,this.normalRange=t.normalRange}static getDefaults(){return Object.assign(vi.getDefaults(),{smoothing:.8,normalRange:!1,channels:1})}getLevel(){return f("'getLevel' has been changed to 'getValue'"),this.getValue()}getValue(){const t=this._analyser.getValue(),e=(1===this.channels?[t]:t).map(t=>{const e=t.reduce((t,e)=>t+e*e,0),n=Math.sqrt(e/t.length);return this._rms=Math.max(n,this._rms*this.smoothing),this.normalRange?this._rms:ft(this._rms)});return 1===this.channels?e[0]:e}get channels(){return this._analyser.channels}dispose(){return super.dispose(),this._analyser.dispose(),this}}class bi extends vi{constructor(){super(F(bi.getDefaults(),arguments,["size"])),this.name="FFT";const t=F(bi.getDefaults(),arguments,["size"]);this.normalRange=t.normalRange,this._analyser.type="fft",this.size=t.size}static getDefaults(){return Object.assign(Rt.getDefaults(),{normalRange:!1,size:1024,smoothing:.8})}getValue(){return this._analyser.getValue().map(t=>this.normalRange?ht(t):t)}get size(){return this._analyser.size}set size(t){this._analyser.size=t}get smoothing(){return this._analyser.smoothing}set smoothing(t){this._analyser.smoothing=t}getFrequencyOfIndex(t){return o(0<=t&&t<this.size,"index must be greater than or equal to 0 and less than "+this.size),t*this.context.sampleRate/(2*this.size)}}class xi extends vi{constructor(){super(F(xi.getDefaults(),arguments)),this.name="DCMeter",this._analyser.type="waveform",this._analyser.size=256}getValue(){return this._analyser.getValue()[0]}}class wi extends vi{constructor(){super(F(wi.getDefaults(),arguments,["size"])),this.name="Waveform";const t=F(wi.getDefaults(),arguments,["size"]);this._analyser.type="waveform",this.size=t.size}static getDefaults(){return Object.assign(vi.getDefaults(),{size:1024})}getValue(){return this._analyser.getValue()}get size(){return this._analyser.size}set size(t){this._analyser.size=t}}class Oi extends Rt{constructor(){super(F(Oi.getDefaults(),arguments,["solo"])),this.name="Solo";const t=F(Oi.getDefaults(),arguments,["solo"]);this.input=this.output=new Pt({context:this.context}),Oi._allSolos.has(this.context)||Oi._allSolos.set(this.context,new Set),Oi._allSolos.get(this.context).add(this),this.solo=t.solo}static getDefaults(){return Object.assign(Rt.getDefaults(),{solo:!1})}get solo(){return this._isSoloed()}set solo(t){t?this._addSolo():this._removeSolo(),Oi._allSolos.get(this.context).forEach(t=>t._updateSolo())}get muted(){return 0===this.input.gain.value}_addSolo(){Oi._soloed.has(this.context)||Oi._soloed.set(this.context,new Set),Oi._soloed.get(this.context).add(this)}_removeSolo(){Oi._soloed.has(this.context)&&Oi._soloed.get(this.context).delete(this)}_isSoloed(){return Oi._soloed.has(this.context)&&Oi._soloed.get(this.context).has(this)}_noSolos(){return!Oi._soloed.has(this.context)||Oi._soloed.has(this.context)&&0===Oi._soloed.get(this.context).size}_updateSolo(){this._isSoloed()||this._noSolos()?this.input.gain.value=1:this.input.gain.value=0}dispose(){return super.dispose(),Oi._allSolos.get(this.context).delete(this),this._removeSolo(),this}}Oi._allSolos=new Map,Oi._soloed=new Map;class ki extends Rt{constructor(){super(F(ki.getDefaults(),arguments,["pan","volume"])),this.name="PanVol";const t=F(ki.getDefaults(),arguments,["pan","volume"]);this._panner=this.input=new In({context:this.context,pan:t.pan,channelCount:t.channelCount}),this.pan=this._panner.pan,this._volume=this.output=new Kt({context:this.context,volume:t.volume}),this.volume=this._volume.volume,this._panner.connect(this._volume),this.mute=t.mute,et(this,["pan","volume"])}static getDefaults(){return Object.assign(Rt.getDefaults(),{mute:!1,pan:0,volume:0,channelCount:1})}get mute(){return this._volume.mute}set mute(t){this._volume.mute=t}dispose(){return super.dispose(),this._panner.dispose(),this.pan.dispose(),this._volume.dispose(),this.volume.dispose(),this}}class Si extends Rt{constructor(){super(F(Si.getDefaults(),arguments,["volume","pan"])),this.name="Channel";const t=F(Si.getDefaults(),arguments,["volume","pan"]);this._solo=this.input=new Oi({solo:t.solo,context:this.context}),this._panVol=this.output=new ki({context:this.context,pan:t.pan,volume:t.volume,mute:t.mute,channelCount:t.channelCount}),this.pan=this._panVol.pan,this.volume=this._panVol.volume,this._solo.connect(this._panVol),et(this,["pan","volume"])}static getDefaults(){return Object.assign(Rt.getDefaults(),{pan:0,volume:0,mute:!1,solo:!1,channelCount:1})}get solo(){return this._solo.solo}set solo(t){this._solo.solo=t}get muted(){return this._solo.muted||this.mute}get mute(){return this._panVol.mute}set mute(t){this._panVol.mute=t}_getBus(t){return Si.buses.has(t)||Si.buses.set(t,new Pt({context:this.context})),Si.buses.get(t)}send(t,e=0){const n=this._getBus(t),i=new Pt({context:this.context,units:"decibels",gain:e});return this.connect(i),i.connect(n),i}receive(t){return this._getBus(t).connect(this),this}dispose(){return super.dispose(),this._panVol.dispose(),this.pan.dispose(),this.volume.dispose(),this._solo.dispose(),this}}Si.buses=new Map;class Ti extends Rt{constructor(){super(F(Ti.getDefaults(),arguments)),this.name="Mono",this.input=new Pt({context:this.context}),this._merge=this.output=new Gn({channels:2,context:this.context}),this.input.connect(this._merge,0,0),this.input.connect(this._merge,0,1)}dispose(){return super.dispose(),this._merge.dispose(),this.input.dispose(),this}}class Ai extends Rt{constructor(){super(F(Ai.getDefaults(),arguments,["lowFrequency","highFrequency"])),this.name="MultibandSplit",this.input=new Pt({context:this.context}),this.output=void 0,this.low=new Je({context:this.context,frequency:0,type:"lowpass"}),this._lowMidFilter=new Je({context:this.context,frequency:0,type:"highpass"}),this.mid=new Je({context:this.context,frequency:0,type:"lowpass"}),this.high=new Je({context:this.context,frequency:0,type:"highpass"}),this._internalChannels=[this.low,this.mid,this.high];const t=F(Ai.getDefaults(),arguments,["lowFrequency","highFrequency"]);this.lowFrequency=new Ft({context:this.context,units:"frequency",value:t.lowFrequency}),this.highFrequency=new Ft({context:this.context,units:"frequency",value:t.highFrequency}),this.Q=new Ft({context:this.context,units:"positive",value:t.Q}),this.input.fan(this.low,this.high),this.input.chain(this._lowMidFilter,this.mid),this.lowFrequency.fan(this.low.frequency,this._lowMidFilter.frequency),this.highFrequency.fan(this.mid.frequency,this.high.frequency),this.Q.connect(this.low.Q),this.Q.connect(this._lowMidFilter.Q),this.Q.connect(this.mid.Q),this.Q.connect(this.high.Q),et(this,["high","mid","low","highFrequency","lowFrequency"])}static getDefaults(){return Object.assign(Rt.getDefaults(),{Q:1,highFrequency:2500,lowFrequency:400})}dispose(){return super.dispose(),nt(this,["high","mid","low","highFrequency","lowFrequency"]),this.low.dispose(),this._lowMidFilter.dispose(),this.mid.dispose(),this.high.dispose(),this.lowFrequency.dispose(),this.highFrequency.dispose(),this.Q.dispose(),this}}class Di extends Rt{constructor(){super(...arguments),this.name="Listener",this.positionX=new Ct({context:this.context,param:this.context.rawContext.listener.positionX}),this.positionY=new Ct({context:this.context,param:this.context.rawContext.listener.positionY}),this.positionZ=new Ct({context:this.context,param:this.context.rawContext.listener.positionZ}),this.forwardX=new Ct({context:this.context,param:this.context.rawContext.listener.forwardX}),this.forwardY=new Ct({context:this.context,param:this.context.rawContext.listener.forwardY}),this.forwardZ=new Ct({context:this.context,param:this.context.rawContext.listener.forwardZ}),this.upX=new Ct({context:this.context,param:this.context.rawContext.listener.upX}),this.upY=new Ct({context:this.context,param:this.context.rawContext.listener.upY}),this.upZ=new Ct({context:this.context,param:this.context.rawContext.listener.upZ})}static getDefaults(){return Object.assign(Rt.getDefaults(),{positionX:0,positionY:0,positionZ:0,forwardX:0,forwardY:0,forwardZ:-1,upX:0,upY:1,upZ:0})}dispose(){return super.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this.forwardX.dispose(),this.forwardY.dispose(),this.forwardZ.dispose(),this.upX.dispose(),this.upY.dispose(),this.upZ.dispose(),this}}class Ci extends Rt{constructor(t){super(),this.context=t,this.name="PolyfillListener",this._orientation=[0,0,0,0,0,0],this._position=[0,0,0],this.setPosition=(t,e,n)=>{this.context.rawContext.listener.setPosition(t,e,n),this._position=[t,e,n]}}get positionX(){return this._position[0]}set positionX(t){this.setPosition(t,this._position[1],this._position[2])}get positionY(){return this._position[1]}set positionY(t){this.setPosition(this._position[0],t,this._position[2])}get positionZ(){return this._position[2]}set positionZ(t){this.setPosition(this._position[0],this._position[1],t)}get forwardX(){return this._orientation[0]}set forwardX(t){this._orientation[0]=t,this.setOrientation.apply(this,this._orientation)}get forwardY(){return this._orientation[1]}set forwardY(t){this._orientation[1]=t,this.setOrientation.apply(this,this._orientation)}get forwardZ(){return this._orientation[2]}set forwardZ(t){this._orientation[2]=t,this.setOrientation.apply(this,this._orientation)}get upX(){return this._orientation[3]}set upX(t){this._orientation[3]=t,this.setOrientation.apply(this,this._orientation)}get upY(){return this._orientation[4]}set upY(t){this._orientation[4]=t,this.setOrientation.apply(this,this._orientation)}get upZ(){return this._orientation[5]}set upZ(t){this._orientation[5]=t,this.setOrientation.apply(this,this._orientation)}setOrientation(t,e,n,i,r,s){this.context.rawContext.listener.setOrientation(t,e,n,i,r,s),this._orientation=[t,e,n,i,r,s]}static getDefaults(){return Object.assign(Rt.getDefaults(),{positionX:0,positionY:0,positionZ:0,forwardX:0,forwardY:0,forwardZ:-1,upX:0,upY:1,upZ:0})}dispose(){return super.dispose(),this._orientation=null,this._position=null,this}}Q(t=>{t.rawContext.listener.forwardX?t.listener=new Di({context:t}):t.listener=new Ci(t)}),$(t=>{t.listener.dispose()});class Ri extends Rt{constructor(){super(F(Ri.getDefaults(),arguments,["positionX","positionY","positionZ"])),this.name="Panner3D";const t=F(Ri.getDefaults(),arguments,["positionX","positionY","positionZ"]);this._panner=this.input=this.output=this.context.createPanner(),this.panningModel=t.panningModel,this.maxDistance=t.maxDistance,this.distanceModel=t.distanceModel,this.coneOuterGain=t.coneOuterGain,this.coneOuterAngle=t.coneOuterAngle,this.coneInnerAngle=t.coneInnerAngle,this.refDistance=t.refDistance,this.rolloffFactor=t.rolloffFactor,this.positionX=new Ct({context:this.context,param:this._panner.positionX,value:t.positionX}),this.positionY=new Ct({context:this.context,param:this._panner.positionY,value:t.positionY}),this.positionZ=new Ct({context:this.context,param:this._panner.positionZ,value:t.positionZ}),this.orientationX=new Ct({context:this.context,param:this._panner.orientationX,value:t.orientationX}),this.orientationY=new Ct({context:this.context,param:this._panner.orientationY,value:t.orientationY}),this.orientationZ=new Ct({context:this.context,param:this._panner.orientationZ,value:t.orientationZ})}static getDefaults(){return Object.assign(Rt.getDefaults(),{coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:0,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1})}setPosition(t,e,n){return this.positionX.value=t,this.positionY.value=e,this.positionZ.value=n,this}setOrientation(t,e,n){return this.orientationX.value=t,this.orientationY.value=e,this.orientationZ.value=n,this}get panningModel(){return this._panner.panningModel}set panningModel(t){this._panner.panningModel=t}get refDistance(){return this._panner.refDistance}set refDistance(t){this._panner.refDistance=t}get rolloffFactor(){return this._panner.rolloffFactor}set rolloffFactor(t){this._panner.rolloffFactor=t}get distanceModel(){return this._panner.distanceModel}set distanceModel(t){this._panner.distanceModel=t}get coneInnerAngle(){return this._panner.coneInnerAngle}set coneInnerAngle(t){this._panner.coneInnerAngle=t}get coneOuterAngle(){return this._panner.coneOuterAngle}set coneOuterAngle(t){this._panner.coneOuterAngle=t}get coneOuterGain(){return this._panner.coneOuterGain}set coneOuterGain(t){this._panner.coneOuterGain=t}get maxDistance(){return this._panner.maxDistance}set maxDistance(t){this._panner.maxDistance=t}dispose(){return super.dispose(),this._panner.disconnect(),this.orientationX.dispose(),this.orientationY.dispose(),this.orientationZ.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this}}class Ei extends Rt{constructor(){super(F(Ei.getDefaults(),arguments)),this.name="Recorder";const t=F(Ei.getDefaults(),arguments);this.input=new Pt({context:this.context}),o(Ei.supported,"Media Recorder API is not available"),this._stream=this.context.createMediaStreamDestination(),this.input.connect(this._stream),this._recorder=new MediaRecorder(this._stream.stream,{mimeType:t.mimeType})}static getDefaults(){return Rt.getDefaults()}get mimeType(){return this._recorder.mimeType}static get supported(){return null!==k&&Reflect.has(k,"MediaRecorder")}get state(){return"inactive"===this._recorder.state?"stopped":"paused"===this._recorder.state?"paused":"started"}start(){return D(this,void 0,void 0,(function*(){o("started"!==this.state,"Recorder is already started");const t=new Promise(t=>{const e=()=>{this._recorder.removeEventListener("start",e,!1),t()};this._recorder.addEventListener("start",e,!1)});return this._recorder.start(),yield t}))}stop(){return D(this,void 0,void 0,(function*(){o("stopped"!==this.state,"Recorder is not started");const t=new Promise(t=>{const e=n=>{this._recorder.removeEventListener("dataavailable",e,!1),t(n.data)};this._recorder.addEventListener("dataavailable",e,!1)});return this._recorder.stop(),yield t}))}pause(){return o("started"===this.state,"Recorder must be started"),this._recorder.pause(),this}dispose(){return super.dispose(),this.input.dispose(),this._stream.disconnect(),this}}class ji extends Rt{constructor(){super(F(ji.getDefaults(),arguments,["threshold","ratio"])),this.name="Compressor",this._compressor=this.context.createDynamicsCompressor(),this.input=this._compressor,this.output=this._compressor;const t=F(ji.getDefaults(),arguments,["threshold","ratio"]);this.threshold=new Ct({minValue:this._compressor.threshold.minValue,maxValue:this._compressor.threshold.maxValue,context:this.context,convert:!1,param:this._compressor.threshold,units:"decibels",value:t.threshold}),this.attack=new Ct({minValue:this._compressor.attack.minValue,maxValue:this._compressor.attack.maxValue,context:this.context,param:this._compressor.attack,units:"time",value:t.attack}),this.release=new Ct({minValue:this._compressor.release.minValue,maxValue:this._compressor.release.maxValue,context:this.context,param:this._compressor.release,units:"time",value:t.release}),this.knee=new Ct({minValue:this._compressor.knee.minValue,maxValue:this._compressor.knee.maxValue,context:this.context,convert:!1,param:this._compressor.knee,units:"decibels",value:t.knee}),this.ratio=new Ct({minValue:this._compressor.ratio.minValue,maxValue:this._compressor.ratio.maxValue,context:this.context,convert:!1,param:this._compressor.ratio,units:"positive",value:t.ratio}),et(this,["knee","release","attack","ratio","threshold"])}static getDefaults(){return Object.assign(Rt.getDefaults(),{attack:.003,knee:30,ratio:12,release:.25,threshold:-24})}get reduction(){return this._compressor.reduction}dispose(){return super.dispose(),this._compressor.disconnect(),this.attack.dispose(),this.release.dispose(),this.threshold.dispose(),this.ratio.dispose(),this.knee.dispose(),this}}class Mi extends Rt{constructor(){super(Object.assign(F(Mi.getDefaults(),arguments,["threshold","smoothing"]))),this.name="Gate";const t=F(Mi.getDefaults(),arguments,["threshold","smoothing"]);this._follower=new Vn({context:this.context,smoothing:t.smoothing}),this._gt=new Ne({context:this.context,value:ht(t.threshold)}),this.input=new Pt({context:this.context}),this._gate=this.output=new Pt({context:this.context}),this.input.connect(this._gate),this.input.chain(this._follower,this._gt,this._gate.gain)}static getDefaults(){return Object.assign(Rt.getDefaults(),{smoothing:.1,threshold:-40})}get threshold(){return ft(this._gt.value)}set threshold(t){this._gt.value=ht(t)}get smoothing(){return this._follower.smoothing}set smoothing(t){this._follower.smoothing=t}dispose(){return super.dispose(),this.input.dispose(),this._follower.dispose(),this._gt.dispose(),this._gate.dispose(),this}}class Pi extends Rt{constructor(){super(Object.assign(F(Pi.getDefaults(),arguments,["threshold"]))),this.name="Limiter";const t=F(Pi.getDefaults(),arguments,["threshold"]);this._compressor=this.input=this.output=new ji({context:this.context,ratio:20,attack:.003,release:.01,threshold:t.threshold}),this.threshold=this._compressor.threshold,et(this,"threshold")}static getDefaults(){return Object.assign(Rt.getDefaults(),{threshold:-12})}get reduction(){return this._compressor.reduction}dispose(){return super.dispose(),this._compressor.dispose(),this.threshold.dispose(),this}}class qi extends Rt{constructor(){super(Object.assign(F(qi.getDefaults(),arguments))),this.name="MidSideCompressor";const t=F(qi.getDefaults(),arguments);this._midSideSplit=this.input=new hi({context:this.context}),this._midSideMerge=this.output=new fi({context:this.context}),this.mid=new ji(Object.assign(t.mid,{context:this.context})),this.side=new ji(Object.assign(t.side,{context:this.context})),this._midSideSplit.mid.chain(this.mid,this._midSideMerge.mid),this._midSideSplit.side.chain(this.side,this._midSideMerge.side),et(this,["mid","side"])}static getDefaults(){return Object.assign(Rt.getDefaults(),{mid:{ratio:3,threshold:-24,release:.03,attack:.02,knee:16},side:{ratio:6,threshold:-30,release:.25,attack:.03,knee:10}})}dispose(){return super.dispose(),this.mid.dispose(),this.side.dispose(),this._midSideSplit.dispose(),this._midSideMerge.dispose(),this}}class Ii extends Rt{constructor(){super(Object.assign(F(Ii.getDefaults(),arguments))),this.name="MultibandCompressor";const t=F(Ii.getDefaults(),arguments);this._splitter=this.input=new Ai({context:this.context,lowFrequency:t.lowFrequency,highFrequency:t.highFrequency}),this.lowFrequency=this._splitter.lowFrequency,this.highFrequency=this._splitter.highFrequency,this.output=new Pt({context:this.context}),this.low=new ji(Object.assign(t.low,{context:this.context})),this.mid=new ji(Object.assign(t.mid,{context:this.context})),this.high=new ji(Object.assign(t.high,{context:this.context})),this._splitter.low.chain(this.low,this.output),this._splitter.mid.chain(this.mid,this.output),this._splitter.high.chain(this.high,this.output),et(this,["high","mid","low","highFrequency","lowFrequency"])}static getDefaults(){return Object.assign(Rt.getDefaults(),{lowFrequency:250,highFrequency:2e3,low:{ratio:6,threshold:-30,release:.25,attack:.03,knee:10},mid:{ratio:3,threshold:-24,release:.03,attack:.02,knee:16},high:{ratio:3,threshold:-24,release:.03,attack:.02,knee:16}})}dispose(){return super.dispose(),this._splitter.dispose(),this.low.dispose(),this.mid.dispose(),this.high.dispose(),this.output.dispose(),this}}class Fi extends Rt{constructor(){super(F(Fi.getDefaults(),arguments,["low","mid","high"])),this.name="EQ3",this.output=new Pt({context:this.context}),this._internalChannels=[];const t=F(Fi.getDefaults(),arguments,["low","mid","high"]);this.input=this._multibandSplit=new Ai({context:this.context,highFrequency:t.highFrequency,lowFrequency:t.lowFrequency}),this._lowGain=new Pt({context:this.context,gain:t.low,units:"decibels"}),this._midGain=new Pt({context:this.context,gain:t.mid,units:"decibels"}),this._highGain=new Pt({context:this.context,gain:t.high,units:"decibels"}),this.low=this._lowGain.gain,this.mid=this._midGain.gain,this.high=this._highGain.gain,this.Q=this._multibandSplit.Q,this.lowFrequency=this._multibandSplit.lowFrequency,this.highFrequency=this._multibandSplit.highFrequency,this._multibandSplit.low.chain(this._lowGain,this.output),this._multibandSplit.mid.chain(this._midGain,this.output),this._multibandSplit.high.chain(this._highGain,this.output),et(this,["low","mid","high","lowFrequency","highFrequency"]),this._internalChannels=[this._multibandSplit]}static getDefaults(){return Object.assign(Rt.getDefaults(),{high:0,highFrequency:2500,low:0,lowFrequency:400,mid:0})}dispose(){return super.dispose(),nt(this,["low","mid","high","lowFrequency","highFrequency"]),this._multibandSplit.dispose(),this.lowFrequency.dispose(),this.highFrequency.dispose(),this._lowGain.dispose(),this._midGain.dispose(),this._highGain.dispose(),this.low.dispose(),this.mid.dispose(),this.high.dispose(),this.Q.dispose(),this}}class Vi extends Rt{constructor(){super(F(Vi.getDefaults(),arguments,["url","onload"])),this.name="Convolver",this._convolver=this.context.createConvolver();const t=F(Vi.getDefaults(),arguments,["url","onload"]);this._buffer=new rt(t.url,e=>{this.buffer=e,t.onload()}),this.input=new Pt({context:this.context}),this.output=new Pt({context:this.context}),this._buffer.loaded&&(this.buffer=this._buffer),this.normalize=t.normalize,this.input.chain(this._convolver,this.output)}static getDefaults(){return Object.assign(Rt.getDefaults(),{normalize:!0,onload:it})}load(t){return D(this,void 0,void 0,(function*(){this.buffer=yield this._buffer.load(t)}))}get buffer(){return this._buffer.length?this._buffer:null}set buffer(t){t&&this._buffer.set(t),this._convolver.buffer&&(this.input.disconnect(),this._convolver.disconnect(),this._convolver=this.context.createConvolver(),this.input.chain(this._convolver,this.output));const e=this._buffer.get();this._convolver.buffer=e||null}get normalize(){return this._convolver.normalize}set normalize(t){this._convolver.normalize=t}dispose(){return super.dispose(),this._buffer.dispose(),this._convolver.disconnect(),this}}function Ni(){return ut().now()}function Li(){return ut().immediate()}function zi(){return ut().transport}function Bi(){return ut().destination}function Wi(){return ut().listener}function Gi(){return ut().draw}function Ui(){return rt.loaded()}n(8),n(9),n(10),n(11).polyfill();const Yi=rt,Zi=Ut,Xi=oe}])}));
//# sourceMappingURL=Tone.js.map